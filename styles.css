:root{
    /* Desktop responsive scaling (1080p to 4K) - COMPACT */
    --font-scale: clamp(0.8rem, 0.75rem + 0.2vw, 0.9rem);
    --spacing-scale: clamp(8px, 6px + 0.3vw, 12px);
    --card-padding: clamp(8px, 6px + 0.3vw, 12px);

    /* Compact spacing tokens */
    --gap-xs: 4px;
    --gap-sm: 6px;
    --gap-md: 8px;
    --gap-lg: 10px;
    --gap-xl: 12px;

    /* Dashboard heights */
    --topbar-height: 52px;
    --page-height: calc(100vh - var(--topbar-height));
    --sidebar-width: 280px;

    /* Enhanced dark theme with richer colors */
    --bg: #080e1a;
    --bg2: #0d1424;
    --bg3: #111827;
    --text: #f1f5f9;
    --muted: #94a3b8;
    --muted-2: #64748b;

    /* Vibrant brand colors */
    --brand: #10b981;
    --brand-light: #34d399;
    --brand-dark: #059669;

    /* Surface layers for depth */
    --card: #0f1729;
    --border: rgba(148, 163, 184, 0.15);
    --border-strong: rgba(148, 163, 184, 0.3);

    /* Status colors - more vibrant */
    --red: #f43f5e;
    --yellow: #fbbf24;
    --good: #10b981;
    --ok: #34d399;
    --mid: #fbbf24;
    --hard: #fb923c;
    --pain: #f43f5e;

    /* Surface helpers with glassmorphism */
    --surface-1: rgba(255, 255, 255, 0.05);
    --surface-2: rgba(255, 255, 255, 0.08);
    --surface-3: rgba(255, 255, 255, 0.12);

    /* Accent colors */
    --accent: #3b82f6;
    --accent-light: #60a5fa;
    --accent-weak: rgba(59, 130, 246, 0.15);
    --accent-strong: rgba(59, 130, 246, 0.25);

    /* Shadows for depth */
    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.15);
    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.25);
    --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.35);
    --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.45);

    /* Gradients */
    --gradient-brand: linear-gradient(135deg, #10b981 0%, #059669 100%);
    --gradient-accent: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    --gradient-surface: linear-gradient(180deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.02) 100%);
    
    /* Pitch colors */
    --pitch-green: #2d5a27;
    --pitch-green-light: #3d7a37;
    --pitch-line: rgba(255, 255, 255, 0.3);
  }
  
  *{box-sizing:border-box;margin:0;padding:0}

  html,body{
    height:100vh;
    max-height:100vh;
    font-family:Inter,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial,sans-serif;
    background:var(--bg);
    color:var(--text);
    line-height:1.6;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow:hidden;
    max-width:100vw;
  }

  a{
    color:var(--accent-light);
    text-decoration:none;
    transition:color 0.2s ease, opacity 0.2s ease;
  }
  a:hover{
    color:var(--brand-light);
    text-decoration:none;
    opacity:0.9;
  }

  h1,h2,h3,h4,h5,h6{
    line-height:1.3;
    letter-spacing:-0.02em;
    font-weight:600;
  }

  /* Scrollbar styling */
  ::-webkit-scrollbar{width:10px;height:10px}
  ::-webkit-scrollbar-track{background:var(--bg2)}
  ::-webkit-scrollbar-thumb{background:var(--surface-3);border-radius:10px;border:2px solid var(--bg2)}
  ::-webkit-scrollbar-thumb:hover{background:var(--muted-2)}
  
  /* ─── Top bar ───────────────────────────────────────── */
  .topbar{
    position:sticky;top:0;z-index:100;
    display:flex;align-items:center;gap:10px;
    padding:8px 14px;
    height:var(--topbar-height);
    background:rgba(13, 20, 36, 0.92);
    color:var(--text);
    border-bottom:1px solid var(--border-strong);
    backdrop-filter:saturate(1.3) blur(16px);
    box-shadow:var(--shadow-md);
    flex-wrap:nowrap;
  }
  
  .brand{
    display:flex;
    align-items:center;
    gap:8px;
    font-weight:700;
    letter-spacing:0.5px;
    font-size:1.05rem;
  }
  .brand-icon{
    font-size:1.4rem;
  }
  .brand-text{
    background:var(--gradient-brand);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
  }
  .season{
    color:var(--muted);
    font-weight:600;
    opacity:0.85;
    font-size:0.9rem;
  }
  
  /* Live badge */
  .live-badge{
    display:inline-flex;
    align-items:center;
    gap:6px;
    padding:4px 10px;
    background:rgba(239, 68, 68, 0.15);
    border:1px solid rgba(239, 68, 68, 0.4);
    border-radius:999px;
    font-size:11px;
    font-weight:700;
    color:#fca5a5;
    animation:live-pulse 2s ease-in-out infinite;
  }
  .live-dot{
    width:8px;
    height:8px;
    background:#ef4444;
    border-radius:50%;
    animation:live-dot-pulse 1.5s ease-in-out infinite;
  }
  @keyframes live-pulse{
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }
  @keyframes live-dot-pulse{
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.2); opacity: 0.7; }
  }
  
  /* ─── Deadline Countdown ───────────────────────────── */
  .deadline-box{
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:8px 16px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:12px;
    min-width:140px;
    transition:all 0.3s ease;
  }
  .deadline-label{
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:0.05em;
    color:var(--muted);
    font-weight:600;
  }
  .deadline-timer{
    font-size:1.1rem;
    font-weight:700;
    font-variant-numeric:tabular-nums;
    color:var(--text);
    letter-spacing:0.02em;
  }
  .deadline-gw{
    font-size:11px;
    color:var(--muted);
    font-weight:500;
  }
  .deadline-box.deadline-urgent{
    background:rgba(251, 191, 36, 0.1);
    border-color:rgba(251, 191, 36, 0.4);
  }
  .deadline-box.deadline-urgent .deadline-timer{
    color:#fde68a;
  }
  .deadline-box.deadline-critical{
    background:rgba(239, 68, 68, 0.15);
    border-color:rgba(239, 68, 68, 0.4);
    animation:deadline-critical-pulse 1s ease-in-out infinite;
  }
  .deadline-box.deadline-critical .deadline-timer{
    color:#fca5a5;
  }
  @keyframes deadline-critical-pulse{
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.02); }
  }
  .deadline-box.deadline-locked{
    background:rgba(148, 163, 184, 0.1);
    border-color:rgba(148, 163, 184, 0.3);
  }
  .deadline-box.deadline-locked .deadline-timer{
    color:var(--muted);
  }
  
  /* ─── Topbar Status (moved from footer) ────────────── */
  .topbar-right{
    display:flex;
    align-items:center;
    gap:12px;
    margin-left:auto;
  }
  .topbar-status{
    display:flex;
    align-items:center;
    gap:8px;
    padding:4px 10px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    font-size:11px;
    color:var(--muted);
  }
  .topbar-status .last-updated{
    display:flex;
    align-items:center;
    gap:5px;
  }
  .topbar-status .update-dot{
    width:6px;
    height:6px;
    background:var(--good);
    border-radius:50%;
  }
  .topbar-status .update-dot.stale{ background:var(--yellow); }
  .topbar-status .update-dot.old{ background:var(--red); }
  .refresh-btn-compact{
    background:none;
    border:none;
    color:var(--muted);
    font-size:14px;
    cursor:pointer;
    padding:2px;
    border-radius:4px;
    transition:all 0.2s;
  }
  .refresh-btn-compact:hover{
    color:var(--accent-light);
    background:var(--surface-2);
  }
  .refresh-btn-compact:disabled{
    opacity:0.4;
    cursor:not-allowed;
  }
  .topbar-version{
    font-size:10px;
    color:var(--muted-2);
    letter-spacing:0.03em;
  }

  /* ─── Theme Toggle ───────────────────────────────── */
  .theme-toggle{
    position:relative;
    width:40px;
    height:40px;
    border:1px solid var(--border);
    background:var(--surface-1);
    border-radius:10px;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:18px;
    transition:all 0.2s ease;
    overflow:hidden;
  }
  .theme-toggle:hover{
    background:var(--surface-2);
    border-color:var(--border-strong);
    transform:scale(1.05);
  }
  .theme-icon-dark,
  .theme-icon-light{
    position:absolute;
    transition:all 0.3s ease;
  }
  .theme-icon-light{
    opacity:0;
    transform:translateY(20px) rotate(-90deg);
  }
  .theme-toggle.is-light .theme-icon-dark{
    opacity:0;
    transform:translateY(-20px) rotate(90deg);
  }
  .theme-toggle.is-light .theme-icon-light{
    opacity:1;
    transform:translateY(0) rotate(0deg);
  }

  /* ─── Global Search ───────────────────────────────── */
  .global-search{
    position:relative;
    display:flex;
    align-items:center;
    gap:8px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:10px;
    padding:6px 12px;
    min-width:240px;
    transition:all 0.2s;
  }
  .global-search:focus-within{
    border-color:var(--accent);
    background:var(--surface-2);
    box-shadow:0 0 0 3px var(--accent-weak);
  }
  .global-search .search-icon{
    font-size:14px;
    opacity:0.6;
  }
  .global-search input{
    flex:1;
    background:transparent;
    border:none;
    color:var(--text);
    font-size:13px;
    outline:none;
    min-width:0;
  }
  .global-search input::placeholder{
    color:var(--muted);
  }
  .global-search .search-hint{
    font-size:10px;
    padding:2px 6px;
    background:var(--surface-2);
    border:1px solid var(--border);
    border-radius:4px;
    color:var(--muted);
    font-family:var(--font-mono);
  }
  .search-results{
    position:absolute;
    top:100%;
    left:0;
    right:0;
    margin-top:4px;
    background:var(--bg2);
    border:1px solid var(--border-strong);
    border-radius:10px;
    box-shadow:var(--shadow-lg);
    max-height:400px;
    overflow:auto;
    display:none;
    z-index:200;
  }
  .search-results.active{
    display:block;
  }
  .search-result-item{
    display:flex;
    align-items:center;
    gap:10px;
    padding:10px 12px;
    cursor:pointer;
    transition:background 0.15s;
  }
  .search-result-item:hover,
  .search-result-item.active{
    background:var(--surface-1);
  }
  .search-result-item .result-icon{
    font-size:16px;
    opacity:0.7;
  }
  .search-result-item .result-name{
    font-weight:500;
    color:var(--text);
  }
  .search-result-item .result-meta{
    font-size:12px;
    color:var(--muted);
    margin-left:auto;
  }
  .search-result-group{
    padding:6px 12px;
    font-size:10px;
    font-weight:700;
    text-transform:uppercase;
    letter-spacing:0.05em;
    color:var(--muted);
    background:var(--surface-1);
    border-bottom:1px solid var(--border);
  }

  /* ─── Navigation Container with Scroll Affordance ───── */
  .nav-container{
    position:relative;
    flex:1;
    min-width:0;
    display:flex;
    align-items:center;
  }
  /* Gradient fade indicators for scroll affordance */
  .nav-container::before,
  .nav-container::after{
    content:'';
    position:absolute;
    top:0;
    bottom:0;
    width:32px;
    pointer-events:none;
    z-index:2;
    opacity:0;
    transition:opacity 0.2s ease;
  }
  .nav-container::before{
    left:0;
    background:linear-gradient(to right, var(--bg2) 0%, transparent 100%);
  }
  .nav-container::after{
    right:0;
    background:linear-gradient(to left, var(--bg2) 0%, transparent 100%);
  }
  .nav-container.scroll-left::before{
    opacity:1;
  }
  .nav-container.scroll-right::after{
    opacity:1;
  }

  .nav{
    display:flex;
    gap:6px;
    align-items:center;
    overflow-x:auto;
    padding:4px;
    border-radius:12px;
    flex:1;
    min-width:0;
    scroll-behavior:smooth;
    -webkit-overflow-scrolling:touch;
  }
  .nav::-webkit-scrollbar{height:6px}
  .nav::-webkit-scrollbar-thumb{background:var(--surface-2);border-radius:99px}
  .nav::-webkit-scrollbar-thumb:hover{background:var(--surface-3)}
  .nav a{
    margin:0;
    padding:9px 16px;
    border-radius:10px;
    border:1px solid transparent;
    background:var(--surface-1);
    white-space:nowrap;
    font-weight:500;
    font-size:0.9rem;
    transition:all 0.2s ease;
    flex-shrink:0;
  }
  .nav a:hover{
    background:var(--accent-weak);
    border-color:var(--accent);
    transform:translateY(-1px);
    box-shadow:var(--shadow-sm);
  }
  .nav a.active{
    background:var(--accent-weak);
    border-color:var(--accent);
    color:var(--accent-light);
    font-weight:600;
  }

  /* Responsive: On smaller screens, nav wraps to new line */
  @media (max-width:1100px){
    .topbar{
      flex-wrap:wrap;
    }
    .nav-container{
      order:10;
      width:100%;
      flex:none;
      margin-top:8px;
    }
    .nav-container::before{
      background:linear-gradient(to right, rgba(13, 20, 36, 0.92) 0%, transparent 100%);
    }
    .nav-container::after{
      background:linear-gradient(to left, rgba(13, 20, 36, 0.92) 0%, transparent 100%);
    }
  }
  /* Fallback for browsers without container - keep nav working */
  .topbar > .nav{
    flex:1;
    min-width:0;
  }
  @media (max-width:1100px){
    .topbar > .nav{
      order:10;
      width:100%;
      flex:none;
      margin-top:8px;
    }
  }
  
  /* ─── Footer ───────────────────────────────────────── */
  .footer{
    position:fixed;
    left:300px;
    right:0;
    bottom:0;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:10px 20px;
    font-size:12px;
    color:var(--muted);
    background:rgba(13, 20, 36, 0.9);
    backdrop-filter:blur(12px);
    border-top:1px solid var(--border-strong);
    z-index:50;
  }
  .footer-left{
    display:flex;
    align-items:center;
    gap:8px;
  }
  .footer-right{
    display:flex;
    align-items:center;
    gap:16px;
  }
  .sep{opacity:.6}
  
  /* Last Updated indicator */
  .last-updated{
    display:flex;
    align-items:center;
    gap:6px;
  }
  .update-dot{
    width:8px;
    height:8px;
    background:var(--good);
    border-radius:50%;
    transition:background 0.3s ease;
  }
  .update-dot.stale{
    background:var(--yellow);
  }
  .update-dot.old{
    background:var(--red);
  }
  
  /* Manual refresh button */
  .refresh-btn{
    display:flex;
    align-items:center;
    gap:4px;
    padding:4px 10px;
    background:var(--surface-2);
    border:1px solid var(--border);
    border-radius:6px;
    color:var(--text);
    font-size:12px;
    font-weight:500;
    cursor:pointer;
    transition:all 0.2s;
  }
  .refresh-btn:hover:not(:disabled){
    background:var(--accent-weak);
    border-color:var(--accent);
    color:var(--accent-light);
  }
  .refresh-btn:disabled{
    opacity:0.5;
    cursor:not-allowed;
  }
  .refresh-btn .refresh-icon{
    font-size:14px;
    transition:transform 0.3s;
  }
  .refresh-btn:not(:disabled):hover .refresh-icon{
    transform:rotate(180deg);
  }

  /* Old auto-refresh indicator (deprecated) */
  .auto-refresh-status{
    display:none;
    align-items:center;
    gap:4px;
    padding:4px 8px;
    background:rgba(59, 130, 246, 0.15);
    border:1px solid rgba(59, 130, 246, 0.3);
    border-radius:999px;
    font-size:11px;
    font-weight:600;
    color:var(--accent-light);
  }
  .refresh-icon{
    animation:spin 2s linear infinite;
  }
  @keyframes spin{
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }
  
  
  /* ─── Sidebar / layout ──────────────────────────────── */
  .sidebar{
    position:fixed;
    left:0;
    top:0;
    bottom:0;
    width:var(--sidebar-width);
    padding:60px 14px 40px;
    overflow:auto;
    background:var(--bg2);
    border-right:1px solid var(--border-strong);
    box-shadow:var(--shadow-md);
    z-index:90;
  }
  .sidebar h3{
    margin:0 0 16px 0;
    font-size:1.15rem;
    color:var(--text);
    letter-spacing:-0.01em;
  }
  .sidebar label{
    display:block;
    font-size:13px;
    margin:14px 0 6px;
    color:var(--muted);
    font-weight:500;
  }
  .sidebar input{
    width:100%;
    margin-top:6px;
    padding:11px 14px;
    border-radius:10px;
    border:1px solid var(--border);
    background:var(--bg);
    color:var(--text);
    font-size:14px;
    transition:all 0.2s ease;
  }
  .sidebar input:focus{
    outline:none;
    border-color:var(--accent);
    background:var(--surface-1);
    box-shadow:0 0 0 3px var(--accent-weak);
  }
  .sidebar .btn{
    width:100%;
    margin-top:14px;
    padding:11px 14px;
    border-radius:10px;
    border:1px solid var(--brand);
    background:var(--gradient-brand);
    color:#ffffff;
    cursor:pointer;
    font-weight:600;
    font-size:14px;
    transition:all 0.2s ease;
    box-shadow:var(--shadow-sm);
  }
  .sidebar .btn:hover{
    transform:translateY(-2px);
    box-shadow:var(--shadow-md);
  }
  .sidebar .btn:active{
    transform:translateY(0);
  }
  .sidebar-note{
    margin-top:16px;
    color:var(--muted);
    font-size:12px;
    line-height:1.5;
    padding:10px;
    background:var(--surface-1);
    border-radius:8px;
    border:1px solid var(--border);
  }
  .btn-small{
    font-size:11px;
    padding:6px 10px;
    margin-top:8px;
  }
  .btn-ghost{
    background:transparent;
    border:1px solid var(--border);
    color:var(--muted);
    cursor:pointer;
    border-radius:6px;
    transition:all 0.2s;
  }
  .btn-ghost:hover{
    background:var(--surface-1);
    color:var(--text);
    border-color:var(--border-strong);
  }

  .sidebar-meta{
    margin-top:20px;
    font-size:13px;
    color:var(--muted);
    display:grid;
    gap:8px;
    padding:12px;
    background:var(--surface-1);
    border-radius:10px;
    border:1px solid var(--border);
  }
  
  /* Sidebar help block */
  .sidebar details.help-ids{margin-top:16px; font-size:12px; color:var(--muted); max-width:100%;}
  .sidebar details.help-ids summary{cursor:pointer; user-select:none; font-size:13px; color:var(--text);}
  .sidebar details.help-ids .help-steps{margin:6px 0 0 0; overflow-x:hidden; max-width:100%;}
  .sidebar details.help-ids p{margin:.35rem 0;}
  .sidebar details.help-ids ol{margin:.25rem 0 .6rem 16px; padding:0;}
  .sidebar details.help-ids li{margin:.15rem 0; line-height:1.3;}
  .sidebar details.help-ids code{
    display:block; margin-top:4px;
    font-size:11px; line-height:1.25;
    background:#0f1a2d; border:1px solid #22314c; padding:4px 6px; border-radius:6px;
    white-space:break-spaces; overflow-wrap:anywhere; word-break:break-word; max-width:100%;
  }
  .sidebar .hl-id{ color:#ff5a5a; font-weight:inherit; }
  
  .app{
    margin-left:var(--sidebar-width);
    padding:var(--gap-md) var(--gap-lg);
    height:var(--page-height);
    max-height:var(--page-height);
    overflow:hidden;
    max-width:calc(100vw - var(--sidebar-width));
    display:flex;
    flex-direction:column;
  }

  /* ─── FM26-Style Dashboard Grid System ───────────────────────────── */
  .dashboard{
    display:grid;
    grid-template-rows:auto 1fr;
    gap:var(--gap-md);
    height:100%;
    max-height:100%;
    overflow:hidden;
  }
  .dashboard-header{
    display:grid;
    grid-template-columns:1fr auto;
    gap:var(--gap-md);
    align-items:stretch;
  }
  .dashboard-main{
    display:grid;
    grid-template-columns:280px 1fr;
    gap:var(--gap-md);
    height:100%;
    min-height:0;
    overflow:hidden;
  }
  .dashboard-left{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    min-height:0;
    overflow:hidden;
  }
  .dashboard-right{
    display:grid;
    grid-template-columns:repeat(2, 1fr);
    grid-template-rows:auto 1fr auto;
    gap:var(--gap-md);
    min-height:0;
    overflow:hidden;
  }
  .dashboard-right .tile-wide{
    grid-column:1/-1;
  }

  /* ─── Page-Specific Dashboard Layouts ───────────────────────────── */

  /* Portal: 3-column full-width grid */
  .portal-dashboard{
    display:grid;
    grid-template-columns:280px 1fr 280px;
    grid-template-rows:1fr;
    gap:var(--gap-md);
    height:100%;
    overflow:hidden;
  }
  .portal-col{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    min-height:0;
    overflow:hidden;
  }
  .portal-col-center{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    min-height:0;
    overflow:hidden;
  }

  /* Players page: 2-column (chart + table) */
  .players-dashboard{
    display:grid;
    grid-template-columns:1fr 1fr;
    grid-template-rows:auto 1fr;
    gap:var(--gap-md);
    height:100%;
    overflow:hidden;
  }
  .players-filters{
    grid-column:1/-1;
  }
  .players-chart{
    min-height:0;
    overflow:hidden;
  }
  .players-table{
    min-height:0;
    overflow:hidden;
  }

  /* Fixtures page: compact matrix + chart */
  .fixtures-dashboard{
    display:grid;
    grid-template-columns:1fr;
    grid-template-rows:auto 1fr auto;
    gap:var(--gap-md);
    height:100%;
    overflow:hidden;
  }
  .fixtures-content{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:var(--gap-md);
    min-height:0;
    overflow:hidden;
  }

  /* GW Explorer: 2-column top + full table */
  .gw-dashboard{
    display:grid;
    grid-template-columns:1fr;
    grid-template-rows:auto auto 1fr;
    gap:var(--gap-md);
    height:100%;
    overflow:hidden;
  }
  .gw-top-row{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:var(--gap-md);
    min-height:0;
  }
  .gw-toolbar{
    padding:var(--gap-md);
  }
  .gw-table-container{
    min-height:0;
    overflow:hidden;
  }

  /* Stat Picker: 3-column dashboard */
  .statpicker-dashboard{
    display:grid;
    grid-template-columns:260px 1fr 260px;
    gap:var(--gap-md);
    height:100%;
    overflow:hidden;
  }
  .statpicker-col{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    min-height:0;
    overflow:hidden;
  }
  .statpicker-center{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    min-height:0;
    overflow:hidden;
  }

  /* Help: compact card grid */
  .help-dashboard{
    display:grid;
    grid-template-columns:repeat(2, 1fr);
    grid-template-rows:repeat(2, auto);
    gap:var(--gap-md);
    height:100%;
    overflow:auto;
  }
  .help-card{
    padding:var(--gap-lg);
    overflow:hidden;
  }
  .help-card-full{
    grid-column:1/-1;
  }

  /* League: selector grid + detail view */
  .league-dashboard{
    display:flex;
    flex-direction:column;
    gap:var(--gap-md);
    height:100%;
    overflow:hidden;
  }
  .league-selector-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill, minmax(280px, 1fr));
    gap:var(--gap-md);
    overflow:auto;
    flex:1;
  }
  .league-detail{
    display:grid;
    grid-template-columns:1fr 1fr 280px;
    gap:var(--gap-md);
    height:100%;
    overflow:hidden;
  }

  @media (max-width:1400px){
    .portal-dashboard{grid-template-columns:240px 1fr 240px}
    .statpicker-dashboard{grid-template-columns:220px 1fr 220px}
    .league-detail{grid-template-columns:1fr 1fr}
  }
  @media (max-width:1200px){
    .dashboard-main{grid-template-columns:260px 1fr}
    .players-dashboard{grid-template-columns:1fr}
    .fixtures-content{grid-template-columns:1fr}
  }
  @media (max-width:1000px){
    .portal-dashboard{grid-template-columns:1fr}
    .statpicker-dashboard{grid-template-columns:1fr}
    .dashboard-main{grid-template-columns:1fr;grid-template-rows:auto 1fr}
    .dashboard-left{flex-direction:row;flex-wrap:wrap}
    .dashboard-right{grid-template-columns:1fr}
    .league-detail{grid-template-columns:1fr}
  }

  /* ─── Tile System (FM26 style) ────────────────────────── */
  .tile{
    background:var(--bg2);
    border:1px solid var(--border);
    border-radius:8px;
    padding:var(--gap-md);
    overflow:hidden;
    display:flex;
    flex-direction:column;
    min-height:0;
  }
  .tile-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:var(--gap-xs);
    padding-bottom:var(--gap-xs);
    border-bottom:1px solid var(--border);
    flex-shrink:0;
  }
  .tile-title{
    font-size:9px;
    font-weight:700;
    text-transform:uppercase;
    letter-spacing:0.06em;
    color:var(--muted);
  }
  .tile-action{
    font-size:10px;
    color:var(--accent-light);
    cursor:pointer;
    transition:all 0.2s;
    padding:2px 6px;
    border-radius:4px;
    background:transparent;
    border:none;
  }
  .tile-action:hover{
    color:var(--brand-light);
    background:var(--surface-1);
  }
  .tile-body{
    flex:1;
    min-height:0;
    overflow:auto;
  }
  .tile-body::-webkit-scrollbar{
    width:3px;
  }
  .tile-body::-webkit-scrollbar-thumb{
    background:var(--border);
    border-radius:2px;
  }

  /* Tile variations */
  .tile-compact{padding:8px}
  .tile-compact .tile-header{display:flex;align-items:center;justify-content:space-between;gap:8px}
  .tile-gw-badge{
    font-size:10px;
    font-weight:600;
    padding:2px 6px;
    background:var(--surface-2);
    color:var(--muted);
    border-radius:4px;
    border:1px solid var(--border);
  }
  .tile-flush{padding:0}
  .tile-flush .tile-header{padding:10px 10px 6px;margin-bottom:0;border-bottom:none}
  .tile-flush .tile-body{padding:0}
  .tile-accent{border-color:var(--accent);border-width:2px}
  .tile-highlight{background:linear-gradient(135deg, var(--bg2), rgba(16,185,129,0.08))}
  .tile-clickable{cursor:pointer;transition:all 0.2s}
  .tile-clickable:hover{border-color:var(--border-strong);transform:translateY(-1px);box-shadow:var(--shadow-sm)}

  /* ─── Stats Widget ────────────────────────────────────── */
  .stats-row{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(80px, 1fr));
    gap:8px;
  }
  .stat-mini{
    text-align:center;
    padding:8px 4px;
    background:var(--surface-1);
    border-radius:8px;
  }
  .stat-mini .value{
    font-size:1.1rem;
    font-weight:700;
    color:var(--text);
    line-height:1.2;
  }
  .stat-mini .label{
    font-size:9px;
    color:var(--muted);
    text-transform:uppercase;
    letter-spacing:0.03em;
  }
  .stat-mini.accent .value{
    color:var(--brand-light);
  }
  .stat-mini.highlight{
    background:var(--gradient-brand);
  }
  .stat-mini.highlight .value,
  .stat-mini.highlight .label{
    color:white;
  }

  /* ─── Page Wrapper for no-scroll layout ───────────────────────── */
  .page-wrapper{
    display:flex;
    flex-direction:column;
    height:100%;
    min-height:0;
    overflow:hidden;
  }
  .page-content{
    flex:1;
    min-height:0;
    overflow:auto;
    padding-bottom:var(--spacing-scale);
  }
  .page-header{
    flex-shrink:0;
    margin-bottom:var(--spacing-scale);
  }

  /* ─── Cards / grid / metrics ───────────────────────── */
  .card{
    background:var(--bg2);
    border:1px solid var(--border);
    border-radius:10px;
    padding:var(--card-padding);
    margin:var(--gap-sm) 0;
    transition:all 0.2s ease;
    box-shadow:var(--shadow-sm);
  }
  .card:hover{
    border-color:var(--border-strong);
  }
  .card h3{
    margin:0 0 var(--gap-md) 0;
    font-size:0.95rem;
    color:var(--text);
    letter-spacing:-0.01em;
  }
  .card-compact{
    padding:var(--gap-sm);
    margin:var(--gap-xs) 0;
  }
  .card-compact h3{
    margin:0 0 var(--gap-sm) 0;
    font-size:0.85rem;
  }
  .card-flush{
    padding:0;
    margin:0;
  }
  .card-scroll{
    overflow:auto;
    max-height:100%;
  }

  .grid{display:grid;gap:var(--gap-md)}
  .grid.cols-2{grid-template-columns:repeat(2,1fr)}
  .grid.cols-3{grid-template-columns:repeat(3,1fr)}
  .grid.cols-4{grid-template-columns:repeat(4,1fr)}
  @media (max-width:1100px){.grid.cols-4{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:900px){.grid.cols-3{grid-template-columns:repeat(2,1fr)}}

  /* ─── Toolbar / Filters ───────────────────────────────── */
  .ap-toolbar{
    margin-bottom:var(--gap-md);
  }
  .ap-toolbar h3{
    margin-bottom:var(--gap-sm);
    font-size:0.9rem;
    color:var(--text);
  }
  .ap-toolbar-row{
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:var(--gap-sm);
    margin-bottom:var(--gap-sm);
  }
  .ap-toolbar input,
  .ap-toolbar select{
    padding:5px 10px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:6px;
    color:var(--text);
    font-size:12px;
    transition:all 0.2s;
  }
  .ap-toolbar input:focus,
  .ap-toolbar select:focus{
    outline:none;
    border-color:var(--accent);
    box-shadow:0 0 0 2px var(--accent-weak);
  }
  .ap-toolbar input::placeholder{
    color:var(--muted);
  }
  .ap-toolbar .w90{
    width:80px;
  }

  /* Price input wrapper with validation */
  .price-input-wrap{
    position:relative;
    display:inline-flex;
    flex-direction:column;
    gap:2px;
  }
  .price-input-wrap .input-error{
    font-size:10px;
    color:var(--pain);
    position:absolute;
    top:100%;
    left:0;
    white-space:nowrap;
    padding:2px 4px;
    background:rgba(0,0,0,.85);
    border-radius:3px;
    z-index:10;
  }
  .price-input-wrap input.input-invalid{
    border-color:var(--pain);
    background:rgba(255,68,68,.08);
  }
  .price-input-wrap input.input-invalid:focus{
    box-shadow:0 0 0 2px rgba(255,68,68,.25);
  }

  /* Compact toolbar variant */
  .toolbar-compact{
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:var(--gap-sm);
    padding:var(--gap-sm) var(--gap-md);
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    margin-bottom:var(--gap-md);
  }
  .toolbar-compact input,
  .toolbar-compact select,
  .toolbar-compact button{
    padding:4px 8px;
    font-size:11px;
    border-radius:4px;
  }
  .toolbar-compact .chip{
    padding:3px 8px;
    font-size:10px;
  }

  /* Segmented button group */
  .segmented{
    display:inline-flex;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:6px;
    padding:2px;
    gap:1px;
  }
  .seg-btn{
    padding:4px 10px;
    background:transparent;
    border:none;
    border-radius:4px;
    color:var(--muted);
    font-size:11px;
    font-weight:500;
    cursor:pointer;
    transition:all 0.15s;
  }
  .seg-btn:hover{
    color:var(--text);
    background:var(--surface-2);
  }
  .seg-btn.active{
    background:var(--accent);
    color:white;
  }

  /* Ghost button */
  .btn-ghost{
    padding:8px 12px;
    background:transparent;
    border:1px solid var(--border);
    border-radius:8px;
    color:var(--text);
    font-size:13px;
    font-weight:500;
    cursor:pointer;
    transition:all 0.2s;
  }
  .btn-ghost:hover{
    background:var(--surface-1);
    border-color:var(--border-strong);
  }

  /* Primary button */
  .btn-primary{
    padding:8px 16px;
    background:var(--gradient-brand);
    border:none;
    border-radius:8px;
    color:white;
    font-size:13px;
    font-weight:600;
    cursor:pointer;
    transition:all 0.2s;
  }
  .btn-primary:hover{
    opacity:0.9;
    transform:translateY(-1px);
    box-shadow:var(--shadow-md);
  }

  /* Row check (checkbox with label) */
  .row-check{
    display:flex;
    align-items:center;
    gap:6px;
    font-size:12px;
    color:var(--text);
    cursor:pointer;
  }
  .row-check input[type="checkbox"]{
    width:16px;
    height:16px;
    accent-color:var(--brand);
    cursor:pointer;
  }

  .metric{
    display:flex;
    align-items:center;
    justify-content:space-between;
    background:var(--gradient-surface);
    padding:16px 18px;
    border:1px solid var(--border);
    border-radius:14px;
    transition:all 0.2s ease;
  }
  .metric:hover{
    border-color:var(--border-strong);
    box-shadow:var(--shadow-sm);
  }
  .metric .label{
    color:var(--muted);
    font-size:12px;
    font-weight:500;
    text-transform:uppercase;
    letter-spacing:0.05em;
  }
  .metric .value{
    font-size:1.35rem;
    font-weight:700;
    background:var(--gradient-brand);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
  }
  
  /* Empty state */
  .empty-state{
    text-align:center;
    padding:60px 40px;
    max-width:500px;
    margin:40px auto;
  }
  .empty-icon{
    font-size:4rem;
    margin-bottom:20px;
  }
  .empty-state h3{
    margin-bottom:12px;
  }
  .empty-state p{
    color:var(--muted);
    margin-bottom:8px;
  }
  .empty-state .small{
    font-size:13px;
    opacity:0.8;
  }
  .empty-state strong{
    color:var(--accent-light);
  }

  /* Empty State Illustrations */
  .empty-illustration{
    width:120px;
    height:120px;
    margin:0 auto 20px;
    opacity:0.8;
  }
  .empty-illustration svg{
    width:100%;
    height:100%;
  }
  .empty-state-enhanced{
    background:var(--gradient-surface);
    border:1px dashed var(--border-strong);
    border-radius:20px;
  }
  .empty-state-enhanced .empty-illustration{
    animation:float 3s ease-in-out infinite;
  }
  @keyframes float{
    0%, 100% { transform:translateY(0); }
    50% { transform:translateY(-10px); }
  }

  /* Empty state type-specific colors */
  .empty-state.empty-team .empty-illustration{ color:var(--brand); }
  .empty-state.empty-players .empty-illustration{ color:var(--accent-light); }
  .empty-state.empty-league .empty-illustration{ color:var(--yellow); }
  .empty-state.empty-fixtures .empty-illustration{ color:var(--ok); }
  .empty-state.empty-error .empty-illustration{ color:var(--pain); }
  
  /* ═══════════════════════════════════════════════════════
     PITCH VISUALIZATION - FM26 STYLE
     ═══════════════════════════════════════════════════════ */

  .pitch-card{
    overflow:hidden;
    margin:0;
  }
  .pitch-title{
    margin-bottom:8px;
  }
  .pitch-title h3{
    margin-bottom:2px;
    font-size:0.95rem;
  }
  .pitch-subtitle{
    font-size:11px;
    color:var(--muted);
  }

  .pitch-container{
    display:flex;
    flex-direction:column;
    gap:8px;
  }

  .pitch-grass{
    position:relative;
    background:linear-gradient(180deg,
      var(--pitch-green) 0%,
      var(--pitch-green-light) 10%,
      var(--pitch-green) 10%,
      var(--pitch-green-light) 20%,
      var(--pitch-green) 20%,
      var(--pitch-green-light) 30%,
      var(--pitch-green) 30%,
      var(--pitch-green-light) 40%,
      var(--pitch-green) 40%,
      var(--pitch-green-light) 50%,
      var(--pitch-green) 50%,
      var(--pitch-green-light) 60%,
      var(--pitch-green) 60%,
      var(--pitch-green-light) 70%,
      var(--pitch-green) 70%,
      var(--pitch-green-light) 80%,
      var(--pitch-green) 80%,
      var(--pitch-green-light) 90%,
      var(--pitch-green) 90%,
      var(--pitch-green-light) 100%
    );
    border-radius:10px;
    padding:6px 4px;
    min-height:auto;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    gap:2px;
    border:2px solid var(--pitch-line);
    box-shadow:inset 0 0 30px rgba(0,0,0,0.3);
  }

  /* Compact pitch for dashboard - default */
  .pitch-compact .pitch-grass{
    padding:4px 3px;
  }
  
  /* Pitch markings - smaller for compact view */
  .pitch-grass::before{
    content:"";
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%);
    width:60px;
    height:60px;
    border:1px solid var(--pitch-line);
    border-radius:50%;
    opacity:0.4;
  }
  .pitch-grass::after{
    content:"";
    position:absolute;
    top:50%;
    left:0;
    right:0;
    height:1px;
    background:var(--pitch-line);
    opacity:0.4;
  }

  .pitch-formation{
    position:absolute;
    top:4px;
    right:4px;
    background:rgba(0,0,0,0.6);
    padding:3px 8px;
    border-radius:6px;
    font-weight:700;
    font-size:10px;
    color:white;
    z-index:10;
  }

  .pitch-row{
    display:flex;
    justify-content:center;
    gap:4px;
    flex-wrap:nowrap;
    position:relative;
    z-index:5;
  }

  .pitch-row-fwd{ padding-top:4px; }
  .pitch-row-mid{ }
  .pitch-row-def{ }
  .pitch-row-gk{ padding-bottom:4px; }

  /* Compact player card on pitch */
  .player-card-pitch{
    position:relative;
    width:56px;
    background:linear-gradient(145deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
    border:1px solid rgba(255,255,255,0.25);
    border-radius:8px;
    padding:4px;
    cursor:pointer;
    transition:all 0.15s ease;
    backdrop-filter:blur(4px);
    box-shadow:0 2px 8px rgba(0,0,0,0.25);
  }
  .player-card-pitch:hover{
    transform:translateY(-2px) scale(1.05);
    border-color:rgba(255,255,255,0.5);
    box-shadow:0 4px 12px rgba(0,0,0,0.35);
    z-index:20;
  }
  .player-card-pitch.player-flagged{
    border-color:rgba(239, 68, 68, 0.5);
  }
  .player-card-pitch.player-flagged::after{
    content:"";
    position:absolute;
    inset:-1px;
    border-radius:8px;
    background:linear-gradient(135deg, rgba(239, 68, 68, 0.2), transparent);
    pointer-events:none;
  }

  .player-photo-wrapper{
    position:relative;
    width:100%;
    aspect-ratio:1/1;
    overflow:hidden;
    border-radius:6px;
    background:rgba(0,0,0,0.2);
    margin-bottom:3px;
  }
  .player-photo{
    width:100%;
    height:100%;
    object-fit:cover;
    object-position:top center;
  }
  .player-team-badge{
    position:absolute;
    bottom:2px;
    right:2px;
    width:14px;
    height:14px;
    object-fit:contain;
    filter:drop-shadow(0 1px 2px rgba(0,0,0,0.5));
  }

  .player-info{
    text-align:center;
  }
  .player-name{
    font-size:9px;
    font-weight:600;
    color:white;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    text-shadow:0 1px 1px rgba(0,0,0,0.5);
    margin-bottom:2px;
    line-height:1.1;
  }

  .player-points-row{
    display:flex;
    justify-content:center;
    gap:2px;
    margin-bottom:2px;
  }
  .player-pts{
    font-size:11px;
    font-weight:700;
    color:white;
    background:rgba(0,0,0,0.5);
    padding:1px 4px;
    border-radius:4px;
  }
  .player-pts.pts-high{
    background:rgba(16, 185, 129, 0.7);
  }
  .player-pts.pts-low{
    background:rgba(239, 68, 68, 0.6);
  }
  .player-xp{
    font-size:8px;
    color:rgba(255,255,255,0.7);
    align-self:center;
    display:none; /* Hide on compact view */
  }

  .player-mins-badge{
    font-size:7px;
    font-weight:600;
    padding:1px 4px;
    border-radius:3px;
    display:inline-block;
  }
  .player-mins-badge.mins-nailed{
    background:rgba(16, 185, 129, 0.35);
    color:#6ee7b7;
  }
  .player-mins-badge.mins-risk{
    background:rgba(251, 191, 36, 0.35);
    color:#fde68a;
  }
  .player-mins-badge.mins-cameo{
    background:rgba(239, 68, 68, 0.35);
    color:#fca5a5;
  }

  /* Captain/VC badges - smaller */
  .player-captain-badge,
  .player-vc-badge{
    position:absolute;
    top:-4px;
    left:-4px;
    width:16px;
    height:16px;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:9px;
    font-weight:700;
    color:white;
    z-index:15;
    box-shadow:0 1px 4px rgba(0,0,0,0.4);
  }
  .player-captain-badge{
    background:linear-gradient(135deg, #fbbf24, #f59e0b);
  }
  .player-vc-badge{
    background:linear-gradient(135deg, #a78bfa, #8b5cf6);
  }

  /* Status badge - smaller */
  .player-status-badge{
    position:absolute;
    top:-4px;
    right:-4px;
    font-size:10px;
    filter:drop-shadow(0 1px 2px rgba(0,0,0,0.5));
    z-index:15;
  }

  /* Compact bench section */
  .bench-section{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    padding:6px 8px;
  }
  .bench-label{
    font-size:9px;
    font-weight:700;
    color:var(--muted);
    text-transform:uppercase;
    letter-spacing:0.08em;
    margin-bottom:6px;
    text-align:center;
  }
  .bench-row{
    display:flex;
    justify-content:center;
    gap:6px;
    flex-wrap:nowrap;
  }
  .bench-card{
    width:48px;
    opacity:0.85;
  }
  .bench-card:hover{
    opacity:1;
  }
  .bench-card .player-photo-wrapper{
    aspect-ratio:1/1;
  }
  .bench-card .player-name{
    font-size:8px;
  }
  .bench-card .player-pts{
    font-size:9px;
  }
  .bench-card .player-mins-badge{
    display:none;
  }
  .bench-pos-badge{
    position:absolute;
    top:-3px;
    left:-3px;
    width:14px;
    height:14px;
    border-radius:50%;
    background:var(--surface-3);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:8px;
    font-weight:700;
    color:var(--muted);
    z-index:15;
  }
  
  /* ─── Compact Team Header (FM26 Style) ─────────────────────────────── */
  .team-header-card{
    background:linear-gradient(135deg, var(--bg2), var(--bg3));
    border:none;
    overflow:hidden;
    position:relative;
    padding:12px 14px;
    margin:0;
  }
  .team-header-card::before{
    content:"";
    position:absolute;
    top:-50%;
    right:-20%;
    width:200px;
    height:200px;
    background:radial-gradient(circle, var(--accent-weak) 0%, transparent 70%);
    opacity:0.4;
  }

  .team-header-top{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:10px;
    position:relative;
    z-index:1;
  }
  .manager-info{}
  .team-name{
    font-size:1.1rem;
    margin-bottom:2px;
    background:var(--gradient-brand);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
  }
  .manager-name{
    color:var(--muted);
    font-size:12px;
  }

  .gw-status-badge{
    padding:5px 10px;
    background:var(--surface-2);
    border:1px solid var(--border);
    border-radius:999px;
    font-weight:600;
    font-size:11px;
    display:flex;
    align-items:center;
    gap:6px;
  }
  .gw-status-badge.is-live{
    background:rgba(239, 68, 68, 0.15);
    border-color:rgba(239, 68, 68, 0.4);
    color:#fca5a5;
  }
  .gw-status-badge .live-dot{
    width:6px;
    height:6px;
    background:#ef4444;
    border-radius:50%;
    animation:live-dot-pulse 1.5s ease-in-out infinite;
  }

  .team-stats-grid{
    display:grid;
    grid-template-columns:repeat(6, 1fr);
    gap:8px;
    position:relative;
    z-index:1;
  }
  @media (max-width:1100px){
    .team-stats-grid{grid-template-columns:repeat(3, 1fr)}
  }
  @media (max-width:600px){
    .team-stats-grid{grid-template-columns:repeat(2, 1fr)}
  }

  .stat-item{
    text-align:center;
    padding:8px 6px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    transition:all 0.15s ease;
  }
  .stat-item:hover{
    border-color:var(--border-strong);
    transform:translateY(-1px);
  }
  .stat-value{
    font-size:1rem;
    font-weight:700;
    color:var(--text);
    margin-bottom:1px;
    line-height:1.2;
  }
  .stat-label{
    font-size:9px;
    text-transform:uppercase;
    letter-spacing:0.04em;
    color:var(--muted);
    font-weight:600;
  }
  .stat-item.captain-stat .stat-value{
    color:var(--accent-light);
    font-size:0.9rem;
  }
  
  /* ─── Compact Insights Card ────────────────────────────────── */
  .insights-card h3{
    margin-bottom:8px;
    font-size:0.9rem;
  }
  .insights-list{
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .insight-item{
    display:flex;
    align-items:center;
    gap:8px;
    padding:8px 10px;
    border-radius:8px;
    background:var(--surface-1);
    border:1px solid var(--border);
  }
  .insight-icon{
    font-size:14px;
    flex-shrink:0;
  }
  .insight-text{
    flex:1;
    font-size:12px;
    line-height:1.3;
  }
  .insight-gain{
    font-weight:700;
    color:var(--good);
    font-size:11px;
    padding:2px 6px;
    background:rgba(16, 185, 129, 0.15);
    border-radius:4px;
    flex-shrink:0;
  }
  .insight-item.insight-good{
    border-color:rgba(16, 185, 129, 0.3);
    background:rgba(16, 185, 129, 0.05);
  }
  .insight-item.insight-warning{
    border-color:rgba(251, 191, 36, 0.3);
    background:rgba(251, 191, 36, 0.05);
  }
  .insight-item.insight-player{
    align-items:flex-start;
  }
  .insight-player-details{
    display:flex;
    flex-direction:column;
    gap:2px;
    flex:1;
    min-width:0;
  }
  .insight-player-name{
    font-size:12px;
    font-weight:600;
    color:var(--text);
  }
  .insight-player-status{
    font-size:11px;
    color:var(--muted);
  }
  .insight-player-news{
    font-size:10px;
    color:var(--muted-2);
    font-style:italic;
    line-height:1.3;
    overflow:hidden;
    text-overflow:ellipsis;
    white-space:nowrap;
    max-width:200px;
  }

  /* ─── Compact Fixtures Preview ─────────────────────────────── */
  .fixtures-preview-card h3{
    margin-bottom:8px;
    font-size:0.9rem;
  }
  .fixtures-preview-grid{
    display:flex;
    flex-direction:column;
    gap:4px;
  }
  .fixture-team-row{
    display:flex;
    align-items:center;
    gap:8px;
    padding:5px 8px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:6px;
  }
  .fixture-team-badge{
    width:18px;
    height:18px;
    object-fit:contain;
    flex-shrink:0;
  }
  .fixture-team-name{
    font-weight:600;
    font-size:11px;
    min-width:32px;
    flex-shrink:0;
  }
  .fixtures-strip{
    display:flex;
    gap:4px;
    flex:1;
    justify-content:flex-end;
  }
  .fx{
    min-width:48px;
    text-align:center;
    font-weight:700;
    font-size:9px;
    padding:3px 5px;
    border-radius:4px;
    border:1px solid;
    background:var(--surface-1);
  }
  
  /* ─── Scrollable Table Container ──────────────────────────────── */
  .table-scroll-container{
    flex:1;
    min-height:0;
    max-height:100%;
    overflow:auto;
    border-radius:12px;
    background:var(--bg2);
    border:1px solid var(--border);
  }
  /* Scrollable table wrapper for large datasets (e.g., 700+ players) */
  .table-scroll-wrapper{
    max-height:calc(100vh - 350px);
    overflow-y:auto;
    overflow-x:auto;
    border-radius:12px;
    border:1px solid var(--border);
  }
  .table-scroll-wrapper .table{
    border-radius:0;
    margin:0;
  }
  /* Sticky table header in scroll wrapper */
  .table-scroll-wrapper .table thead{
    position:sticky;
    top:0;
    z-index:10;
  }
  .table-scroll-wrapper .table th{
    background:var(--bg2);
    border-top:none;
  }
  :root[data-theme="light"] .table-scroll-wrapper .table th{
    background:var(--card);
  }

  .table-scroll-container .table{
    border-radius:0;
  }
  /* Sticky table header in scroll container */
  .table-scroll-container .table th{
    position:sticky;
    top:0;
    z-index:10;
    background:var(--surface-1);
  }
  :root[data-theme="light"] .table-scroll-container .table th{
    background:#f8fafc;
  }

  /* ─── Table / sorting ──────────────────────────────── */
  .table{
    width:100%;
    border-collapse:collapse;
    border-radius:8px;
    overflow:hidden;
  }
  .table th,.table td{
    padding:8px 10px;
    border-bottom:1px solid var(--border);
    text-align:left;
    font-size:12px;
  }
  .table th{
    color:var(--muted);
    font-weight:600;
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:0.04em;
    background:var(--surface-1);
    border-bottom:1px solid var(--border-strong);
    padding:6px 10px;
  }
  .table tbody tr{
    transition:background 0.1s ease;
  }
  .table tbody tr:hover{
    background:var(--surface-1);
  }
  /* Compact table variant */
  .table-compact th,.table-compact td{
    padding:5px 8px;
    font-size:11px;
  }
  .table-compact th{
    font-size:9px;
    padding:4px 8px;
  }
  .table th.th-sortable{
    cursor:pointer;
    user-select:none;
    position:relative;
    padding-right:24px;
    transition:color 0.2s ease;
  }
  .table th.th-sortable:hover{
    color:var(--text);
  }
  .table th.th-sortable::after{
    content:"⇅";
    position:absolute;
    right:8px;
    top:50%;
    transform:translateY(-50%);
    opacity:0.4;
    font-size:12px;
  }
  .table th.th-sortable.active{
    color:var(--accent-light);
  }
  .table th.th-sortable.active.asc::after{
    content:"↑";
    opacity:1;
    color:var(--accent-light);
  }
  .table th.th-sortable.active.desc::after{
    content:"↓";
    opacity:1;
    color:var(--accent-light);
  }
  
  /* ─── Buttons / controls ───────────────────────────── */
  input,select,button{font:inherit}

  .btn-primary{
    background:var(--gradient-brand);
    border:none;
    color:#ffffff;
    padding:10px 18px;
    border-radius:10px;
    cursor:pointer;
    font-weight:600;
    font-size:14px;
    transition:all 0.2s ease;
    box-shadow:var(--shadow-sm);
  }
  .btn-primary:hover{
    transform:translateY(-2px);
    box-shadow:var(--shadow-md);
  }
  .btn-primary:active{
    transform:translateY(0);
  }

  .btn-ghost{
    background:var(--surface-1);
    border:1px solid var(--border);
    color:var(--text);
    padding:9px 16px;
    border-radius:10px;
    cursor:pointer;
    font-weight:500;
    font-size:13px;
    transition:all 0.2s ease;
  }
  .btn-ghost:hover{
    background:var(--surface-2);
    border-color:var(--border-strong);
    transform:translateY(-1px);
  }

  .controls{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    margin-bottom:12px;
  }

  .badge{
    display:inline-block;
    padding:4px 10px;
    border-radius:999px;
    font-size:11px;
    font-weight:600;
    border:1px solid var(--border);
    color:var(--muted);
    background:var(--surface-1);
    transition:all 0.2s ease;
  }
  .badge:hover{
    border-color:var(--border-strong);
  }

  .tag{
    font-size:12px;
    color:var(--muted);
    margin-left:6px;
  }

  canvas.spark{height:28px!important}
  
  /* ─── Status / chip helpers ────────────────────────── */
  .status-a{color:var(--good);font-weight:600}
  .status-d{color:var(--mid);font-weight:600}
  .status-i{color:var(--pain);font-weight:600}
  .status-n{color:var(--muted);font-weight:600}

  .chip{
    display:inline-flex;
    align-items:center;
    gap:6px;
    padding:6px 12px;
    border:1px solid var(--border);
    border-radius:999px;
    background:var(--surface-1);
    font-size:12px;
    font-weight:500;
    transition:all 0.2s ease;
  }
  .chip:hover{
    border-color:var(--border-strong);
    background:var(--surface-2);
  }

  .chip-accent{
    background:var(--accent-weak);
    border-color:var(--accent);
    color:var(--accent-light);
    font-weight:600;
  }
  .chip-accent:hover{
    background:var(--accent-strong);
  }

  .chip-dim{
    opacity:0.85;
  }

  .chips{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items:center;
  }

  .eo-chips{
    display:flex;
    gap:8px;
    align-items:center;
  }
  
  /* ─── Modal ────────────────────────────────────────── */
  .modal__backdrop{
    position:fixed;
    inset:0;
    background:rgba(0, 0, 0, 0.75);
    backdrop-filter:blur(8px);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:1000;
    animation:fadeIn 0.2s ease;
  }

  @keyframes fadeIn{
    from{opacity:0}
    to{opacity:1}
  }

  .modal{
    width:min(760px, 92vw);
    background:var(--bg2);
    border:1px solid var(--border-strong);
    border-radius:16px;
    box-shadow:var(--shadow-xl);
    overflow:hidden;
    animation:modalSlideIn 0.3s ease;
  }

  @keyframes modalSlideIn{
    from{
      opacity:0;
      transform:translateY(-20px) scale(0.95);
    }
    to{
      opacity:1;
      transform:translateY(0) scale(1);
    }
  }

  .modal__head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:16px 20px;
    border-bottom:1px solid var(--border-strong);
    background:var(--surface-1);
  }
  .modal__title{
    font-weight:700;
    font-size:1.1rem;
    color:var(--text);
    letter-spacing:-0.01em;
  }
  .modal__close{
    background:transparent;
    border:none;
    color:var(--muted);
    font-size:24px;
    cursor:pointer;
    width:32px;
    height:32px;
    display:flex;
    align-items:center;
    justify-content:center;
    border-radius:8px;
    transition:all 0.2s ease;
  }
  .modal__close:hover{
    background:var(--surface-2);
    color:var(--text);
  }
  .modal__body{
    padding:20px;
    max-height:72vh;
    overflow:auto;
  }
  
  /* ─── FDR chips ────────────────────────────────────── */
  .fdr{
    display:inline-block;
    min-width:40px;
    text-align:center;
    padding:6px 10px;
    border-radius:10px;
    font-weight:700;
    font-size:11px;
    border:1px solid;
    transition:all 0.2s ease;
  }
  .fdr:hover{
    transform:scale(1.05);
  }
  .fdr-1{
    background:rgba(16, 185, 129, 0.15);
    color:#6ee7b7;
    border-color:rgba(16, 185, 129, 0.4);
  }
  .fdr-2{
    background:rgba(52, 211, 153, 0.15);
    color:#86efac;
    border-color:rgba(52, 211, 153, 0.4);
  }
  .fdr-3{
    background:rgba(251, 191, 36, 0.15);
    color:#fde68a;
    border-color:rgba(251, 191, 36, 0.4);
  }
  .fdr-4{
    background:rgba(251, 146, 60, 0.15);
    color:#fdba74;
    border-color:rgba(251, 146, 60, 0.4);
  }
  .fdr-5{
    background:rgba(244, 63, 94, 0.15);
    color:#fca5a5;
    border-color:rgba(244, 63, 94, 0.4);
  }
  
  /* ─── Abbreviation tooltip (no native title) ───────── */
  .abbr-tip{position:relative;border-bottom:1px dashed var(--muted);cursor:help;transition:color .15s}
  .abbr-tip:hover{color:#c7d2fe}
  .abbr-tip::after{
    content:attr(data-tooltip);
    position:absolute;left:50%;top:-8px;transform:translate(-50%,-100%) scale(.98);
    white-space:normal;word-wrap:break-word;text-align:left;
    max-width:280px;min-width:120px;width:max-content;
    background:#0b1220;color:var(--text);border:1px solid var(--border);
    border-radius:10px;padding:8px 12px;font-size:12px;line-height:1.4;box-shadow:0 8px 20px rgba(0,0,0,.35);
    opacity:0;pointer-events:none;transition:opacity .12s, transform .12s;z-index:9999;
  }
  .abbr-tip:hover::after{opacity:1;transform:translate(-50%,-110%) scale(1)}
  /* Flip tooltip to bottom when near top of viewport */
  .abbr-tip.tooltip-bottom::after{top:auto;bottom:-8px;transform:translate(-50%,100%) scale(.98)}
  .abbr-tip.tooltip-bottom:hover::after{transform:translate(-50%,110%) scale(1)}
  /* Align tooltip left/right when near edges */
  .abbr-tip.tooltip-left::after{left:0;transform:translate(0,-100%) scale(.98)}
  .abbr-tip.tooltip-left:hover::after{transform:translate(0,-110%) scale(1)}
  .abbr-tip.tooltip-right::after{left:auto;right:0;transform:translate(0,-100%) scale(.98)}
  .abbr-tip.tooltip-right:hover::after{transform:translate(0,-110%) scale(1)}
  /* Internal scroll for very long tooltips */
  .abbr-tip.tooltip-scroll::after{max-height:200px;overflow-y:auto}
  
  /* ─── Minutes risk badges ──────────────────────────── */
  .badge-green{
    background:rgba(16, 185, 129, 0.15);
    color:#6ee7b7;
    border:1px solid rgba(16, 185, 129, 0.4);
    font-weight:700;
  }
  .badge-amber{
    background:rgba(251, 191, 36, 0.15);
    color:#fde68a;
    border:1px solid rgba(251, 191, 36, 0.4);
    font-weight:700;
  }
  .badge-red{
    background:rgba(244, 63, 94, 0.15);
    color:#fca5a5;
    border:1px solid rgba(244, 63, 94, 0.4);
    font-weight:700;
  }
  .c-badge{
    background:rgba(59, 130, 246, 0.2);
    color:#93c5fd;
    border:1px solid rgba(59, 130, 246, 0.5);
    font-weight:700;
  }
  .vc-badge{
    background:rgba(147, 51, 234, 0.2);
    color:#d8b4fe;
    border:1px solid rgba(147, 51, 234, 0.5);
    font-weight:700;
  }
  
  /* ─── Conditional cells ────────────────────────────── */
  .points-high{background:rgba(34,197,94,.12)}
  .points-low{background:rgba(239,68,68,.12)}
  .minutes-zero{background:rgba(239,68,68,.08)}
  .cell-good{background:rgba(34,197,94,.08)}
  .cell-warn{background:rgba(234,179,8,.08)}
  .cell-bad{background:rgba(239,68,68,.08)}
  
  /* ─── FX chip colors (used in fixtures-strip) ───────────────────────────────── */
  .fx.fdr-1{ background:rgba(16, 185, 129, 0.15); border-color:rgba(16, 185, 129, 0.4); color:#6ee7b7; }
  .fx.fdr-2{ background:rgba(52, 211, 153, 0.12); border-color:rgba(52, 211, 153, 0.4); color:#86efac; }
  .fx.fdr-3{ background:rgba(148, 163, 184, 0.12); border-color:rgba(148, 163, 184, 0.4); color:var(--muted); }
  .fx.fdr-4{ background:rgba(251, 146, 60, 0.12); border-color:rgba(251, 146, 60, 0.4); color:#fdba74; }
  .fx.fdr-5{ background:rgba(244, 63, 94, 0.12); border-color:rgba(244, 63, 94, 0.4); color:#fca5a5; }
  .fx:hover{ transform:scale(1.03); }

  .name-cell{
    display:flex;
    align-items:center;
    gap:10px;
  }
  .team-chip{
    font-weight:700;
    font-size:11px;
    padding:4px 8px;
    border-radius:8px;
    background:var(--surface-2);
    border:1px solid var(--border);
    transition:all 0.2s ease;
  }
  .team-chip:hover{
    background:var(--surface-3);
    border-color:var(--border-strong);
  }
  .name-cell .nm{
    font-weight:600;
    letter-spacing:0.02em;
  }

  .status-pill{
    padding:5px 10px;
    border-radius:999px;
    font-size:11px;
    font-weight:700;
    border:1px solid;
    transition:all 0.2s ease;
  }
  .status-pill:hover{
    transform:scale(1.05);
  }
  .status-pill.st-okay{
    background:rgba(16, 185, 129, 0.15);
    color:#6ee7b7;
    border-color:rgba(16, 185, 129, 0.4);
  }
  .status-pill.st-doubt{
    background:rgba(251, 191, 36, 0.15);
    color:#fde68a;
    border-color:rgba(251, 191, 36, 0.4);
  }
  .status-pill.st-inj{
    background:rgba(244, 63, 94, 0.15);
    color:#fca5a5;
    border-color:rgba(244, 63, 94, 0.4);
  }
  .status-pill.st-sus,.status-pill.st-out{
    background:rgba(148, 163, 184, 0.15);
    color:var(--muted);
    border-color:rgba(148, 163, 184, 0.4);
  }

  /* Progress bar */
  .progress{
    margin-top:12px;
    width:100%;
    height:10px;
    background:var(--surface-1);
    border-radius:999px;
    overflow:hidden;
    border:1px solid var(--border);
    box-shadow:inset 0 2px 4px rgba(0,0,0,0.2);
  }
  .progress .bar{
    height:100%;
    background:var(--gradient-brand);
    width:0%;
    transition:width 0.3s ease;
    box-shadow:0 0 10px rgba(16, 185, 129, 0.5);
  }
  
  .legend.small{font-size:12px;opacity:0.85}
  .mt-8{margin-top:8px}
  .mb-8{margin-bottom:8px}
  .b{font-weight:700}
  .small{font-size:13px}
  .muted{color:var(--muted)}
  .bullets{padding-left:20px}
  .bullets li{margin:8px 0;line-height:1.5}
  
  /* ─── Light theme ──────────────────────────────────── */
  :root[data-theme="light"]{
    --bg:#f8fafc;
    --bg2:#ffffff;
    --bg3:#f1f5f9;
    --text:#0f172a;
    --muted:#64748b;
    --muted-2:#94a3b8;

    --brand:#10b981;
    --brand-light:#059669;
    --brand-dark:#047857;

    --card:#ffffff;
    --border:rgba(15, 23, 42, 0.1);
    --border-strong:rgba(15, 23, 42, 0.2);

    --red:#dc2626;
    --yellow:#f59e0b;
    --good:#10b981;
    --ok:#34d399;
    --mid:#f59e0b;
    --hard:#f97316;
    --pain:#ef4444;

    --surface-1:rgba(15, 23, 42, 0.03);
    --surface-2:rgba(15, 23, 42, 0.06);
    --surface-3:rgba(15, 23, 42, 0.1);

    --accent:#3b82f6;
    --accent-light:#2563eb;
    --accent-weak:rgba(59, 130, 246, 0.1);
    --accent-strong:rgba(59, 130, 246, 0.15);

    --shadow-sm:0 2px 8px rgba(15, 23, 42, 0.08);
    --shadow-md:0 4px 16px rgba(15, 23, 42, 0.12);
    --shadow-lg:0 8px 32px rgba(15, 23, 42, 0.16);
    --shadow-xl:0 16px 48px rgba(15, 23, 42, 0.2);
    
    --pitch-green:#4ade80;
    --pitch-green-light:#86efac;
    --pitch-line:rgba(0, 0, 0, 0.2);

    --gradient-brand:linear-gradient(135deg, #10b981 0%, #059669 100%);
    --gradient-accent:linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    --gradient-surface:linear-gradient(180deg, rgba(15,23,42,0.03) 0%, rgba(15,23,42,0.01) 100%);
  }
  :root[data-theme="light"] .topbar{
    background:rgba(255, 255, 255, 0.9);
    border-bottom:1px solid var(--border-strong);
  }
  :root[data-theme="light"] .sidebar{
    background:var(--bg2);
  }
  :root[data-theme="light"] .footer{
    background:rgba(255, 255, 255, 0.9);
  }
  :root[data-theme="light"] .player-card-pitch{
    background:linear-gradient(145deg, rgba(0,0,0,0.05), rgba(0,0,0,0.02));
    border-color:rgba(0,0,0,0.15);
  }
  :root[data-theme="light"] .player-name{
    color:#1e293b;
    text-shadow:none;
  }
  :root[data-theme="light"] .player-pts{
    color:#1e293b;
    background:rgba(255,255,255,0.8);
  }
  :root[data-theme="light"] .abbr-tip::after{
    background:#ffffff;
    color:var(--text);
    border-color:var(--border-strong);
  }

  /* Light mode contrast improvements */
  :root[data-theme="light"] .stat-value,
  :root[data-theme="light"] .stat-row span:last-child{
    color:#1e293b;
  }
  :root[data-theme="light"] .portal-tile .tile-title,
  :root[data-theme="light"] .profile-name,
  :root[data-theme="light"] h1, :root[data-theme="light"] h2, :root[data-theme="light"] h3{
    color:#0f172a;
  }
  :root[data-theme="light"] .topbar-status,
  :root[data-theme="light"] .sidebar-meta{
    color:#475569;
  }
  :root[data-theme="light"] .portal-tile .tile-desc,
  :root[data-theme="light"] .captain-form,
  :root[data-theme="light"] .squad-player-pts{
    color:#64748b;
  }
  :root[data-theme="light"] .search-result-item .result-meta{
    color:#64748b;
  }
  :root[data-theme="light"] .table th{
    color:#374151;
    background:#f8fafc;
  }
  :root[data-theme="light"] .table td{
    color:#1e293b;
    border-color:#e2e8f0;
  }
  :root[data-theme="light"] .nav-link{
    color:#475569;
  }
  :root[data-theme="light"] .nav-link.active,
  :root[data-theme="light"] .nav-link:hover{
    color:#0f172a;
  }
  :root[data-theme="light"] .sidebar label{
    color:#374151;
  }
  :root[data-theme="light"] input,
  :root[data-theme="light"] select{
    background:#ffffff;
    border-color:#cbd5e1;
    color:#1e293b;
  }
  :root[data-theme="light"] input:focus,
  :root[data-theme="light"] select:focus{
    border-color:#3b82f6;
  }

  /* Custom Select Component - Dark Mode */
  .cselect{
    position:relative;
    display:inline-block;
  }
  .cselect__btn{
    display:flex;
    align-items:center;
    gap:6px;
    padding:8px 12px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    color:var(--text);
    font-size:13px;
    font-weight:500;
    cursor:pointer;
    transition:all 0.2s;
    min-width:100px;
  }
  .cselect__btn:hover{
    background:var(--surface-2);
    border-color:var(--border-strong);
  }
  .cselect__btn:focus{
    outline:none;
    border-color:var(--accent);
    box-shadow:0 0 0 3px var(--accent-weak);
  }
  .cselect__chev{
    margin-left:auto;
    font-size:10px;
    opacity:0.6;
    transition:transform 0.2s;
  }
  .cselect.is-open .cselect__chev{
    transform:rotate(180deg);
  }
  .cselect__panel{
    position:absolute;
    top:100%;
    left:0;
    right:0;
    margin-top:4px;
    padding:4px;
    background:var(--bg2);
    border:1px solid var(--border-strong);
    border-radius:8px;
    box-shadow:var(--shadow-lg);
    z-index:200;
    display:none;
    max-height:240px;
    overflow-y:auto;
  }
  .cselect.is-open .cselect__panel{
    display:block;
  }
  .cselect__option{
    padding:8px 12px;
    border-radius:6px;
    color:var(--text);
    font-size:13px;
    cursor:pointer;
    transition:background 0.15s;
  }
  .cselect__option:hover,
  .cselect__option.is-active{
    background:var(--surface-1);
  }
  .cselect__option[aria-selected="true"]{
    background:var(--accent-weak);
    color:var(--accent-light);
    font-weight:600;
  }

  /* Custom Select - Light Mode */
  :root[data-theme="light"] .cselect__btn{
    background:#ffffff;
    border-color:#cbd5e1;
    color:#1e293b;
  }
  :root[data-theme="light"] .cselect__btn:hover{
    background:#f8fafc;
    border-color:#94a3b8;
  }
  :root[data-theme="light"] .cselect__panel{
    background:#ffffff;
    border-color:#e2e8f0;
    box-shadow:0 4px 16px rgba(0,0,0,0.1);
  }
  :root[data-theme="light"] .cselect__option{
    color:#334155;
  }
  :root[data-theme="light"] .cselect__option:hover,
  :root[data-theme="light"] .cselect__option.is-active{
    background:#f1f5f9;
  }
  :root[data-theme="light"] .cselect__option[aria-selected="true"]{
    background:rgba(59, 130, 246, 0.1);
    color:#1d4ed8;
  }

  :root[data-theme="light"] .deadline-timer{
    color:#0f172a;
  }
  :root[data-theme="light"] .deadline-gw{
    color:#475569;
  }
  :root[data-theme="light"] .fixture-team-name,
  :root[data-theme="light"] .transfer-name,
  :root[data-theme="light"] .captain-name{
    color:#1e293b;
  }
  :root[data-theme="light"] .global-search input{
    color:#1e293b;
  }
  :root[data-theme="light"] .global-search input::placeholder{
    color:#94a3b8;
  }

  /* Text selection */
  :root{
    --selection-bg: #273449;
    --selection-fg: #ffffff;
    color-scheme: dark;
  }
  :root[data-theme="light"]{
    --selection-bg: #cfe8ff;
    --selection-fg: #0b0f19;
    color-scheme: light;
  }
  ::selection { background: var(--selection-bg); color: var(--selection-fg); }
  ::-moz-selection { background: var(--selection-bg); color: var(--selection-fg); }

  /* ─── Copy Button ───────────────────────────────────── */
  .input-with-copy{
    position:relative;
    display:flex;
    align-items:center;
  }
  .input-with-copy input{
    flex:1;
    padding-right:40px;
  }
  .copy-btn{
    position:absolute;
    right:4px;
    top:50%;
    transform:translateY(-50%);
    width:32px;
    height:32px;
    border:none;
    background:var(--surface-2);
    border-radius:8px;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    transition:all 0.2s ease;
  }
  .copy-btn:hover{
    background:var(--surface-3);
    transform:translateY(-50%) scale(1.05);
  }
  .copy-btn.copied{
    background:rgba(16, 185, 129, 0.3);
  }
  .copy-btn .copy-icon{
    font-size:14px;
  }

  /* ─── Animated Number Transitions ────────────────────── */
  .animate-points{
    animation:pointsBounce 0.5s ease;
  }
  @keyframes pointsBounce{
    0% { transform:scale(1); }
    30% { transform:scale(1.3); }
    60% { transform:scale(0.95); }
    100% { transform:scale(1); }
  }

  .count-up{
    transition:all 0.3s ease;
  }

  .points-changed{
    animation:pointsGlow 1s ease;
  }
  @keyframes pointsGlow{
    0% { box-shadow:0 0 0 0 rgba(16, 185, 129, 0.7); }
    50% { box-shadow:0 0 20px 4px rgba(16, 185, 129, 0.4); }
    100% { box-shadow:0 0 0 0 rgba(16, 185, 129, 0); }
  }

  /* ─── League Page Styling ────────────────────────────── */
  .league-card{
    background:var(--bg2);
    border:1px solid var(--border);
    border-radius:12px;
    margin-bottom:12px;
    overflow:hidden;
    transition:all 0.3s ease;
  }
  .league-card.expanded{
    box-shadow:var(--shadow-lg);
  }
  .league-card-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:12px 16px;
    background:var(--surface-1);
    border-bottom:1px solid var(--border);
    gap:12px;
    flex-wrap:wrap;
  }
  .league-header-left{
    display:flex;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
  }
  .league-header-left h3{
    margin:0;
    font-size:1rem;
  }
  .league-header-right{
    display:flex;
    align-items:center;
    gap:8px;
  }
  .league-expand-btn{
    padding:6px 14px;
    background:var(--accent-weak);
    border:1px solid var(--accent);
    border-radius:6px;
    color:var(--accent-light);
    font-size:12px;
    font-weight:600;
    cursor:pointer;
    transition:all 0.2s;
  }
  .league-expand-btn:hover{
    background:var(--accent);
    color:white;
  }
  .league-card-content{
    padding:12px 16px;
  }
  .league-standings{
    margin-bottom:12px;
  }
  .league-standings .table{
    font-size:12px;
  }
  .league-standings th,
  .league-standings td{
    padding:6px 10px;
  }
  .league-charts{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
    margin-bottom:12px;
  }
  .league-charts.collapsed{
    display:none;
  }
  .league-charts .chart-wrap{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    padding:12px;
  }
  .league-charts .chart-wrap h4{
    margin:0 0 8px;
    font-size:0.85rem;
    color:var(--muted);
  }
  .league-charts .chart-container{
    height:250px;
  }
  .league-xi{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    padding:12px;
  }
  .league-xi h4{
    margin:0 0 8px;
    font-size:0.85rem;
  }
  .league-xi .table{
    font-size:12px;
  }
  @media (max-width:900px){
    .league-charts{
      grid-template-columns:1fr;
    }
  }

  /* ─── Confetti Celebration ───────────────────────────── */
  .confetti-container{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    pointer-events:none;
    z-index:9999;
    overflow:hidden;
  }
  .confetti{
    position:absolute;
    width:10px;
    height:10px;
    opacity:0;
    animation:confettiFall 3s ease-out forwards;
  }
  @keyframes confettiFall{
    0% {
      opacity:1;
      transform:translateY(0) rotate(0deg) scale(1);
    }
    100% {
      opacity:0;
      transform:translateY(100vh) rotate(720deg) scale(0.5);
    }
  }

  .haul-badge{
    position:absolute;
    top:-5px;
    left:50%;
    transform:translateX(-50%);
    background:linear-gradient(135deg, #fbbf24, #f59e0b);
    color:#1f2937;
    font-size:7px;
    font-weight:800;
    padding:1px 4px;
    border-radius:3px;
    white-space:nowrap;
    z-index:20;
    box-shadow:0 1px 4px rgba(251, 191, 36, 0.4);
    animation:haulPulse 2s ease-in-out infinite;
  }
  @keyframes haulPulse{
    0%, 100% { transform:translateX(-50%) scale(1); }
    50% { transform:translateX(-50%) scale(1.05); }
  }

  /* ─── Skeleton Loading States ────────────────────────── */
  .skeleton{
    background:linear-gradient(90deg,
      var(--surface-1) 25%,
      var(--surface-2) 50%,
      var(--surface-1) 75%
    );
    background-size:200% 100%;
    animation:shimmer 1.5s infinite;
    border-radius:8px;
  }
  @keyframes shimmer{
    0% { background-position:200% 0; }
    100% { background-position:-200% 0; }
  }

  .skeleton-text{
    height:14px;
    margin:4px 0;
  }
  .skeleton-text.short{ width:60%; }
  .skeleton-text.medium{ width:80%; }
  .skeleton-text.full{ width:100%; }

  .skeleton-card{
    padding:20px;
    margin:12px 0;
  }

  .skeleton-pitch{
    height:480px;
    border-radius:16px;
  }

  .skeleton-stat{
    height:60px;
    border-radius:12px;
  }

  .skeleton-player{
    width:90px;
    height:140px;
    border-radius:12px;
  }

  .skeleton-header{
    height:180px;
    border-radius:16px;
    margin-bottom:16px;
  }

  .skeleton-insights{
    height:120px;
    border-radius:16px;
  }

  .skeleton-grid{
    display:grid;
    gap:14px;
  }
  .skeleton-grid.cols-6{
    grid-template-columns:repeat(6, 1fr);
  }
  @media (max-width:900px){
    .skeleton-grid.cols-6{grid-template-columns:repeat(3, 1fr)}
  }

  /* ─── Sparkline Mini-Charts ──────────────────────────── */
  .sparkline-container{
    display:inline-flex;
    align-items:center;
    gap:6px;
    padding:2px 8px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    cursor:help;
  }
  .sparkline-svg{
    width:50px;
    height:20px;
  }
  .sparkline-line{
    fill:none;
    stroke:var(--accent-light);
    stroke-width:1.5;
    stroke-linecap:round;
    stroke-linejoin:round;
  }
  .sparkline-area{
    fill:url(#sparklineGradient);
    opacity:0.3;
  }
  .sparkline-dot{
    fill:var(--accent-light);
  }
  .sparkline-value{
    font-size:11px;
    font-weight:600;
    color:var(--muted);
  }
  .sparkline-trend-up .sparkline-line{ stroke:var(--good); }
  .sparkline-trend-up .sparkline-dot{ fill:var(--good); }
  .sparkline-trend-down .sparkline-line{ stroke:var(--pain); }
  .sparkline-trend-down .sparkline-dot{ fill:var(--pain); }

  /* ─── Position Row Tints ─────────────────────────────── */
  .pos-gkp{ background:rgba(251, 191, 36, 0.05); }
  .pos-def{ background:rgba(52, 211, 153, 0.05); }
  .pos-mid{ background:rgba(59, 130, 246, 0.05); }
  .pos-fwd{ background:rgba(244, 63, 94, 0.05); }

  /* Player card haul glow - compact */
  .player-card-pitch.player-haul{
    border-color:rgba(251, 191, 36, 0.6);
    box-shadow:0 0 12px rgba(251, 191, 36, 0.3);
  }
  .player-card-pitch.player-haul::before{
    content:"";
    position:absolute;
    inset:-1px;
    border-radius:8px;
    background:linear-gradient(135deg, rgba(251, 191, 36, 0.15), transparent 60%);
    pointer-events:none;
  }

  /* ─── Keyboard Shortcuts Overlay ─────────────────────── */
  .keyboard-help-overlay{
    position:fixed;
    inset:0;
    background:rgba(0, 0, 0, 0.75);
    backdrop-filter:blur(8px);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:2000;
    animation:fadeIn 0.2s ease;
  }
  .keyboard-help-modal{
    background:var(--bg2);
    border:1px solid var(--border-strong);
    border-radius:16px;
    width:min(480px, 90vw);
    box-shadow:var(--shadow-xl);
    overflow:hidden;
  }
  .keyboard-help-header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:16px 20px;
    background:var(--surface-1);
    border-bottom:1px solid var(--border);
  }
  .keyboard-help-header h3{
    margin:0;
    font-size:1.1rem;
  }
  .keyboard-help-close{
    background:none;
    border:none;
    font-size:24px;
    color:var(--muted);
    cursor:pointer;
    padding:4px 8px;
    border-radius:8px;
    transition:all 0.2s;
  }
  .keyboard-help-close:hover{
    background:var(--surface-2);
    color:var(--text);
  }
  .keyboard-help-content{
    padding:20px;
    display:grid;
    grid-template-columns:repeat(2, 1fr);
    gap:24px;
  }
  @media (max-width:500px){
    .keyboard-help-content{grid-template-columns:1fr}
  }
  .shortcut-group h4{
    font-size:12px;
    text-transform:uppercase;
    letter-spacing:0.05em;
    color:var(--muted);
    margin:0 0 12px;
  }
  .shortcut-row{
    display:flex;
    align-items:center;
    gap:12px;
    padding:6px 0;
    font-size:14px;
  }
  .shortcut-row kbd{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    min-width:28px;
    height:28px;
    padding:0 8px;
    background:var(--surface-2);
    border:1px solid var(--border-strong);
    border-radius:6px;
    font-family:inherit;
    font-size:12px;
    font-weight:600;
    color:var(--text);
    box-shadow:0 2px 0 var(--border);
  }

  /* ─── Collapsible Sidebar ────────────────────────────── */
  .sidebar{
    transition:transform 0.3s ease, width 0.3s ease;
  }
  .sidebar-toggle{
    position:fixed;
    top:50%;
    left:300px;
    transform:translateY(-50%);
    width:28px;
    height:48px;
    background:var(--bg2);
    border:1px solid var(--border-strong);
    border-radius:0 8px 8px 0;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    color:var(--muted);
    font-size:12px;
    transition:all 0.3s;
    z-index:150;
  }
  .sidebar-toggle:hover{
    background:var(--surface-2);
    color:var(--text);
  }
  .toggle-icon{
    transition:transform 0.3s;
  }

  /* Collapsed state */
  .sidebar-collapsed .sidebar{
    transform:translateX(-100%);
  }
  .sidebar-collapsed .sidebar-toggle{
    left:0;
  }
  .sidebar-collapsed .toggle-icon{
    transform:rotate(180deg);
  }
  .sidebar-collapsed .app{
    margin-left:0;
    max-width:100vw;
  }
  .sidebar-collapsed .footer{
    left:0;
  }

  /* ─── Watchlist Star - Compact ─────────────────────────────────── */
  .player-card-pitch .watchlist-btn{
    position:absolute;
    bottom:2px;
    right:2px;
    background:rgba(0,0,0,0.4);
    border:none;
    border-radius:50%;
    cursor:pointer;
    font-size:10px;
    width:16px;
    height:16px;
    display:none; /* Hidden by default on compact view */
    align-items:center;
    justify-content:center;
    opacity:0.5;
    transition:all 0.2s;
    z-index:15;
  }
  .player-card-pitch:hover .watchlist-btn{
    display:flex;
  }
  .player-card-pitch .watchlist-btn:hover{
    opacity:1;
    transform:scale(1.2);
    background:rgba(0,0,0,0.6);
  }
  .player-card-pitch .watchlist-btn.active{
    display:flex;
    opacity:1;
  }
  .player-card-pitch .watchlist-btn .star-icon{
    color:rgba(255,255,255,0.7);
  }
  .player-card-pitch .watchlist-btn.active .star-icon{
    color:#fbbf24;
  }

  /* Generic watchlist button for tables */
  .watchlist-btn{
    background:none;
    border:none;
    cursor:pointer;
    font-size:18px;
    padding:4px;
    opacity:0.4;
    transition:all 0.2s;
  }
  .watchlist-btn:hover{
    opacity:0.8;
    transform:scale(1.1);
  }
  .watchlist-btn.active{
    opacity:1;
  }
  .watchlist-btn.active .star-icon{
    color:#fbbf24;
  }

  /* ─── Player Compare Modal ────────────────────────────── */
  .compare-selection-bar{
    position:fixed;
    bottom:60px;
    left:50%;
    transform:translateX(-50%);
    display:flex;
    align-items:center;
    gap:16px;
    padding:12px 20px;
    background:rgba(13, 20, 36, 0.95);
    backdrop-filter:blur(16px);
    border:1px solid var(--border-strong);
    border-radius:16px;
    box-shadow:var(--shadow-xl);
    z-index:500;
    animation:slideUp 0.3s ease;
  }
  @keyframes slideUp{
    from { opacity:0; transform:translate(-50%, 20px); }
    to { opacity:1; transform:translate(-50%, 0); }
  }
  .compare-selection-bar .compare-chips{
    display:flex;
    gap:8px;
  }
  .compare-selection-bar .compare-chip{
    display:flex;
    align-items:center;
    gap:6px;
    padding:6px 10px;
    background:var(--surface-2);
    border:1px solid var(--border);
    border-radius:8px;
    font-size:13px;
    font-weight:500;
  }
  .compare-selection-bar .compare-chip .remove-btn{
    background:none;
    border:none;
    color:var(--muted);
    cursor:pointer;
    font-size:14px;
    line-height:1;
    padding:2px;
    border-radius:4px;
    transition:all 0.2s;
  }
  .compare-selection-bar .compare-chip .remove-btn:hover{
    background:rgba(244, 63, 94, 0.2);
    color:var(--pain);
  }
  .compare-selection-bar .compare-btn{
    padding:8px 16px;
    background:var(--gradient-brand);
    border:none;
    border-radius:8px;
    color:white;
    font-weight:600;
    font-size:13px;
    cursor:pointer;
    transition:all 0.2s;
  }
  .compare-selection-bar .compare-btn:disabled{
    opacity:0.5;
    cursor:not-allowed;
  }
  .compare-selection-bar .compare-btn:not(:disabled):hover{
    transform:translateY(-2px);
    box-shadow:var(--shadow-md);
  }
  .compare-selection-bar .clear-btn{
    background:none;
    border:none;
    color:var(--muted);
    font-size:12px;
    cursor:pointer;
    text-decoration:underline;
    transition:color 0.2s;
  }
  .compare-selection-bar .clear-btn:hover{
    color:var(--text);
  }

  /* Compare modal content */
  .compare-modal{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:24px;
    min-width:min(800px, 90vw);
  }
  @media (max-width:600px){
    .compare-modal{grid-template-columns:1fr}
  }
  .compare-player{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:12px;
    padding:16px;
  }
  .compare-player-header{
    display:flex;
    align-items:center;
    gap:12px;
    margin-bottom:16px;
    padding-bottom:12px;
    border-bottom:1px solid var(--border);
  }
  .compare-player-photo{
    width:60px;
    height:70px;
    object-fit:cover;
    object-position:top center;
    border-radius:8px;
    background:var(--surface-2);
  }
  .compare-player-info h4{
    margin:0 0 4px;
    font-size:1.1rem;
  }
  .compare-player-info .sub{
    font-size:13px;
    color:var(--muted);
  }
  .compare-stats{
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .compare-stat-row{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:8px 10px;
    background:var(--surface-1);
    border-radius:8px;
  }
  .compare-stat-row.winner{
    background:rgba(16, 185, 129, 0.1);
    border:1px solid rgba(16, 185, 129, 0.3);
  }
  .compare-stat-row .label{
    font-size:12px;
    color:var(--muted);
    font-weight:500;
  }
  .compare-stat-row .value{
    font-size:14px;
    font-weight:700;
    color:var(--text);
  }
  .compare-stat-row.winner .value{
    color:var(--good);
  }
  .compare-stat-row.loser .value{
    color:var(--muted);
  }
  .compare-verdict{
    grid-column:1/-1;
    text-align:center;
    padding:16px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:12px;
  }
  .compare-verdict h4{
    margin:0 0 4px;
    font-size:1rem;
    color:var(--good);
  }
  .compare-verdict .sub{
    font-size:13px;
    color:var(--muted);
  }

  /* Select checkbox in table */
  .table .select-cell{
    width:32px;
    text-align:center;
  }
  .player-select-checkbox{
    width:18px;
    height:18px;
    accent-color:var(--brand);
    cursor:pointer;
  }
  .player-select-checkbox:disabled{
    opacity:0.3;
    cursor:not-allowed;
  }

  /* ─── Price Change Predictions ────────────────────────── */
  .price-change-indicator{
    display:inline-flex;
    align-items:center;
    gap:4px;
    padding:3px 8px;
    border-radius:6px;
    font-size:11px;
    font-weight:700;
    transition:all 0.2s;
  }
  .price-change-indicator.rise{
    background:rgba(16, 185, 129, 0.15);
    color:#6ee7b7;
    border:1px solid rgba(16, 185, 129, 0.3);
  }
  .price-change-indicator.fall{
    background:rgba(244, 63, 94, 0.15);
    color:#fca5a5;
    border:1px solid rgba(244, 63, 94, 0.3);
  }
  .price-change-indicator.stable{
    background:var(--surface-1);
    color:var(--muted);
    border:1px solid var(--border);
  }
  .price-change-indicator .arrow{
    font-size:12px;
  }
  .price-change-indicator.rise .arrow{
    animation:priceRise 1s ease-in-out infinite;
  }
  .price-change-indicator.fall .arrow{
    animation:priceFall 1s ease-in-out infinite;
  }
  @keyframes priceRise{
    0%, 100% { transform:translateY(0); }
    50% { transform:translateY(-2px); }
  }
  @keyframes priceFall{
    0%, 100% { transform:translateY(0); }
    50% { transform:translateY(2px); }
  }

  /* Price cell with indicator */
  .price-cell{
    display:flex;
    flex-direction:column;
    gap:4px;
  }
  .price-cell .price-value{
    font-weight:600;
  }

  /* Net transfers badge */
  .net-transfers{
    font-size:10px;
    color:var(--muted);
  }
  .net-transfers.positive{ color:var(--good); }
  .net-transfers.negative{ color:var(--pain); }

  /* ─── Help Page - Compact 2x2 Grid ──────────────────────── */
  .help-dashboard{
    display:grid;
    grid-template-columns:repeat(2, 1fr);
    grid-template-rows:repeat(2, 1fr);
    gap:var(--gap-md);
    height:100%;
    overflow:hidden;
  }
  @media (max-width:900px){
    .help-dashboard{
      grid-template-columns:1fr;
      grid-template-rows:auto;
      overflow:auto;
    }
  }
  .help-tile{
    background:var(--bg2);
    border:1px solid var(--border);
    border-radius:8px;
    padding:var(--gap-md);
    display:flex;
    flex-direction:column;
    min-height:0;
    overflow:hidden;
  }
  .help-body{
    flex:1;
    min-height:0;
  }
  .help-scroll{
    overflow:auto;
  }
  .help-list{
    margin:0;
    padding-left:18px;
    font-size:12px;
    line-height:1.6;
    color:var(--text);
  }
  .help-list li{
    margin:4px 0;
  }
  .help-section{
    display:flex;
    flex-direction:column;
    gap:2px;
    padding:6px 0;
    border-bottom:1px solid var(--border);
  }
  .help-section:last-child{
    border-bottom:none;
  }
  .help-section strong{
    font-size:11px;
    color:var(--accent-light);
  }
  .help-desc{
    font-size:10px;
    color:var(--muted);
    line-height:1.4;
  }
  .help-grid-compact{
    display:grid;
    grid-template-columns:repeat(3, 1fr);
    gap:6px;
    margin-bottom:8px;
  }
  .help-shortcut{
    display:flex;
    align-items:center;
    gap:6px;
    font-size:10px;
    color:var(--muted);
  }
  .help-shortcut kbd{
    background:var(--surface-2);
    border:1px solid var(--border);
    border-radius:4px;
    padding:2px 6px;
    font-size:10px;
    font-weight:600;
    color:var(--text);
  }
  .help-divider{
    height:1px;
    background:var(--border);
    margin:8px 0;
  }
  .help-glossary{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
  }
  .gloss-item{
    font-size:9px;
    color:var(--muted);
    padding:3px 6px;
    background:var(--surface-1);
    border-radius:4px;
  }
  .gloss-item strong{
    color:var(--accent-light);
    margin-right:2px;
  }
  .help-tips{
    margin:0;
    padding-left:16px;
    font-size:11px;
    line-height:1.6;
    color:var(--muted);
  }
  .help-tips li{
    margin:3px 0;
  }
  .help-status{
    display:flex;
    flex-wrap:wrap;
    gap:12px;
    margin-top:auto;
    padding-top:8px;
    border-top:1px solid var(--border);
    font-size:10px;
    color:var(--muted);
  }
  .help-status strong{
    color:var(--text);
  }

  /* ─── 404 Error Page ────────────────────────────────────── */
  .error-404{
    max-width:520px;
    margin:48px auto;
    text-align:center;
    padding:32px;
  }
  .error-404-icon{
    font-size:48px;
    margin-bottom:16px;
    opacity:0.8;
  }
  .error-404 h2{
    font-size:24px;
    margin-bottom:12px;
    color:var(--text);
  }
  .error-404 p{
    color:var(--muted);
    margin-bottom:8px;
  }
  .error-404 code{
    background:var(--surface-2);
    padding:2px 8px;
    border-radius:4px;
    color:var(--accent-light);
    font-family:var(--font-mono);
  }
  .error-404 .sub{
    font-size:14px;
    color:var(--muted);
    margin-top:16px;
    margin-bottom:12px;
  }
  .error-404 .route-list{
    list-style:none;
    padding:0;
    margin:12px 0 24px;
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:8px;
  }
  .error-404 .route-list li a{
    display:inline-block;
    padding:6px 14px;
    background:var(--surface-2);
    border:1px solid var(--border);
    border-radius:8px;
    color:var(--accent-light);
    text-decoration:none;
    font-size:13px;
    transition:all 0.2s;
  }
  .error-404 .route-list li a:hover{
    background:var(--accent-weak);
    border-color:var(--accent);
  }
  /* New route buttons layout */
  .error-404 .route-buttons{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(120px, 1fr));
    gap:10px;
    margin:16px 0 24px;
  }
  .error-404 .route-btn{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:8px;
    padding:12px 16px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:10px;
    color:var(--text);
    text-decoration:none;
    font-size:13px;
    font-weight:500;
    transition:all 0.2s ease;
  }
  .error-404 .route-btn:hover{
    background:var(--accent-weak);
    border-color:var(--accent);
    color:var(--accent-light);
    transform:translateY(-2px);
    box-shadow:var(--shadow-sm);
  }
  .error-404 .route-icon{
    font-size:16px;
  }

  /* ═══════════════════════════════════════════════════════════════════
     PORTAL HUB PAGE - FM26 Style Decision Tiles (COMPACT 3-COLUMN)
     ═══════════════════════════════════════════════════════════════════ */
  .portal-page{
    height:100%;
    display:grid;
    grid-template-columns:260px 1fr 260px;
    gap:var(--gap-md);
    overflow:hidden;
  }
  @media (max-width:1200px){
    .portal-page{grid-template-columns:220px 1fr 220px}
  }
  @media (max-width:900px){
    .portal-page{grid-template-columns:1fr;grid-template-rows:auto 1fr auto}
  }

  .portal-header{
    text-align:left;
    margin-bottom:var(--gap-sm);
    padding:var(--gap-sm) 0;
    border-bottom:1px solid var(--border);
  }
  .portal-title{
    font-size:1rem;
    font-weight:700;
    margin:0;
    background:var(--gradient-brand);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
  }
  .portal-subtitle{
    font-size:11px;
    color:var(--muted);
    margin:2px 0 0;
  }

  .portal-column{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    min-height:0;
    overflow:hidden;
  }
  .portal-column-center{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    min-height:0;
    overflow:auto;
  }

  .portal-grid{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    flex:1;
    overflow-y:auto;
  }

  .portal-tile{
    background:var(--bg2);
    border:1px solid var(--border);
    border-radius:10px;
    padding:var(--gap-md);
    display:flex;
    flex-direction:column;
    transition:all 0.2s ease;
    position:relative;
    overflow:hidden;
    flex-shrink:0;
  }
  .portal-tile::before{
    content:"";
    position:absolute;
    inset:0;
    background:var(--gradient-surface);
    opacity:0;
    transition:opacity 0.2s;
    pointer-events:none;
  }
  .portal-tile:hover::before{
    opacity:1;
  }
  .portal-tile.tile-clickable{
    cursor:pointer;
  }
  .portal-tile.tile-clickable:hover{
    border-color:var(--accent);
    box-shadow:var(--shadow-sm);
  }

  .portal-tile.tile-wide{
    /* No longer needed with 3-column layout */
  }

  .portal-tile .tile-header{
    display:flex;
    align-items:center;
    gap:var(--gap-sm);
    margin-bottom:var(--gap-sm);
    padding-bottom:var(--gap-xs);
    border-bottom:1px solid var(--border);
  }
  .portal-tile .tile-icon{
    font-size:14px;
  }
  .portal-tile .tile-title{
    font-size:11px;
    font-weight:700;
    margin:0;
    color:var(--text);
  }
  .portal-tile .tile-badge{
    margin-left:auto;
    font-size:9px;
    padding:2px 5px;
    background:var(--surface-2);
    border-radius:4px;
    color:var(--muted);
  }
  .portal-tile .tile-body{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:var(--gap-xs);
    overflow:auto;
    max-height:200px;
  }
  .portal-tile .tile-footer{
    margin-top:var(--gap-sm);
    padding-top:var(--gap-xs);
    border-top:1px solid var(--border);
    display:flex;
    justify-content:space-between;
    align-items:center;
  }
  .portal-tile .tile-hint{
    font-size:9px;
    color:var(--muted-2);
    flex:1;
  }
  .portal-tile .tile-link{
    font-size:10px;
    font-weight:600;
    color:var(--accent-light);
    transition:color 0.2s;
    white-space:nowrap;
  }
  .portal-tile:hover .tile-link{
    color:var(--brand-light);
  }
  .portal-tile .tile-error{
    color:var(--muted);
    font-size:11px;
  }
  .portal-tile .tile-desc{
    font-size:11px;
    color:var(--muted);
    margin:0;
  }

  /* Deadline Tile - Compact */
  .portal-tile.tile-deadline{
    flex-direction:row;
    align-items:center;
    gap:var(--gap-md);
    background:var(--surface-1);
    cursor:pointer;
  }
  .portal-tile.tile-deadline .tile-icon{
    font-size:24px;
  }
  .portal-tile.tile-deadline .tile-content{
    flex:1;
  }
  .portal-tile.tile-deadline .deadline-countdown{
    font-size:1.1rem;
    font-weight:800;
    margin:2px 0;
    font-variant-numeric:tabular-nums;
  }
  .portal-tile.tile-deadline .countdown-num{
    color:var(--text);
  }
  .portal-tile.tile-deadline .countdown-label{
    color:var(--muted);
    font-size:0.8em;
    margin-right:6px;
  }
  .portal-tile.tile-deadline.deadline-urgent .deadline-countdown{
    color:var(--mid);
  }
  .portal-tile.tile-deadline.deadline-soon .deadline-countdown{
    color:var(--ok);
  }
  .portal-tile.tile-deadline.deadline-relaxed .deadline-countdown{
    color:var(--good);
  }

  /* Captain Picks */
  .captain-picks{
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .captain-option{
    display:flex;
    align-items:center;
    gap:10px;
    padding:8px 10px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:10px;
    transition:all 0.2s;
  }
  .captain-option:hover{
    background:var(--surface-2);
    border-color:var(--accent);
  }
  .captain-photo{
    width:36px;
    height:42px;
    object-fit:cover;
    object-position:top;
    border-radius:6px;
    background:var(--surface-2);
  }
  .captain-info{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:2px;
  }
  .captain-name{
    font-weight:600;
    font-size:13px;
  }
  .captain-form{
    font-size:11px;
    color:var(--muted);
  }

  /* Captain Picks - Expanded version */
  .captain-picks-expanded{
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .captain-option-row{
    display:flex;
    align-items:center;
    gap:10px;
    padding:8px 10px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:10px;
    transition:all 0.2s;
  }
  .captain-option-row:hover{
    background:var(--surface-2);
    border-color:var(--accent);
  }
  .captain-rank{
    width:20px;
    height:20px;
    display:flex;
    align-items:center;
    justify-content:center;
    background:var(--accent-weak);
    color:var(--accent-light);
    border-radius:50%;
    font-size:11px;
    font-weight:700;
  }
  .captain-details{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:4px;
  }
  .captain-meta{
    display:flex;
    gap:6px;
    flex-wrap:wrap;
  }
  .captain-chip{
    font-size:10px;
    padding:2px 6px;
    border-radius:4px;
    background:var(--surface-2);
    color:var(--muted);
    font-weight:500;
  }
  .captain-chip.fdr-easy{
    background:rgba(16, 185, 129, 0.2);
    color:#6ee7b7;
  }
  .captain-chip.fdr-hard{
    background:rgba(244, 63, 94, 0.2);
    color:#fca5a5;
  }
  .captain-chip.chip-mins{
    background:var(--accent-weak);
    color:var(--accent-light);
  }

  /* Injuries Tile */
  .injuries-list{
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .injury-row{
    display:flex;
    align-items:center;
    gap:8px;
    padding:6px 8px;
    background:var(--surface-1);
    border-radius:8px;
  }
  .injury-icon{
    font-size:14px;
  }
  .injury-details{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:2px;
  }
  .injury-name{
    font-size:13px;
    font-weight:600;
  }
  .injury-status{
    font-size:11px;
    color:var(--muted);
  }
  .injury-ownership{
    font-size:11px;
    font-weight:600;
    color:var(--muted);
    background:var(--surface-2);
    padding:2px 6px;
    border-radius:4px;
  }
  .injury-news{
    font-size:11px;
    color:var(--muted-2);
    padding:4px 8px 4px 30px;
    font-style:italic;
    line-height:1.3;
  }
  .tile-warning .tile-header .tile-icon{
    filter:hue-rotate(-40deg);
  }

  /* Fixture Swings Tile */
  .fixture-swings{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:16px;
  }
  @media (max-width:500px){
    .fixture-swings{
      grid-template-columns:1fr;
    }
  }
  .swing-column{
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .swing-label{
    font-size:11px;
    font-weight:700;
    text-transform:uppercase;
    letter-spacing:0.05em;
    margin:0 0 4px;
    padding:4px 8px;
    border-radius:6px;
    display:inline-block;
    width:fit-content;
  }
  .swing-label.good{
    background:rgba(16, 185, 129, 0.15);
    color:#6ee7b7;
  }
  .swing-label.bad{
    background:rgba(244, 63, 94, 0.15);
    color:#fca5a5;
  }
  .swing-row{
    display:flex;
    align-items:center;
    gap:8px;
    padding:6px 8px;
    background:var(--surface-1);
    border-radius:8px;
  }
  .swing-badge{
    width:20px;
    height:20px;
    object-fit:contain;
  }
  .swing-name{
    flex:1;
    font-size:12px;
    font-weight:500;
  }
  .swing-change{
    font-size:11px;
    font-weight:700;
    padding:2px 6px;
    border-radius:4px;
  }
  .swing-change.good{
    background:rgba(16, 185, 129, 0.2);
    color:#6ee7b7;
  }
  .swing-change.bad{
    background:rgba(244, 63, 94, 0.2);
    color:#fca5a5;
  }

  /* Tile hints and badges */
  .tile-hint{
    font-size:10px;
    color:var(--muted-2);
    flex:1;
  }
  .tile-badge{
    font-size:10px;
    font-weight:600;
    padding:3px 8px;
    background:var(--accent-weak);
    color:var(--accent-light);
    border-radius:6px;
    margin-left:auto;
  }

  /* Fixture Outlook */
  .fixtures-overview{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:16px;
  }
  @media (max-width:500px){
    .fixtures-overview{
      grid-template-columns:1fr;
    }
  }
  .fixtures-column{
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .fixtures-label{
    font-size:11px;
    font-weight:700;
    text-transform:uppercase;
    letter-spacing:0.05em;
    margin:0 0 4px;
    padding:4px 8px;
    border-radius:6px;
    display:inline-block;
    width:fit-content;
  }
  .fixtures-label.good{
    background:rgba(16, 185, 129, 0.15);
    color:#6ee7b7;
  }
  .fixtures-label.bad{
    background:rgba(244, 63, 94, 0.15);
    color:#fca5a5;
  }
  .fixture-team-row{
    display:flex;
    align-items:center;
    gap:8px;
    padding:6px 8px;
    background:var(--surface-1);
    border-radius:8px;
  }
  .fixture-badge{
    width:20px;
    height:20px;
    object-fit:contain;
  }
  .fixture-team-name{
    flex:1;
    font-size:12px;
    font-weight:600;
  }
  .fixture-score{
    font-size:12px;
    font-weight:700;
    padding:2px 8px;
    border-radius:4px;
  }
  .fixture-score.score-good{
    background:rgba(16, 185, 129, 0.2);
    color:#6ee7b7;
  }
  .fixture-score.score-bad{
    background:rgba(244, 63, 94, 0.2);
    color:#fca5a5;
  }

  /* Transfers Preview */
  .transfers-preview{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
  }
  @media (max-width:400px){
    .transfers-preview{
      grid-template-columns:1fr;
    }
  }
  .transfers-section{
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .transfers-label{
    font-size:11px;
    font-weight:700;
    margin:0 0 4px;
  }
  .transfer-row{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:6px 8px;
    background:var(--surface-1);
    border-radius:6px;
    font-size:12px;
  }
  .transfer-name{
    font-weight:500;
  }
  .transfer-stat{
    color:var(--muted);
    font-weight:600;
  }

  /* Team Status Grid */
  .team-status-grid{
    display:grid;
    grid-template-columns:repeat(2, 1fr);
    gap:10px;
  }
  .status-item{
    text-align:center;
    padding:8px;
    background:var(--surface-1);
    border-radius:8px;
  }
  .status-value{
    font-size:18px;
    font-weight:800;
    color:var(--text);
  }
  .status-label{
    font-size:10px;
    color:var(--muted);
    text-transform:uppercase;
    letter-spacing:0.05em;
  }

  /* Leagues Preview */
  .leagues-preview{
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .league-row{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:8px 10px;
    background:var(--surface-1);
    border-radius:8px;
  }
  .league-name{
    font-weight:600;
    font-size:13px;
  }
  .league-members{
    font-size:11px;
    color:var(--muted);
  }

  /* Metrics Preview */
  .metrics-preview{
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .metric-item{
    display:flex;
    align-items:center;
    gap:10px;
    padding:8px 10px;
    background:var(--surface-1);
    border-radius:8px;
  }
  .metric-name{
    font-weight:700;
    font-size:14px;
    color:var(--accent-light);
    min-width:40px;
  }
  .metric-desc{
    font-size:12px;
    color:var(--muted);
  }

  /* Empty Prompt */
  .empty-prompt{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding:20px;
    color:var(--muted);
    font-size:13px;
  }
  .empty-prompt .tile-link{
    margin-top:8px;
  }

  /* Loading Spinner */
  .loading-spinner{
    width:24px;
    height:24px;
    border:3px solid var(--surface-2);
    border-top-color:var(--accent);
    border-radius:50%;
    animation:spin 0.8s linear infinite;
    margin:20px auto;
  }
  @keyframes spin{
    to { transform:rotate(360deg); }
  }

  /* ═══════════════════════════════════════════════════════════════════
     PLAYER & TEAM PROFILE PAGES
     ═══════════════════════════════════════════════════════════════════ */
  .player-profile,
  .team-profile{
    padding:16px;
    max-width:900px;
    margin:0 auto;
    height:100%;
    overflow-y:auto;
  }
  .profile-header{
    display:flex;
    flex-direction:column;
    gap:16px;
    margin-bottom:20px;
  }
  .back-btn{
    align-self:flex-start;
    background:var(--surface-1);
    border:1px solid var(--border);
    color:var(--muted);
    padding:8px 14px;
    border-radius:8px;
    cursor:pointer;
    font-size:13px;
    transition:all 0.2s;
  }
  .back-btn:hover{
    background:var(--surface-2);
    color:var(--text);
    border-color:var(--border-strong);
  }
  .profile-info{
    display:flex;
    gap:20px;
    align-items:center;
  }
  .profile-photo{
    width:120px;
    height:150px;
    object-fit:cover;
    object-position:top;
    border-radius:12px;
    background:var(--surface-2);
  }
  .profile-photo-placeholder{
    width:120px;
    height:150px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:48px;
    background:var(--surface-2);
    border-radius:12px;
  }
  .team-badge-large{
    width:100px;
    height:100px;
    object-fit:contain;
  }
  .profile-badge{
    width:24px;
    height:24px;
    object-fit:contain;
  }
  .profile-details{
    flex:1;
  }
  .profile-name{
    font-size:clamp(1.5rem, 3vw, 2rem);
    font-weight:800;
    margin:0 0 8px;
  }
  .profile-meta{
    display:flex;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
    font-size:14px;
    color:var(--muted);
  }
  .profile-team{
    font-weight:600;
    color:var(--text);
  }
  .profile-pos{
    padding:4px 10px;
    background:var(--surface-2);
    border-radius:6px;
    font-size:12px;
    font-weight:600;
  }
  .profile-news{
    margin:12px 0 0;
    padding:10px 14px;
    background:rgba(251, 191, 36, 0.1);
    border:1px solid rgba(251, 191, 36, 0.3);
    border-radius:8px;
    font-size:13px;
    color:var(--yellow);
  }
  .team-short{
    font-weight:700;
    font-size:16px;
    color:var(--accent-light);
  }
  .profile-stats-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(100px, 1fr));
    gap:12px;
    margin-bottom:20px;
  }
  .profile-stats-grid .stat-card{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:12px;
    padding:14px;
    text-align:center;
  }
  .profile-stats-grid .stat-value{
    font-size:1.3rem;
    font-weight:800;
    color:var(--text);
  }
  .profile-stats-grid .stat-label{
    font-size:11px;
    color:var(--muted);
    text-transform:uppercase;
    letter-spacing:0.05em;
    margin-top:4px;
  }
  .profile-section{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:12px;
    padding:16px;
    margin-bottom:16px;
  }
  .profile-section h3{
    font-size:14px;
    font-weight:700;
    margin:0 0 12px;
    color:var(--text);
  }
  .stats-table{
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .stat-row{
    display:flex;
    justify-content:space-between;
    padding:8px 12px;
    background:var(--bg2);
    border-radius:8px;
    font-size:13px;
  }
  .stat-row span:first-child{
    color:var(--muted);
  }
  .stat-row span:last-child{
    font-weight:600;
    color:var(--text);
  }
  .text-good{ color:var(--good) !important; }
  .text-bad{ color:var(--pain) !important; }

  /* Squad grid for team profile */
  .squad-position{
    margin-bottom:16px;
  }
  .squad-position h4{
    font-size:12px;
    text-transform:uppercase;
    letter-spacing:0.05em;
    color:var(--muted);
    margin:0 0 8px;
    padding-bottom:6px;
    border-bottom:1px solid var(--border);
  }
  .squad-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill, minmax(140px, 1fr));
    gap:8px;
  }
  .squad-player{
    display:flex;
    flex-direction:column;
    gap:2px;
    padding:10px 12px;
    background:var(--bg2);
    border:1px solid var(--border);
    border-radius:8px;
    text-decoration:none;
    transition:all 0.2s;
  }
  .squad-player:hover{
    background:var(--surface-2);
    border-color:var(--accent);
    transform:translateY(-1px);
  }
  .squad-player-name{
    font-weight:600;
    font-size:13px;
    color:var(--text);
  }
  .squad-player-pts{
    font-size:11px;
    color:var(--muted);
  }
  .squad-player-price{
    font-size:11px;
    color:var(--accent-light);
    font-weight:600;
  }

  /* Profile multi-column layout */
  .profile-columns{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:16px;
    margin-top:16px;
  }
  @media(max-width:768px){
    .profile-columns{
      grid-template-columns:1fr;
    }
  }
  .profile-column{
    display:flex;
    flex-direction:column;
    gap:16px;
  }
  .profile-stats-grid--wide{
    grid-template-columns:repeat(4, 1fr);
  }
  @media(min-width:900px){
    .profile-stats-grid--wide{
      grid-template-columns:repeat(8, 1fr);
    }
  }
  .stats-table--compact{
    gap:6px;
  }
  .stats-table--compact .stat-row{
    padding:6px 0;
    border-bottom:1px solid var(--border);
  }
  .stats-table--compact .stat-row:last-child{
    border-bottom:none;
  }

  /* Top performer card in team profile */
  .top-performer-card{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:12px 16px;
    background:var(--surface-2);
    border-radius:8px;
    text-decoration:none;
    transition:background .15s;
  }
  .top-performer-card:hover{
    background:var(--surface-3);
  }
  .top-performer-info{
    display:flex;
    flex-direction:column;
    gap:2px;
  }
  .top-performer-name{
    font-weight:600;
    color:var(--fg);
  }
  .top-performer-pos{
    font-size:12px;
    color:var(--muted);
  }
  .top-performer-stats{
    display:flex;
    flex-direction:column;
    align-items:flex-end;
    gap:2px;
  }
  .top-performer-pts{
    font-weight:700;
    color:var(--accent);
  }
  .top-performer-price{
    font-size:12px;
    color:var(--muted);
  }

  /* Portal Error State */
  .portal-error{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding:48px 24px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:16px;
    margin:24px auto;
    max-width:400px;
  }
  .portal-error .error-icon{
    font-size:48px;
    margin-bottom:16px;
  }
  .portal-error h2{
    font-size:1.25rem;
    margin:0 0 8px;
  }
  .portal-error .error-message{
    color:var(--muted);
    font-size:13px;
    margin:0 0 20px;
  }
  .portal-error .retry-btn{
    padding:10px 24px;
  }

  /* Portal Modal Content Styles */
  .portal-modal-content{
    max-height:70vh;
    overflow-y:auto;
  }
  .modal-footer-link{
    margin-top:16px;
    padding-top:12px;
    border-top:1px solid var(--border);
    text-align:center;
  }
  .modal-footer-link a{
    color:var(--accent-light);
    text-decoration:none;
    font-size:13px;
    font-weight:500;
  }
  .modal-footer-link a:hover{
    text-decoration:underline;
  }

  /* Captain Modal */
  .captain-modal-grid{
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .captain-modal-row{
    display:flex;
    align-items:flex-start;
    gap:12px;
    padding:12px;
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:10px;
  }
  .captain-rank-lg{
    width:28px;
    height:28px;
    display:flex;
    align-items:center;
    justify-content:center;
    background:var(--accent-weak);
    color:var(--accent-light);
    border-radius:50%;
    font-size:13px;
    font-weight:700;
  }
  .captain-photo-lg{
    width:50px;
    height:65px;
    object-fit:cover;
    border-radius:6px;
    background:var(--surface-2);
  }
  .captain-info{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:4px;
  }
  .captain-name-lg{
    font-size:15px;
    font-weight:700;
  }
  .captain-meta-lg{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    font-size:12px;
    color:var(--muted);
  }
  .captain-meta-lg .fdr-easy{color:#6ee7b7;}
  .captain-meta-lg .fdr-hard{color:#fca5a5;}
  .captain-why{
    font-size:12px;
    color:var(--muted);
    margin-top:4px;
  }

  /* Fixtures Modal */
  .fixtures-modal-grid{
    display:flex;
    flex-direction:column;
  }
  .fixtures-modal-col h4{
    margin:0 0 12px;
    font-size:14px;
    font-weight:600;
  }
  .fixture-modal-row{
    display:flex;
    align-items:center;
    gap:10px;
    padding:8px 10px;
    border-radius:8px;
    margin-bottom:4px;
  }
  .fixture-modal-row.fixture-easy{background:rgba(16, 185, 129, 0.08);}
  .fixture-modal-row.fixture-hard{background:rgba(244, 63, 94, 0.08);}
  .fixture-rank{
    width:24px;
    font-size:12px;
    font-weight:600;
    color:var(--muted);
  }
  .fixture-badge-sm{
    width:20px;
    height:20px;
    object-fit:contain;
  }
  .fixture-team{
    flex:1;
    font-size:13px;
    font-weight:500;
  }
  .fixture-score{
    font-size:13px;
    font-weight:700;
    padding:4px 8px;
    border-radius:6px;
    background:var(--surface-2);
  }
  .fixture-score.score-good{background:rgba(16, 185, 129, 0.2);color:#6ee7b7;}
  .fixture-score.score-bad{background:rgba(244, 63, 94, 0.2);color:#fca5a5;}

  /* Transfers Modal */
  .transfers-modal-grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:24px;
  }
  @media (max-width:600px){
    .transfers-modal-grid{grid-template-columns:1fr;}
  }
  .transfers-modal-col h4{
    margin:0 0 12px;
    font-size:14px;
    font-weight:600;
  }
  .transfer-modal-row{
    display:flex;
    align-items:center;
    gap:8px;
    padding:8px 10px;
    background:var(--surface-1);
    border-radius:8px;
    margin-bottom:4px;
  }
  .transfer-rank{
    width:20px;
    font-size:12px;
    font-weight:600;
    color:var(--muted);
  }
  .transfer-name{flex:1;font-size:13px;font-weight:500;}
  .transfer-team{font-size:11px;color:var(--muted);}
  .transfer-stat{font-size:12px;font-weight:600;color:var(--accent-light);}
  .transfer-form{font-size:11px;color:var(--muted);}

  /* Injuries Modal */
  .injuries-modal-list{
    display:flex;
    flex-direction:column;
    gap:8px;
    max-height:60vh;
    overflow-y:auto;
  }
  .injury-modal-row{
    display:flex;
    align-items:flex-start;
    gap:10px;
    padding:10px 12px;
    background:var(--surface-1);
    border-radius:8px;
  }
  .injury-modal-row .injury-details{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:2px;
  }
  .injury-modal-row .injury-name{font-size:14px;font-weight:600;}
  .injury-modal-row .injury-team{font-size:11px;color:var(--muted);}
  .injury-modal-row .injury-status{font-size:12px;color:var(--warning);}
  .injury-modal-row .injury-news{font-size:11px;color:var(--muted);margin-top:4px;font-style:italic;}
  .injury-modal-row .injury-ownership{
    font-size:12px;font-weight:600;
    padding:4px 8px;
    background:var(--surface-2);
    border-radius:4px;
  }
  .injury-more{
    font-size:12px;
    color:var(--muted);
    text-align:center;
    padding:8px;
  }

  /* Fixture Swings Modal */
  .swings-modal-grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:24px;
  }
  @media (max-width:600px){
    .swings-modal-grid{grid-template-columns:1fr;}
  }
  .swings-modal-col h4{margin:0 0 12px;}
  .swing-modal-row{
    display:flex;
    align-items:center;
    gap:8px;
    padding:8px 10px;
    background:var(--surface-1);
    border-radius:8px;
    margin-bottom:4px;
  }
  .swing-rank{width:20px;font-size:12px;font-weight:600;color:var(--muted);}
  .swing-badge-sm{width:18px;height:18px;object-fit:contain;}
  .swing-team{flex:1;font-size:13px;font-weight:500;}
  .swing-fdr{font-size:11px;color:var(--muted);}
  .swing-delta{font-size:12px;font-weight:700;padding:2px 6px;border-radius:4px;}
  .swing-delta.good{background:rgba(16, 185, 129, 0.2);color:#6ee7b7;}
  .swing-delta.bad{background:rgba(244, 63, 94, 0.2);color:#fca5a5;}

  /* ═══════════════════════════════════════════════════════════════════════════
     STAT PICKER DASHBOARD - Phase 3 (No-scroll, 3-column compact layout)
     ═══════════════════════════════════════════════════════════════════════════ */

  .sp-dashboard{
    height:100%;
    display:flex;
    flex-direction:column;
    overflow:hidden;
    padding:var(--gap-sm) var(--gap-md);
  }

  /* Password Gate */
  .sp-gate{
    display:flex;
    justify-content:center;
    align-items:center;
    height:100%;
  }
  .sp-gate-card{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:12px;
    padding:32px 40px;
    text-align:center;
  }
  .sp-gate-icon{ font-size:32px; margin-bottom:12px; }
  .sp-gate-card h2{ margin:0 0 4px; font-size:1.25rem; }
  .sp-gate-card p{ color:var(--muted); margin:0 0 16px; font-size:13px; }
  .sp-gate-form{ display:flex; gap:8px; }
  .sp-gate-form input{
    flex:1; padding:8px 12px;
    border:1px solid var(--border);
    border-radius:6px;
    background:var(--surface-2);
    color:var(--fg);
    font-size:13px;
  }
  .sp-gate-error{ color:var(--red); font-size:12px; margin-top:8px; }
  .sp-gate-caps{ color:var(--amber); font-size:12px; margin-top:8px; margin-bottom:0; }
  .sp-gate-dev{ margin-top:16px; padding-top:12px; border-top:1px solid var(--border); }
  .sp-btn-link{
    background:none;
    border:none;
    color:var(--muted);
    font-size:12px;
    cursor:pointer;
    text-decoration:underline;
    padding:0;
  }
  .sp-btn-link:hover{ color:var(--primary); }

  /* Header */
  .sp-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:4px 0 8px;
    flex-shrink:0;
  }
  .sp-header-left{ display:flex; align-items:baseline; gap:12px; }
  .sp-header h1{ margin:0; font-size:1.25rem; }
  .sp-tagline{ color:var(--muted); font-size:12px; }
  .sp-header-right{ display:flex; gap:6px; align-items:center; }
  .sp-select{
    padding:6px 10px;
    border:1px solid var(--border);
    border-radius:6px;
    background:var(--surface-2);
    color:var(--fg);
    font-size:12px;
  }
  .sp-btn{
    padding:6px 12px;
    border:1px solid var(--border);
    border-radius:6px;
    background:var(--surface-2);
    color:var(--fg);
    font-size:12px;
    cursor:pointer;
  }
  .sp-btn:hover{ background:var(--surface-3); }
  .sp-btn-danger{ border-color:var(--red); color:var(--red); }
  .sp-btn-danger:hover{ background:var(--red); color:#fff; }

  /* Main Grid - 3 columns (compact) */
  .sp-grid{
    display:grid;
    grid-template-columns:240px 1fr 260px;
    gap:var(--gap-md);
    flex:1;
    min-height:0;
    overflow:hidden;
  }
  @media (max-width:1400px){
    .sp-grid{grid-template-columns:220px 1fr 240px}
  }
  @media (max-width:1200px){
    .sp-grid{grid-template-columns:200px 1fr 220px}
  }
  .sp-col{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    min-height:0;
    overflow-y:auto;
  }
  .sp-col::-webkit-scrollbar{ width:3px; }
  .sp-col::-webkit-scrollbar-thumb{ background:var(--border); border-radius:2px; }

  /* Cards */
  .sp-card{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:6px;
    padding:var(--gap-sm) var(--gap-md);
    flex-shrink:0;
  }
  .sp-card-header{
    font-size:9px;
    font-weight:600;
    text-transform:uppercase;
    letter-spacing:0.4px;
    color:var(--muted);
    margin-bottom:var(--gap-sm);
    display:flex;
    justify-content:space-between;
    align-items:center;
  }
  .sp-card-ok{ border-left:3px solid var(--green); }
  .sp-card-warn{ border-left:3px solid var(--amber); }
  .sp-card-chip{ border-left:3px solid var(--accent); }
  .sp-card-small{ font-size:11px; }
  .sp-card-squad{ flex:1; min-height:0; display:flex; flex-direction:column; }

  /* Current State Panel */
  .sp-state-compact{
    display:grid;
    grid-template-columns:repeat(4, 1fr);
    gap:6px;
    margin-bottom:8px;
  }
  .sp-stat{
    text-align:center;
    padding:6px 4px;
    background:var(--surface-2);
    border-radius:6px;
  }
  .sp-stat-val{ display:block; font-size:14px; font-weight:700; color:var(--accent); }
  .sp-stat-lbl{ display:block; font-size:9px; color:var(--muted); text-transform:uppercase; }
  .sp-state-row{
    display:flex;
    justify-content:space-between;
    padding:4px 0;
    font-size:12px;
    border-bottom:1px solid var(--border);
  }
  .sp-state-row:last-child{ border-bottom:none; }
  .sp-state-row.sp-muted{ opacity:0.6; }
  .sp-chips-avail{ color:var(--green); font-weight:500; }

  /* Flags Panel */
  .sp-flag-row{
    display:grid;
    grid-template-columns:1fr auto auto;
    gap:8px;
    padding:4px 0;
    font-size:11px;
    align-items:center;
  }
  .sp-flag-name{ font-weight:500; }
  .sp-flag-status{
    padding:2px 6px;
    border-radius:4px;
    font-size:10px;
    font-weight:600;
  }
  .sp-flag-status[data-status="d"]{ background:var(--amber); color:#000; }
  .sp-flag-status[data-status="i"]{ background:var(--red); color:#fff; }
  .sp-flag-status[data-status="s"]{ background:#666; color:#fff; }
  .sp-flag-chance{ color:var(--muted); }
  .sp-ok-msg{ color:var(--green); font-size:12px; }

  /* Chip Panel */
  .sp-chip-none{ font-size:12px; color:var(--muted); }
  .sp-chip-rec{ display:flex; justify-content:space-between; align-items:center; margin-bottom:6px; }
  .sp-chip-name{ font-size:14px; font-weight:700; color:var(--accent); }
  .sp-chip-conf{
    padding:2px 8px;
    border-radius:4px;
    font-size:10px;
    font-weight:600;
  }
  .sp-conf-high{ background:var(--green); color:#000; }
  .sp-conf-medium{ background:var(--amber); color:#000; }
  .sp-chip-reason{ font-size:11px; color:var(--muted); margin-bottom:4px; }
  .sp-chip-gain{ font-size:12px; font-weight:600; color:var(--green); }

  /* Squad Panel (XI + Bench) */
  .sp-xi-list{
    flex:1;
    overflow-y:auto;
    min-height:0;
  }
  .sp-xi-row{
    display:grid;
    grid-template-columns:20px 1fr 36px 36px 80px;
    gap:4px;
    padding:5px 6px;
    font-size:12px;
    align-items:center;
    border-radius:4px;
  }
  .sp-bench-row{
    display:grid;
    grid-template-columns:16px 20px 1fr 36px;
    gap:4px;
    padding:5px 6px;
    font-size:12px;
    align-items:center;
    border-radius:4px;
  }
  .sp-xi-row:nth-child(odd){ background:var(--surface-2); }
  .sp-xi-row.sp-xi-flagged{ border-left:2px solid var(--amber); }
  .sp-xi-pos{
    font-size:10px;
    font-weight:600;
    color:var(--muted);
    text-align:center;
  }
  .sp-xi-name{ font-weight:500; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .sp-xi-team{ font-size:10px; color:var(--muted); text-align:right; }
  .sp-xi-xp{ font-weight:600; color:var(--accent); text-align:right; }
  .sp-xp-total{ font-size:10px; color:var(--accent); font-weight:600; }
  .sp-bench-header{
    font-size:10px;
    color:var(--muted);
    text-transform:uppercase;
    padding:6px 0 4px;
    border-top:1px solid var(--border);
    margin-top:6px;
  }
  .sp-bench-list{ opacity:0.7; }

  /* Captain Panel */
  .sp-cap-list{ display:flex; flex-direction:column; gap:4px; }
  .sp-cap-row{
    display:grid;
    grid-template-columns:24px 1fr 40px 40px;
    gap:6px;
    padding:5px 6px;
    font-size:12px;
    align-items:center;
    border-radius:4px;
  }
  .sp-cap-row:nth-child(odd){ background:var(--surface-2); }
  .sp-cap-best{ background:var(--accent) !important; color:#fff; }
  .sp-cap-best .sp-cap-xp, .sp-cap-best .sp-cap-mins{ color:#fff; }
  .sp-cap-rank{
    font-weight:700;
    text-align:center;
    font-size:11px;
  }
  .sp-cap-name{ font-weight:500; }
  .sp-cap-xp{ font-weight:600; color:var(--accent); text-align:right; }
  .sp-cap-mins{ font-size:10px; color:var(--muted); text-align:right; }

  /* Transfer Panel */
  .sp-action{
    font-size:14px;
    font-weight:700;
    margin-bottom:4px;
  }
  .sp-action-go{ color:var(--green); }
  .sp-action-hit{ color:var(--amber); }
  .sp-action-detail{ font-size:11px; color:var(--muted); margin-bottom:6px; }
  .sp-hit-cost{ font-size:11px; color:var(--red); }
  .sp-net-gain{ font-size:12px; color:var(--green); font-weight:600; margin-bottom:6px; }
  .sp-transfer-row{
    display:grid;
    grid-template-columns:1fr 20px 1fr 40px;
    gap:4px;
    padding:4px 0;
    font-size:11px;
    align-items:center;
    border-bottom:1px solid var(--border);
  }
  .sp-tr-players{
    display:grid;
    grid-template-columns:1fr 20px 1fr 40px;
    gap:4px;
    align-items:center;
  }
  .sp-tr-out{ color:var(--red); }
  .sp-tr-arrow{ text-align:center; color:var(--muted); }
  .sp-tr-in{ color:var(--green); font-weight:500; }
  .sp-tr-gain{ text-align:right; color:var(--green); font-weight:600; }
  .sp-tr-why{
    display:flex;
    flex-direction:column;
    gap:2px;
    font-size:10px;
    color:var(--muted);
    padding:4px 0 6px;
    margin-left:4px;
    border-left:2px solid var(--border);
    padding-left:8px;
  }
  .sp-tr-why-out{ color:var(--red-faded); }
  .sp-tr-why-in{ color:var(--green-faded); }
  .sp-baseline{
    font-size:10px;
    color:var(--muted);
    padding-top:8px;
    border-top:1px solid var(--border);
    margin-top:8px;
  }

  /* Explainability styles */
  .sp-xi-why{
    font-size:9px;
    color:var(--muted);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .sp-bench-order{
    width:14px;
    height:14px;
    display:flex;
    align-items:center;
    justify-content:center;
    background:var(--surface-2);
    border-radius:50%;
    font-size:9px;
    font-weight:600;
    color:var(--muted);
  }
  .sp-scoring-note{
    font-size:9px;
    color:var(--muted-2);
    padding-top:6px;
    border-top:1px solid var(--border);
    margin-top:6px;
    text-align:center;
  }
  .sp-scoring-link{
    font-size:10px;
    text-align:center;
    padding-top:8px;
    border-top:1px solid var(--border);
    margin-top:8px;
  }
  .sp-scoring-link a{
    color:var(--accent);
    text-decoration:none;
  }
  .sp-scoring-link a:hover{
    text-decoration:underline;
  }

  /* Fixtures Panel */
  .sp-fx-grid{ display:flex; flex-direction:column; gap:4px; }
  .sp-fx-row{
    display:grid;
    grid-template-columns:36px 1fr 28px;
    gap:6px;
    align-items:center;
    font-size:11px;
  }
  .sp-fx-team{ font-weight:600; font-size:10px; }
  .sp-fx-cells{ display:flex; gap:3px; flex-wrap:wrap; }
  .sp-fdr{
    padding:2px 4px;
    border-radius:3px;
    font-size:9px;
    font-weight:600;
  }
  .sp-fdr-1{ background:#00ff87; color:#1a1a2e; }
  .sp-fdr-2{ background:#00d17a; color:#1a1a2e; }
  .sp-fdr-3{ background:#e0e0d4; color:#1a1a2e; }
  .sp-fdr-4{ background:#ff5a5a; color:#fff; }
  .sp-fdr-5{ background:#861d1d; color:#fff; }
  .sp-fx-avg{
    font-size:10px;
    color:var(--muted);
    text-align:right;
  }

  /* Assumptions Panel */
  .sp-assumptions{
    margin:0;
    padding-left:16px;
    font-size:10px;
    color:var(--muted);
  }
  .sp-assumptions li{ margin-bottom:2px; }

  /* Loading & Error States */
  .sp-loading{
    display:flex;
    align-items:center;
    justify-content:center;
    height:100%;
    color:var(--muted);
    font-size:13px;
  }
  .sp-error-full{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    height:100%;
    text-align:center;
  }
  .sp-error-full h3{ margin:0 0 8px; }
  .sp-error-full p{ color:var(--muted); margin:0; }
  .sp-no-data{ color:var(--muted); font-size:12px; }

  /* Responsive: Collapse to 2 columns on smaller screens */
  @media(max-width:1200px){
    .sp-grid{
      grid-template-columns:260px 1fr;
    }
    .sp-col-right{
      display:none;
    }
  }

  /* Light mode */
  :root[data-theme="light"] .sp-card{ background:#fff; }
  :root[data-theme="light"] .sp-gate-card{ background:#fff; }
  :root[data-theme="light"] .sp-fdr-3{ background:#d4d4c8; }

  /* ═══════════════════════════════════════════════════════════════════════════
     LEAGUE PAGE - PHASE 3 (Selector Grid + Detail View, compact, no scrolling)
     ═══════════════════════════════════════════════════════════════════════════ */

  .league-page{
    height:100%;
    display:flex;
    flex-direction:column;
    overflow:hidden;
    padding:var(--gap-md);
  }

  /* Header */
  .league-header{
    display:flex;
    align-items:center;
    gap:var(--gap-md);
    margin-bottom:var(--gap-md);
    flex-shrink:0;
  }
  .league-header h1{
    font-size:1.1rem;
    font-weight:700;
    margin:0;
  }
  .league-gw-badge{
    font-size:10px;
    font-weight:600;
    padding:3px 8px;
    background:var(--accent-weak);
    color:var(--accent-light);
    border-radius:4px;
  }

  /* Selector Grid */
  .league-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(240px, 1fr));
    gap:var(--gap-md);
    flex:1;
    min-height:0;
    overflow:auto;
    align-content:start;
  }

  .league-card{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    padding:var(--gap-md);
    cursor:pointer;
    transition:all 0.15s;
    display:flex;
    flex-direction:column;
    max-height:180px;
  }
  .league-card:hover{
    border-color:var(--accent);
    box-shadow:var(--shadow-sm);
  }
  .league-card-loading{
    justify-content:center;
    align-items:center;
  }
  .league-card-skeleton{
    color:var(--muted);
    font-size:11px;
  }
  .league-card-header{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    margin-bottom:var(--gap-sm);
  }
  .league-card-header h3{
    font-size:0.9rem;
    font-weight:700;
    margin:0;
    flex:1;
    overflow:hidden;
    text-overflow:ellipsis;
    white-space:nowrap;
  }
  .league-card-count{
    font-size:9px;
    color:var(--muted);
    background:var(--surface-2);
    padding:2px 6px;
    border-radius:3px;
    white-space:nowrap;
  }

  .league-card-stats{
    display:grid;
    grid-template-columns:repeat(4, 1fr);
    gap:var(--gap-sm);
    margin-bottom:var(--gap-sm);
  }
  .league-stat{
    text-align:center;
  }
  .league-stat-full{
    grid-column:span 4;
  }
  .league-stat-val{
    display:block;
    font-size:1rem;
    font-weight:700;
    color:var(--text);
  }
  .league-stat-val.stat-behind{
    color:var(--red);
  }
  .league-stat-val.stat-leading{
    color:var(--green);
  }
  .league-stat-lbl{
    display:block;
    font-size:9px;
    color:var(--muted);
    text-transform:uppercase;
    margin-top:1px;
  }

  .league-card-leader{
    display:flex;
    justify-content:space-between;
    font-size:10px;
    color:var(--muted);
    padding-top:var(--gap-sm);
    border-top:1px solid var(--border);
    margin-top:auto;
  }
  .league-card-error{
    color:var(--red);
    font-size:11px;
    text-align:center;
    padding:var(--gap-lg);
  }

  /* Detail View */
  .league-detail-header{
    display:flex;
    align-items:center;
    gap:var(--gap-md);
    margin-bottom:var(--gap-md);
    flex-shrink:0;
  }
  .league-back-btn{
    padding:5px 12px;
    font-size:11px;
    font-weight:500;
    background:var(--surface-2);
    color:var(--text);
    border:1px solid var(--border);
    border-radius:6px;
    cursor:pointer;
    transition:all 0.15s;
  }
  .league-back-btn:hover{
    background:var(--surface-3);
    border-color:var(--accent);
  }
  .league-detail-header h2{
    flex:1;
    font-size:1rem;
    font-weight:700;
    margin:0;
  }

  .league-detail-grid{
    display:grid;
    grid-template-columns:260px 1fr 200px;
    gap:var(--gap-md);
    flex:1;
    min-height:0;
    overflow:hidden;
  }
  @media (max-width:1200px){
    .league-detail-grid{grid-template-columns:1fr 1fr}
  }
  .league-detail-col{
    display:flex;
    flex-direction:column;
    gap:var(--gap-sm);
    min-height:0;
    overflow:hidden;
  }
  .league-detail-card{
    background:var(--surface-1);
    border:1px solid var(--border);
    border-radius:8px;
    padding:var(--gap-md);
    display:flex;
    flex-direction:column;
    min-height:0;
    overflow:hidden;
  }
  .league-detail-card h3{
    font-size:10px;
    font-weight:600;
    text-transform:uppercase;
    color:var(--muted);
    margin:0 0 var(--gap-sm);
  }

  .league-standings{
    flex:1;
    overflow-y:auto;
    min-height:0;
  }
  .league-standings table{
    font-size:11px;
  }

  .league-chart-card{
    flex:1;
    min-height:0;
  }
  .league-chart-wrap{
    flex:1;
    min-height:100px;
    position:relative;
  }
  .league-chart-wrap canvas{
    width:100% !important;
    height:100% !important;
  }

  .league-xi{
    display:flex;
    flex-direction:column;
    gap:4px;
    overflow-y:auto;
  }
  .league-xi-row{
    display:grid;
    grid-template-columns:28px 1fr 36px 60px;
    gap:6px;
    align-items:center;
    padding:4px 6px;
    font-size:11px;
    border-radius:4px;
  }
  .league-xi-row:nth-child(odd){
    background:var(--surface-2);
  }
  .league-xi-pos{
    font-size:10px;
    font-weight:600;
    color:var(--muted);
    text-align:center;
  }
  .league-xi-name{
    font-weight:500;
    overflow:hidden;
    text-overflow:ellipsis;
    white-space:nowrap;
  }
  .league-xi-team{
    font-size:10px;
    color:var(--muted);
    text-align:center;
  }
  .league-xi-picked{
    font-size:10px;
    color:var(--accent);
    text-align:right;
  }
  .league-xi-empty{
    color:var(--muted);
    font-size:12px;
    text-align:center;
    padding:20px;
  }

  /* Loading & Empty States */
  .league-loading{
    display:flex;
    justify-content:center;
    align-items:center;
    height:100%;
    color:var(--muted);
    font-size:14px;
  }
  .league-empty{
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    height:100%;
    text-align:center;
  }
  .league-empty h3{
    margin:0 0 8px;
    font-size:1.25rem;
  }
  .league-empty p{
    margin:0;
    color:var(--muted);
  }
  .league-error{
    background:rgba(244,63,94,0.1);
    border:1px solid var(--red);
    border-radius:10px;
    padding:20px;
    text-align:center;
    margin:20px;
  }
  .league-error h3{
    margin:0 0 8px;
    color:var(--red);
  }
  .league-error p{
    margin:0;
    color:var(--muted);
    font-size:13px;
  }

  /* Responsive for Detail View */
  @media(max-width:1100px){
    .league-detail-grid{
      grid-template-columns:1fr 1fr;
    }
    .league-detail-right{
      display:none;
    }
  }
  @media(max-width:700px){
    .league-detail-grid{
      grid-template-columns:1fr;
    }
    .league-detail-center{
      display:none;
    }
  }

  /* Light mode */
  :root[data-theme="light"] .league-card{ background:#fff; }
  :root[data-theme="light"] .league-detail-card{ background:#fff; }

/* ═══════════════════════════════════════════════════════════════════════════════
   UI LAYOUT & SPACING FIXES - 4K-first, responsive design
   Target resolutions: 3840×2160 (4K), 2560×1440 (1440p), 1920×1080 (1080p)
   ═══════════════════════════════════════════════════════════════════════════════ */

/* ─── GLOBAL FIXES ───────────────────────────────────────────────────────────── */

/* 1. Fix topbar/header so deadline never overlaps page content */
.topbar {
  position: sticky;
  top: 0;
  z-index: 100;
  min-height: var(--topbar-height);
  height: auto; /* Allow height to expand on wrap */
}

/* Ensure the app container accounts for wrapped topbar */
.app {
  margin-top: 0;
  padding-top: var(--gap-md);
}

/* When topbar wraps (nav moves to new line), add extra space */
@media (max-width: 1100px) {
  :root {
    --topbar-height-wrapped: 100px;
  }
  .app {
    height: calc(100vh - var(--topbar-height-wrapped));
    max-height: calc(100vh - var(--topbar-height-wrapped));
  }
}

/* 2. Consistent internal padding for cards and tiles to prevent clipping */
.card,
.tile,
.portal-tile,
.sp-card,
.league-card,
.league-detail-card,
.help-tile {
  padding: var(--gap-md);
}

.card h3,
.tile-header,
.portal-tile .tile-header,
.sp-card-header {
  padding-bottom: var(--gap-xs);
  margin-bottom: var(--gap-sm);
}

/* Ensure tile-title and card headers have breathing room from borders */
.tile-title,
.portal-tile .tile-title,
.card h3 {
  padding: 2px 4px;
  margin: -2px -4px;
}

/* 3. Tooltip auto-flip improvements - render above cards with higher z-index */
.abbr-tip {
  position: relative;
  z-index: 1;
}

.abbr-tip::after {
  z-index: 10000;
  pointer-events: none;
}

/* Tooltip positioning variants for auto-flip */
.abbr-tip.tooltip-flip-down::after {
  top: auto;
  bottom: calc(-100% - 16px);
  transform: translate(-50%, 0) scale(0.98);
}
.abbr-tip.tooltip-flip-down:hover::after {
  transform: translate(-50%, 0) scale(1);
}

/* Tooltip container for cards - ensure tooltips aren't clipped */
.tile,
.card,
.portal-tile,
.sp-card,
.table-scroll-wrapper,
.table-scroll-container {
  overflow: visible;
}

/* But inner bodies can scroll */
.tile-body,
.card-scroll,
.table-scroll-wrapper .table,
.table-scroll-container .table {
  overflow: auto;
}

/* ─── 4K BREAKPOINTS & MULTI-COLUMN LAYOUTS ──────────────────────────────────── */

/* 4K displays (3840px and up) - maximize screen real estate */
@media (min-width: 2560px) {
  :root {
    --gap-xs: 6px;
    --gap-sm: 8px;
    --gap-md: 12px;
    --gap-lg: 16px;
    --gap-xl: 20px;
    --card-padding: clamp(12px, 10px + 0.3vw, 18px);
    --font-scale: clamp(0.85rem, 0.8rem + 0.15vw, 0.95rem);
  }

  .sidebar {
    width: 320px;
  }
  :root {
    --sidebar-width: 320px;
  }

  .app {
    padding: var(--gap-lg) var(--gap-xl);
  }
}

@media (min-width: 3200px) {
  :root {
    --gap-md: 14px;
    --gap-lg: 18px;
    --gap-xl: 24px;
  }

  .sidebar {
    width: 360px;
  }
  :root {
    --sidebar-width: 360px;
  }
}

/* ─── PORTAL PAGE FIXES ──────────────────────────────────────────────────────── */

/* Multi-column grid that uses space better on large screens */
.portal-page {
  height: 100%;
  display: grid;
  gap: var(--gap-md);
  overflow: hidden;
}

/* 4K: 4-column layout */
@media (min-width: 2560px) {
  .portal-page {
    grid-template-columns: 300px 1fr 1fr 300px;
  }
  .portal-column:first-child {
    grid-column: 1;
  }
  .portal-column-center {
    grid-column: 2 / 4;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--gap-md);
    align-content: start;
  }
  .portal-column:last-child {
    grid-column: 4;
  }
}

/* 1440p: Balanced 3-column */
@media (min-width: 1440px) and (max-width: 2559px) {
  .portal-page {
    grid-template-columns: 280px 1fr 280px;
  }
}

/* 1080p and below: Stack layout */
@media (max-width: 1439px) {
  .portal-page {
    grid-template-columns: 240px 1fr 240px;
  }
}

@media (max-width: 1100px) {
  .portal-page {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr;
  }
  .portal-column-center {
    grid-column: 1 / -1;
    order: -1;
  }
}

@media (max-width: 768px) {
  .portal-page {
    grid-template-columns: 1fr;
  }
}

/* Make Fixture Outlook and Captain Picks cards taller */
.portal-tile.tile-fixtures,
.portal-tile.tile-captain {
  min-height: 280px;
  flex: 1;
}

.portal-tile .tile-body {
  max-height: none;
  flex: 1;
}

/* Balance injuries, swings, transfers tiles with better height */
.portal-column .portal-tile {
  flex: 1;
  min-height: 160px;
}

/* ─── MY TEAM PAGE FIXES ─────────────────────────────────────────────────────── */

.my-team-page {
  display: grid;
  height: 100%;
  gap: var(--gap-md);
  overflow: hidden;
}

/* 4K and 1440p: Starting XI dominant (60%) with Insights (40%) */
@media (min-width: 1440px) {
  .my-team-page {
    grid-template-columns: 1fr 400px;
    grid-template-rows: auto 1fr;
  }

  .my-team-page .team-header-card {
    grid-column: 1 / -1;
  }

  .my-team-page .pitch-card {
    grid-column: 1;
    grid-row: 2;
  }

  .my-team-page .insights-card {
    grid-column: 2;
    grid-row: 2;
    overflow: auto;
  }
}

/* 4K: Give insights more room */
@media (min-width: 2560px) {
  .my-team-page {
    grid-template-columns: 1fr 480px;
  }
}

@media (min-width: 3200px) {
  .my-team-page {
    grid-template-columns: 1fr 560px;
  }
}

/* 1080p: Stack vertically */
@media (max-width: 1439px) {
  .my-team-page {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
    overflow: auto;
  }
}

/* Make pitch visualization fill its container better */
.pitch-card {
  display: flex;
  flex-direction: column;
}

.pitch-container {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.pitch-grass {
  flex: 1;
  min-height: 350px;
}

/* Insights card improvements */
.insights-card {
  display: flex;
  flex-direction: column;
}

.insights-list {
  flex: 1;
  overflow: auto;
}

/* ─── PLAYERS PAGE FIXES ─────────────────────────────────────────────────────── */

/* Fix padding and clipping on table headers */
.players-dashboard .table th,
.players-dashboard .table td {
  padding: 8px 12px;
}

/* Ensure table headers don't clip */
.table th {
  padding: 8px 12px;
  white-space: nowrap;
}

.table-compact th {
  padding: 6px 10px;
}

/* 4K: Better use of horizontal space */
@media (min-width: 2560px) {
  .players-dashboard {
    grid-template-columns: minmax(400px, 1fr) minmax(600px, 2fr);
  }
}

/* ─── FIXTURES PAGE FIXES ────────────────────────────────────────────────────── */

.fixtures-dashboard {
  gap: var(--gap-md);
}

/* Reduce dead space */
.fixtures-dashboard .card {
  margin: 0;
}

/* Better fixture grid on large screens */
@media (min-width: 2560px) {
  .fixtures-content {
    grid-template-columns: 1fr 1fr 1fr;
  }
}

/* ─── EXPLORER PAGE REDESIGN ─────────────────────────────────────────────────── */

.gw-dashboard {
  display: grid;
  grid-template-rows: auto auto 1fr;
  gap: var(--gap-md);
  height: 100%;
  overflow: hidden;
}

/* Styled toolbar that matches the app design */
.gw-dashboard .toolbar-compact {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: var(--gap-md) var(--gap-lg);
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: var(--gap-sm);
}

/* Summary and TOTW as proper cards */
.gw-top-row {
  display: grid;
  gap: var(--gap-md);
}

@media (min-width: 1440px) {
  .gw-top-row {
    grid-template-columns: 1fr 1fr;
  }
}

@media (min-width: 2560px) {
  .gw-top-row {
    grid-template-columns: 1fr 2fr;
  }
}

.gw-top-row > div {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: var(--gap-lg);
}

.gw-top-row h3 {
  margin-bottom: var(--gap-md);
  padding-bottom: var(--gap-sm);
  border-bottom: 1px solid var(--border);
  font-size: 0.95rem;
}

.gw-top-row h4 {
  margin-top: var(--gap-md);
  margin-bottom: var(--gap-sm);
  font-size: 0.85rem;
  color: var(--muted);
}

.gw-top-row ul {
  margin: 0;
  padding-left: 20px;
  font-size: 12px;
  line-height: 1.6;
}

.gw-top-row .chips {
  margin-bottom: var(--gap-md);
}

/* GW Player table as full-width card */
.gw-table-container {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 10px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.gw-table-container h3 {
  padding: var(--gap-md) var(--gap-lg);
  margin: 0;
  border-bottom: 1px solid var(--border);
  font-size: 0.95rem;
  flex-shrink: 0;
}

.gw-table-container .table {
  flex: 1;
  overflow: auto;
}

/* ─── LEAGUE PAGE FIXES ──────────────────────────────────────────────────────── */

/* Wider standings column */
.league-detail-grid {
  display: grid;
  gap: var(--gap-md);
}

@media (min-width: 1440px) {
  .league-detail-grid {
    grid-template-columns: 340px 1fr 280px;
  }
}

@media (min-width: 2560px) {
  .league-detail-grid {
    grid-template-columns: 400px 1fr 360px;
  }
}

@media (min-width: 3200px) {
  .league-detail-grid {
    grid-template-columns: 480px 1fr 420px;
  }
}

/* Readable player names in Top XI */
.league-xi-row {
  grid-template-columns: 32px 1fr 48px 80px;
  gap: 8px;
  padding: 6px 8px;
  font-size: 12px;
}

.league-xi-name {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Show more context in league cards without truncation */
.league-card {
  min-height: 200px;
  max-height: none;
}

.league-card-header h3 {
  white-space: normal;
  overflow: visible;
  text-overflow: unset;
  line-height: 1.3;
}

/* Clear back button styling */
.league-back-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 16px;
  font-size: 13px;
  font-weight: 600;
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: 8px;
  color: var(--text);
  cursor: pointer;
  transition: all 0.2s;
}

.league-back-btn:hover {
  background: var(--accent-weak);
  border-color: var(--accent);
  color: var(--accent-light);
}

.league-back-btn::before {
  content: "←";
  font-size: 14px;
}

/* Responsive: Stack Top XI under standings on smaller screens */
@media (max-width: 1439px) {
  .league-detail-grid {
    grid-template-columns: 1fr 1fr;
  }

  .league-detail-right {
    grid-column: 1 / -1;
  }
}

@media (max-width: 900px) {
  .league-detail-grid {
    grid-template-columns: 1fr;
  }
}

/* ─── STAT PICKER FIXES ──────────────────────────────────────────────────────── */

/* Three-zone layout with better proportions */
.sp-grid {
  display: grid;
  gap: var(--gap-md);
}

@media (min-width: 1440px) {
  .sp-grid {
    grid-template-columns: 280px 1fr 300px;
  }
}

@media (min-width: 2560px) {
  .sp-grid {
    grid-template-columns: 340px 1fr 380px;
  }
}

@media (min-width: 3200px) {
  .sp-grid {
    grid-template-columns: 400px 1fr 450px;
  }
}

/* Give transfer explanations more breathing room */
.sp-tr-why {
  padding: 8px 0 10px;
  margin-left: 6px;
  line-height: 1.5;
  font-size: 11px;
}

.sp-transfer-row {
  padding: 8px 0;
  margin-bottom: 4px;
}

/* Reduce cramping in cards */
.sp-card {
  padding: var(--gap-md) var(--gap-lg);
}

.sp-card-header {
  margin-bottom: var(--gap-md);
}

/* Current state panel - better stat grid */
.sp-state-compact {
  gap: 8px;
  margin-bottom: 12px;
}

.sp-stat {
  padding: 8px 6px;
}

/* ─── HELP PAGE FIXES ────────────────────────────────────────────────────────── */

.help-dashboard {
  display: grid;
  gap: var(--gap-md);
  height: 100%;
  overflow: auto;
}

/* Multi-column on large screens */
@media (min-width: 1440px) {
  .help-dashboard {
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(2, auto);
    align-content: start;
  }
}

@media (min-width: 2560px) {
  .help-dashboard {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (min-width: 3200px) {
  .help-dashboard {
    grid-template-columns: repeat(4, 1fr);
  }
}

/* Ensure tooltips in help never clip */
.help-tile {
  overflow: visible;
}

.help-tile .help-body {
  overflow: visible;
}

.help-tile .help-scroll {
  overflow: auto;
  max-height: 300px;
}

@media (min-width: 2560px) {
  .help-tile .help-scroll {
    max-height: 400px;
  }
}

/* ─── ADDITIONAL POLISH ──────────────────────────────────────────────────────── */

/* Prevent narrow centered columns on large screens */
.page-wrapper,
.dashboard {
  max-width: none;
  width: 100%;
}

/* Ensure tables are readable at all sizes */
.table {
  width: 100%;
  table-layout: auto;
}

/* Better grid column utilities for 4K */
@media (min-width: 2560px) {
  .grid.cols-2 { grid-template-columns: repeat(2, 1fr); }
  .grid.cols-3 { grid-template-columns: repeat(3, 1fr); }
  .grid.cols-4 { grid-template-columns: repeat(4, 1fr); }
  .grid.cols-5 { grid-template-columns: repeat(5, 1fr); }
  .grid.cols-6 { grid-template-columns: repeat(6, 1fr); }
}

/* Responsive grid utilities */
@media (min-width: 1440px) {
  .grid-4k-3 { grid-template-columns: repeat(3, 1fr); }
  .grid-4k-4 { grid-template-columns: repeat(4, 1fr); }
}

@media (min-width: 2560px) {
  .grid-4k-3 { grid-template-columns: repeat(4, 1fr); }
  .grid-4k-4 { grid-template-columns: repeat(6, 1fr); }
}

/* Ensure scrollable containers work properly */
.tile-body,
.card-scroll,
.league-standings,
.sp-xi-list,
.insights-list {
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

.tile-body::-webkit-scrollbar,
.card-scroll::-webkit-scrollbar,
.league-standings::-webkit-scrollbar,
.sp-xi-list::-webkit-scrollbar,
.insights-list::-webkit-scrollbar {
  width: 4px;
}

.tile-body::-webkit-scrollbar-thumb,
.card-scroll::-webkit-scrollbar-thumb,
.league-standings::-webkit-scrollbar-thumb,
.sp-xi-list::-webkit-scrollbar-thumb,
.insights-list::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 2px;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   COMPREHENSIVE UI/UX SPACING PASS - Dec 2025
   Density, hierarchy, and clipping fixes for Power BI-style dashboards
   ═══════════════════════════════════════════════════════════════════════════════ */

/* ─── GLOBAL BOTTOM PADDING FIX ─────────────────────────────────────────────── */
/* Consistent breathing room at bottom of viewport across all pages */
.app {
  padding-bottom: var(--gap-lg);
}

.page-wrapper,
.portal-page,
.my-team-page,
.players-dashboard,
.fixtures-dashboard,
.gw-dashboard,
.league-page,
.sp-dashboard,
.help-dashboard {
  padding-bottom: var(--gap-md);
}

/* ─── HEADER HEIGHT CAP ─────────────────────────────────────────────────────── */
/* Reduce excessive Next Deadline / topbar area */
.topbar {
  max-height: 56px;
  padding: var(--gap-xs) var(--gap-md);
}

.topbar-deadline {
  font-size: 12px;
  padding: 4px 8px;
}

.topbar-timer {
  font-size: 13px;
}

/* ─── TOOLTIP AUTO-FLIP WITHIN CARD BOUNDS ──────────────────────────────────── */
.abbr-tip {
  position: relative;
}

.abbr-tip::after {
  z-index: 10001;
  max-width: min(280px, 90vw);
  word-wrap: break-word;
}

/* Auto-flip when near viewport edges */
.abbr-tip[data-pos="bottom"]::after,
.abbr-tip.flip-bottom::after {
  top: auto;
  bottom: -8px;
  transform: translate(-50%, 100%) scale(0.98);
}

.abbr-tip[data-pos="bottom"]:hover::after,
.abbr-tip.flip-bottom:hover::after {
  transform: translate(-50%, 110%) scale(1);
}

/* Cards allow tooltip overflow */
.card,
.tile,
.portal-tile,
.sp-card,
.league-card,
.league-detail-card {
  overflow: visible;
}

/* But scrollable containers still scroll internally */
.tile-body,
.card-scroll,
.table-scroll-wrapper,
.table-scroll-container {
  overflow: auto;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   PORTAL PAGE - Better vertical utilization
   ═══════════════════════════════════════════════════════════════════════════════ */

.portal-page {
  height: calc(100% - var(--gap-md));
  grid-template-rows: 1fr;
}

/* Columns fill height and allow internal scroll */
.portal-column,
.portal-column-center {
  height: 100%;
  max-height: 100%;
  overflow: hidden;
}

.portal-column {
  display: flex;
  flex-direction: column;
  gap: var(--gap-sm);
}

/* Left/right column tiles fill available space */
.portal-column > .portal-tile {
  flex: 1;
  min-height: 120px;
}

/* Deadline tile is fixed height, not flex */
.portal-column > .portal-tile.tile-deadline {
  flex: 0 0 auto;
  min-height: auto;
}

/* Header is also fixed */
.portal-column > .portal-header {
  flex: 0 0 auto;
}

/* Center column tiles - Fixture Outlook and Captain Picks taller */
.portal-column-center > .portal-tile {
  flex: 1;
  min-height: 200px;
  display: flex;
  flex-direction: column;
}

.portal-column-center > .portal-tile .tile-body {
  flex: 1;
  min-height: 0;
  max-height: none;
  overflow-y: auto;
}

/* Sibling cards terminate at similar heights */
@media (min-width: 1200px) {
  .portal-page {
    grid-template-columns: 280px 1fr 280px;
  }

  .portal-column-center {
    display: flex;
    flex-direction: column;
    gap: var(--gap-sm);
  }
}

@media (min-width: 1600px) {
  .portal-page {
    grid-template-columns: 300px 1fr 300px;
  }
}

@media (min-width: 2200px) {
  .portal-page {
    grid-template-columns: 340px 1fr 340px;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   MY TEAM PAGE - Pitch at ~50%, Insights restructured
   ═══════════════════════════════════════════════════════════════════════════════ */

.my-team-page,
.dashboard {
  display: grid;
  height: calc(100% - var(--gap-md));
  gap: var(--gap-md);
  overflow: hidden;
}

/* 2-column layout: Pitch dominant left, insights right */
@media (min-width: 1100px) {
  .my-team-page,
  .dashboard {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto 1fr;
  }

  .my-team-page .team-header-card,
  .dashboard .team-header-card {
    grid-column: 1 / -1;
  }

  .my-team-page .dashboard-main,
  .dashboard .dashboard-main {
    display: contents;
  }

  .dashboard-left {
    display: flex;
    flex-direction: column;
  }

  .dashboard-right {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr auto auto;
    gap: var(--gap-sm);
    overflow-y: auto;
  }

  /* Insights card spans full width top */
  .dashboard-right .tile.tile-wide:first-child {
    grid-column: 1 / -1;
  }

  /* Fixtures preview spans full width */
  .dashboard-right .tile.tile-wide:nth-child(2) {
    grid-column: 1 / -1;
  }

  /* Top Performer and Team XP side by side in upper area */
  .dashboard-right .tile.tile-compact {
    grid-column: auto;
  }
}

/* Make pitch fill its container */
.tile-flush,
.pitch-card {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.pitch-card .tile-body {
  flex: 1;
  min-height: 0;
  overflow: hidden;
}

.pitch-container {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.pitch-grass {
  flex: 1;
  min-height: 280px;
}

/* Insights tile scrollable */
.tile.tile-wide {
  max-height: none;
}

.insights-card .insights-list {
  max-height: 160px;
  overflow-y: auto;
}

/* Fixtures preview compact */
.fixtures-preview-grid {
  max-height: 140px;
  overflow-y: auto;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   PLAYERS PAGE - Remove dead space below chart, fix card padding
   ═══════════════════════════════════════════════════════════════════════════════ */

.players-dashboard {
  display: grid;
  height: calc(100% - var(--gap-md));
  gap: var(--gap-md);
  overflow: hidden;
}

@media (min-width: 1200px) {
  .players-dashboard {
    grid-template-columns: minmax(350px, 1fr) minmax(500px, 2fr);
    grid-template-rows: auto 1fr;
  }

  .players-dashboard .players-filters {
    grid-column: 1 / -1;
  }

  .players-dashboard .players-chart {
    display: flex;
    flex-direction: column;
    min-height: 0;
  }

  .players-dashboard .players-chart .tile-header {
    flex-shrink: 0;
  }

  .players-dashboard .players-chart #ap-chart-slot {
    flex: 1;
    min-height: 0;
    overflow: hidden;
  }

  .players-dashboard .players-table {
    display: flex;
    flex-direction: column;
    min-height: 0;
  }
}

/* Card padding fix for beveled edges */
.card,
.tile,
.portal-tile {
  padding: var(--gap-md);
}

.card h3,
.tile-header,
.tile-title {
  margin-left: 0;
  margin-right: 0;
  padding-left: 2px;
  padding-right: 2px;
}

/* Ensure table headers don't clip */
.table th {
  padding: 8px 10px;
}

.table-compact th {
  padding: 6px 8px;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   FIXTURES PAGE - Expand matrix to full width, reduce chart height
   ═══════════════════════════════════════════════════════════════════════════════ */

.fixtures-dashboard {
  display: flex;
  flex-direction: column;
  height: calc(100% - var(--gap-md));
  gap: var(--gap-md);
  overflow: hidden;
}

.fixtures-content {
  display: grid;
  flex: 1;
  min-height: 0;
  gap: var(--gap-md);
  overflow: hidden;
}

@media (min-width: 1200px) {
  .fixtures-content {
    grid-template-columns: 2fr 1fr;
  }
}

@media (min-width: 1600px) {
  .fixtures-content {
    grid-template-columns: 3fr 1fr;
  }
}

/* Matrix card scrolls horizontally but expands to fill */
.fixtures-content .card:first-child {
  min-width: 0;
  overflow: auto;
}

.matrix-wrap {
  min-width: max-content;
  overflow-x: auto;
}

.matrix-wrap .table {
  min-width: 100%;
  width: max-content;
}

/* Chart card - reduced height */
.fixtures-content .card:last-child {
  max-height: 500px;
  overflow: hidden;
}

@media (max-width: 1199px) {
  .fixtures-content {
    grid-template-columns: 1fr;
    grid-template-rows: 1fr auto;
  }

  .fixtures-content .card:last-child {
    max-height: 300px;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   EXPLORER PAGE - Clear grid layout, styled filters
   ═══════════════════════════════════════════════════════════════════════════════ */

.gw-dashboard {
  display: grid;
  height: calc(100% - var(--gap-md));
  gap: var(--gap-md);
  overflow: hidden;
  grid-template-rows: auto auto 1fr;
}

/* Toolbar matches Players page style */
.gw-dashboard .toolbar-compact {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: var(--gap-sm) var(--gap-md);
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: var(--gap-sm);
}

.gw-dashboard .toolbar-compact input,
.gw-dashboard .toolbar-compact select {
  background: var(--surface-1);
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 6px 10px;
  font-size: 12px;
  color: var(--text);
}

.gw-dashboard .toolbar-compact input:focus,
.gw-dashboard .toolbar-compact select:focus {
  outline: none;
  border-color: var(--accent);
}

/* Top row: GW Summary left, Team of Week right */
.gw-top-row {
  display: grid;
  gap: var(--gap-md);
  min-height: 200px;
  max-height: 280px;
  overflow: hidden;
}

@media (min-width: 1100px) {
  .gw-top-row {
    grid-template-columns: 1fr 2fr;
  }
}

.gw-top-row > div {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: var(--gap-md);
  overflow: auto;
}

.gw-top-row h3 {
  font-size: 0.9rem;
  margin: 0 0 var(--gap-sm);
  padding-bottom: var(--gap-xs);
  border-bottom: 1px solid var(--border);
}

.gw-top-row h4 {
  font-size: 0.8rem;
  margin: var(--gap-sm) 0 var(--gap-xs);
  color: var(--muted);
}

.gw-top-row ul {
  margin: 0;
  padding-left: 16px;
  font-size: 11px;
  line-height: 1.5;
}

/* Player table full width, scrollable */
.gw-table-container {
  background: var(--bg2);
  border: 1px solid var(--border);
  border-radius: 10px;
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow: hidden;
}

.gw-table-container h3 {
  padding: var(--gap-sm) var(--gap-md);
  margin: 0;
  font-size: 0.9rem;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}

.gw-table-container .table {
  overflow: auto;
  flex: 1;
  min-height: 0;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   LEAGUE PAGES - Reduce padding, widen standings, restructure detail
   ═══════════════════════════════════════════════════════════════════════════════ */

.league-page {
  height: calc(100% - var(--gap-md));
  padding: var(--gap-sm) var(--gap-md);
  overflow: hidden;
}

/* Selector cards - reduce padding, fix clipping */
.league-card {
  padding: var(--gap-sm) var(--gap-md);
  max-height: none;
  min-height: 160px;
}

.league-card-stats {
  gap: var(--gap-xs);
  margin-bottom: var(--gap-xs);
}

.league-stat-val {
  font-size: 0.95rem;
}

.league-stat-lbl {
  font-size: 8px;
}

.league-card-leader {
  padding-top: var(--gap-xs);
  font-size: 9px;
}

/* Detail view - restructured layout */
.league-detail-grid {
  display: grid;
  gap: var(--gap-md);
  height: 100%;
  overflow: hidden;
}

/* Left: Standings + Top XI stacked vertically */
/* Right: Charts side by side or stacked */
@media (min-width: 1200px) {
  .league-detail-grid {
    grid-template-columns: minmax(300px, 400px) 1fr;
    grid-template-rows: 1fr;
  }

  .league-detail-left {
    display: flex;
    flex-direction: column;
    gap: var(--gap-sm);
    min-height: 0;
    overflow: hidden;
  }

  /* Standings fills most of left column */
  .league-detail-left .league-detail-card:first-child {
    flex: 2;
    min-height: 0;
    overflow: hidden;
  }

  /* Top XI below standings */
  .league-detail-left .league-detail-card:last-child,
  .league-detail-right {
    flex: 1;
    min-height: 0;
    overflow: auto;
  }

  /* Charts column */
  .league-detail-center {
    display: flex;
    flex-direction: column;
    gap: var(--gap-sm);
    min-height: 0;
    overflow: hidden;
  }

  .league-detail-center .league-chart-card {
    flex: 1;
    min-height: 150px;
    max-height: 280px;
  }
}

/* Widen standings table */
.league-standings {
  flex: 1;
  min-height: 0;
  overflow: auto;
}

.league-standings .table {
  width: 100%;
}

.league-standings .table th,
.league-standings .table td {
  padding: 6px 10px;
  font-size: 11px;
}

/* Top XI more compact */
.league-xi-row {
  padding: 4px 6px;
  font-size: 11px;
  grid-template-columns: 28px 1fr 40px 70px;
  gap: 4px;
}

/* Reduce chart height */
.league-chart-wrap {
  min-height: 120px;
  max-height: 200px;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   STAT PICKER PAGE - Dashboard grid, tighter padding
   ═══════════════════════════════════════════════════════════════════════════════ */

.sp-dashboard {
  height: calc(100% - var(--gap-md));
  padding: var(--gap-sm) var(--gap-md);
  overflow: hidden;
}

.sp-header {
  padding: var(--gap-xs) 0;
  margin-bottom: var(--gap-sm);
}

.sp-header h1 {
  font-size: 1.1rem;
}

.sp-tagline {
  font-size: 11px;
}

/* 3-column dashboard grid */
.sp-grid {
  display: grid;
  gap: var(--gap-sm);
  height: 100%;
  min-height: 0;
  overflow: hidden;
}

@media (min-width: 1100px) {
  .sp-grid {
    grid-template-columns: 240px 1fr 280px;
  }
}

@media (min-width: 1400px) {
  .sp-grid {
    grid-template-columns: 260px 1fr 300px;
  }
}

@media (min-width: 1800px) {
  .sp-grid {
    grid-template-columns: 280px 1fr 340px;
  }
}

.sp-col {
  display: flex;
  flex-direction: column;
  gap: var(--gap-xs);
  min-height: 0;
  overflow-y: auto;
}

/* Cards - tighter padding */
.sp-card {
  padding: var(--gap-xs) var(--gap-sm);
  flex-shrink: 0;
}

.sp-card-header {
  font-size: 8px;
  margin-bottom: var(--gap-xs);
}

/* Current state compact stats */
.sp-state-compact {
  gap: 4px;
  margin-bottom: var(--gap-xs);
}

.sp-stat {
  padding: 4px 3px;
}

.sp-stat-val {
  font-size: 12px;
}

.sp-stat-lbl {
  font-size: 8px;
}

.sp-state-row {
  padding: 3px 0;
  font-size: 11px;
}

/* Flags panel compact */
.sp-flag-row {
  padding: 3px 0;
  font-size: 10px;
}

/* Squad panel - XI list */
.sp-card-squad {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.sp-xi-list {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
}

.sp-xi-row {
  padding: 4px 4px;
  font-size: 11px;
  grid-template-columns: 16px 1fr 32px 32px 70px;
  gap: 3px;
}

.sp-xi-why {
  font-size: 8px;
}

.sp-bench-row {
  padding: 3px 4px;
  font-size: 10px;
  grid-template-columns: 14px 16px 1fr 32px;
  gap: 3px;
}

/* Captain panel */
.sp-cap-row {
  padding: 4px 4px;
  font-size: 11px;
  grid-template-columns: 20px 1fr 36px 36px;
  gap: 4px;
}

/* Transfer panel - tighter spacing */
.sp-action {
  font-size: 12px;
  margin-bottom: 2px;
}

.sp-action-detail {
  font-size: 10px;
  margin-bottom: 4px;
  line-height: 1.4;
}

.sp-transfer-row {
  padding: 4px 0;
  font-size: 10px;
}

.sp-tr-why {
  padding: 3px 0 4px;
  margin-left: 4px;
  font-size: 9px;
  line-height: 1.4;
}

/* Fixtures panel */
.sp-fx-row {
  font-size: 10px;
}

.sp-fx-team {
  font-size: 9px;
}

.sp-fdr {
  padding: 1px 3px;
  font-size: 8px;
}

/* Assumptions panel */
.sp-assumptions {
  font-size: 9px;
  padding-left: 14px;
  line-height: 1.4;
}

.sp-assumptions li {
  margin-bottom: 1px;
}

/* ═══════════════════════════════════════════════════════════════════════════════
   RESPONSIVE SCALING - 1080p, 1440p, 4K
   ═══════════════════════════════════════════════════════════════════════════════ */

/* 1080p - tight spacing */
@media (max-width: 1920px) {
  :root {
    --gap-xs: 4px;
    --gap-sm: 6px;
    --gap-md: 10px;
    --gap-lg: 14px;
    --card-padding: 10px;
  }
}

/* 1440p - balanced */
@media (min-width: 1921px) and (max-width: 2559px) {
  :root {
    --gap-xs: 5px;
    --gap-sm: 8px;
    --gap-md: 12px;
    --gap-lg: 16px;
    --card-padding: 12px;
  }
}

/* 4K - slightly more room but still dense */
@media (min-width: 2560px) {
  :root {
    --gap-xs: 6px;
    --gap-sm: 10px;
    --gap-md: 14px;
    --gap-lg: 18px;
    --card-padding: 14px;
  }

  .portal-page {
    grid-template-columns: 320px 1fr 320px;
  }

  .sp-grid {
    grid-template-columns: 300px 1fr 360px;
  }
}

/* No page scrolling - everything fits in viewport */
.app > * {
  max-height: 100%;
}

/* Scrollbars only on internal containers */
::-webkit-scrollbar {
  width: 5px;
  height: 5px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--border-strong);
}

/* ═══════════════════════════════════════════════════════════════════════════════
   UI/UX REFINEMENT PASS #2 - Dec 2025
   Density optimization, clipping fixes, and viewport-fit for all pages
   ═══════════════════════════════════════════════════════════════════════════════ */

/* ─── PORTAL PAGE REFINEMENTS ──────────────────────────────────────────────── */
/* Tighter spacing between cards */
.portal-page {
  gap: var(--gap-sm);
}

.portal-column {
  gap: var(--gap-xs);
}

.portal-column-center {
  gap: var(--gap-xs);
}

/* Reduce secondary label font sizes */
.portal-tile .tile-badge,
.portal-tile .tile-desc,
.portal-tile .tile-hint,
.portal-tile .chip {
  font-size: 10px;
}

.portal-tile .tile-title {
  font-size: 0.85rem;
}

.portal-tile .tile-footer {
  padding: var(--gap-xs) 0 0;
  font-size: 9px;
}

/* Deadline tile compact */
.tile-deadline .countdown-num {
  font-size: 1.1rem;
}

.tile-deadline .countdown-label {
  font-size: 9px;
}

/* Captain picks rows tighter */
.captain-option-row {
  padding: 4px 0;
  gap: 6px;
}

.captain-photo {
  width: 28px;
  height: 35px;
}

.captain-name {
  font-size: 11px;
}

.captain-chip {
  font-size: 8px;
  padding: 2px 4px;
}

/* Fixture outlook compact */
.fixtures-overview {
  gap: var(--gap-xs);
}

.fixture-team-row {
  padding: 3px 0;
  font-size: 11px;
}

.fixtures-label {
  font-size: 9px;
  margin-bottom: var(--gap-xs);
}

/* Transfer targets compact */
.transfers-preview {
  gap: var(--gap-xs);
}

.transfers-label {
  font-size: 9px;
}

.transfer-row {
  padding: 3px 0;
  font-size: 11px;
}

/* Injuries list compact */
.injuries-list {
  gap: 2px;
}

.injury-row {
  padding: 3px 0;
  font-size: 11px;
}

.injury-icon {
  font-size: 12px;
}

/* Team status compact */
.team-status-grid {
  gap: var(--gap-xs);
}

.status-item .status-value {
  font-size: 1rem;
}

.status-item .status-label {
  font-size: 8px;
}

/* ─── MY TEAM PAGE REFINEMENTS ─────────────────────────────────────────────── */
/* Smaller pitch player cards */
.player-card-pitch {
  padding: 4px;
  min-width: 60px;
  max-width: 75px;
}

.player-card-pitch .player-photo-wrapper {
  height: 45px;
}

.player-card-pitch .player-photo {
  height: 45px;
}

.player-card-pitch .player-name {
  font-size: 9px;
  line-height: 1.2;
}

.player-card-pitch .player-pts {
  font-size: 11px;
}

.player-card-pitch .player-xp {
  font-size: 8px;
}

.player-card-pitch .player-mins-badge {
  font-size: 7px;
  padding: 1px 3px;
}

/* Reduce pitch row heights */
.pitch-row {
  gap: 4px;
}

.pitch-grass {
  min-height: 220px;
  padding: var(--gap-xs) var(--gap-sm);
  gap: var(--gap-xs);
}

/* Bench compact */
.bench-section {
  padding: var(--gap-xs) var(--gap-sm);
}

.bench-label {
  font-size: 9px;
  margin-bottom: var(--gap-xs);
}

.bench-row {
  gap: 6px;
}

.bench-card {
  min-width: 55px;
  max-width: 65px;
}

/* Restructure right column: Top Performer and Team XP appear first */
@media (min-width: 1100px) {
  .dashboard-right {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: auto auto 1fr 1fr;
  }

  /* Quick stats (Top Performer, Team XP) come first in grid order */
  .dashboard-right .tile.tile-compact:nth-of-type(1) {
    order: -2;
    grid-row: 1;
  }

  .dashboard-right .tile.tile-compact:nth-of-type(2) {
    order: -1;
    grid-row: 1;
  }

  /* Insights and Fixtures fill remaining space */
  .dashboard-right .tile.tile-wide:first-of-type {
    order: 0;
    grid-row: 2;
    grid-column: 1 / -1;
  }

  .dashboard-right .tile.tile-wide:nth-of-type(2) {
    order: 1;
    grid-row: 3;
    grid-column: 1 / -1;
  }
}

/* Insights tile more compact */
.insights-card .insights-list {
  max-height: 120px;
}

.insight-item {
  padding: 4px 6px;
  font-size: 11px;
}

/* Fixtures preview more compact */
.fixtures-preview-grid {
  max-height: 100px;
}

.fixtures-preview-grid .fixture-team-row {
  padding: 2px 0;
  font-size: 10px;
}

/* Team header compact */
.team-header-card {
  padding: var(--gap-sm) var(--gap-md);
}

.team-stats-grid {
  gap: var(--gap-sm);
}

.stat-item .stat-value {
  font-size: 1rem;
}

.stat-item .stat-label {
  font-size: 8px;
}

/* ─── PLAYERS PAGE REFINEMENTS ─────────────────────────────────────────────── */
/* Chart fills available space with no dead space below */
.players-dashboard .players-chart {
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.players-dashboard .players-chart .tile-body,
.players-dashboard .players-chart #ap-chart-slot {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.players-dashboard .players-chart canvas {
  flex: 1;
  min-height: 0;
  max-height: 100%;
}

/* Table rows more compact */
.players-dashboard .table td,
.players-dashboard .table th {
  padding: 5px 6px;
  font-size: 11px;
}

.players-dashboard .table .name-cell {
  font-size: 11px;
}

/* Table container fills height */
.players-dashboard .players-table {
  overflow: hidden;
}

.players-dashboard .players-table .table-scroll-wrapper {
  flex: 1;
  min-height: 0;
  overflow: auto;
}

/* ─── FIXTURES PAGE REFINEMENTS ────────────────────────────────────────────── */
/* Control bar condensed */
.fixtures-dashboard .toolbar,
.fixtures-dashboard .toolbar-compact {
  padding: var(--gap-xs) var(--gap-sm);
  gap: var(--gap-xs);
}

.fixtures-dashboard .toolbar select,
.fixtures-dashboard .toolbar input,
.fixtures-dashboard .toolbar-compact select,
.fixtures-dashboard .toolbar-compact input {
  padding: 4px 8px;
  font-size: 11px;
}

/* Matrix takes full available width */
.fixtures-content {
  grid-template-columns: 1fr auto;
}

@media (min-width: 1400px) {
  .fixtures-content {
    grid-template-columns: 1fr 320px;
  }
}

/* Matrix card expands */
.fixtures-content > .card:first-child {
  overflow: auto;
  max-width: none;
}

.matrix-wrap {
  width: 100%;
}

.matrix-wrap .table {
  width: max-content;
  min-width: 100%;
}

.matrix-wrap .table td,
.matrix-wrap .table th {
  padding: 4px 6px;
  font-size: 10px;
  white-space: nowrap;
}

/* Chart aligns with matrix height */
.fixtures-content > .card:last-child {
  max-height: none;
  min-height: 200px;
  display: flex;
  flex-direction: column;
}

.fixtures-content > .card:last-child canvas {
  flex: 1;
  min-height: 0;
}

/* ─── EXPLORER PAGE REFINEMENTS ────────────────────────────────────────────── */
/* Clear dashboard grid */
.gw-dashboard {
  grid-template-rows: auto auto 1fr;
  gap: var(--gap-sm);
}

/* Toolbar condensed */
.gw-dashboard .toolbar-compact {
  padding: var(--gap-xs) var(--gap-sm);
  gap: var(--gap-xs);
}

.gw-dashboard .toolbar-compact select,
.gw-dashboard .toolbar-compact input {
  padding: 4px 8px;
  font-size: 11px;
}

.gw-dashboard .seg-btn {
  padding: 4px 8px;
  font-size: 10px;
}

.gw-dashboard .row-check {
  font-size: 10px;
}

/* GW Explorer - Improved toggle buttons with larger hit targets */
.gw-toggle {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 5px 10px;
  background: var(--surface-1);
  border: 1px solid var(--border);
  border-radius: 6px;
  cursor: pointer;
  user-select: none;
  transition: all 0.15s ease;
  font-size: 11px;
}
.gw-toggle:hover {
  background: var(--surface-2);
  border-color: var(--accent);
}
.gw-toggle input[type="checkbox"] {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}
.gw-toggle-indicator {
  width: 14px;
  height: 14px;
  border-radius: 3px;
  background: var(--surface-0);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s ease;
}
.gw-toggle-indicator.active {
  background: var(--accent);
  border-color: var(--accent);
}
.gw-toggle-indicator.active::after {
  content: "✓";
  color: white;
  font-size: 10px;
  font-weight: bold;
}
.gw-toggle-label {
  color: var(--text);
  white-space: nowrap;
}

/* Top row: balanced grid with GW summary left, Team of Week right */
.gw-top-row {
  min-height: 180px;
  max-height: 240px;
}

@media (min-width: 1100px) {
  .gw-top-row {
    grid-template-columns: minmax(280px, 1fr) minmax(400px, 2fr);
  }
}

.gw-top-row > div {
  padding: var(--gap-sm);
  overflow: auto;
}

.gw-top-row h3 {
  font-size: 0.8rem;
  margin-bottom: var(--gap-xs);
  padding-bottom: 4px;
}

.gw-top-row h4 {
  font-size: 0.75rem;
  margin: var(--gap-xs) 0 2px;
}

.gw-top-row ul {
  font-size: 10px;
  line-height: 1.4;
  padding-left: 14px;
}

.gw-top-row .chips {
  gap: 4px;
}

.gw-top-row .chip {
  font-size: 9px;
  padding: 2px 5px;
}

/* Team of Week table compact */
.gw-top-row .table td,
.gw-top-row .table th {
  padding: 3px 5px;
  font-size: 10px;
}

/* Player table - full width, scrollable internally */
.gw-table-container {
  min-height: 0;
  overflow: hidden;
}

.gw-table-container h3 {
  padding: var(--gap-xs) var(--gap-sm);
  font-size: 0.8rem;
}

.gw-table-container .table {
  flex: 1;
  min-height: 0;
  overflow: auto;
}

.gw-table-container .table td,
.gw-table-container .table th {
  padding: 4px 6px;
  font-size: 10px;
}

/* ─── LEAGUE PAGE REFINEMENTS ──────────────────────────────────────────────── */
/* Page container no overflow */
.league-page {
  overflow: hidden;
}

/* Selector view grid */
.league-grid {
  gap: var(--gap-sm);
}

/* League cards compact */
.league-card {
  padding: var(--gap-sm);
  min-height: 140px;
}

.league-card-header h3 {
  font-size: 0.85rem;
}

.league-card-count {
  font-size: 9px;
}

.league-stat-val {
  font-size: 0.9rem;
}

.league-stat-lbl {
  font-size: 7px;
}

.league-card-leader {
  font-size: 8px;
  padding-top: 4px;
}

/* Detail view - fix bottom clipping */
.league-detail-grid {
  height: calc(100% - 50px);
  overflow: hidden;
}

.league-detail-header {
  padding: var(--gap-xs) 0;
  margin-bottom: var(--gap-xs);
}

.league-detail-header h2 {
  font-size: 1rem;
}

/* Standings + Top XI stacked left, charts right */
@media (min-width: 1200px) {
  .league-detail-grid {
    grid-template-columns: minmax(280px, 380px) 1fr;
  }

  .league-detail-left {
    display: flex;
    flex-direction: column;
    gap: var(--gap-xs);
    overflow: hidden;
  }

  /* Standings takes 60% */
  .league-detail-left > .league-detail-card:first-child {
    flex: 3;
    min-height: 0;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  /* Top XI takes 40% */
  .league-detail-left > .league-detail-card:last-child {
    flex: 2;
    min-height: 0;
    overflow: auto;
  }

  .league-detail-center {
    display: flex;
    flex-direction: column;
    gap: var(--gap-xs);
    overflow: hidden;
  }

  .league-detail-center .league-chart-card {
    flex: 1;
    min-height: 0;
    max-height: none;
  }
}

/* Standings table compact */
.league-standings {
  overflow: auto;
}

.league-standings .table td,
.league-standings .table th {
  padding: 4px 6px;
  font-size: 10px;
}

/* Top XI compact */
.league-xi-row {
  padding: 3px 4px;
  font-size: 10px;
  grid-template-columns: 24px 1fr 36px 60px;
  gap: 3px;
}

/* Chart cards don't overflow */
.league-chart-card {
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.league-chart-card h3 {
  flex-shrink: 0;
  font-size: 0.8rem;
  padding: var(--gap-xs) var(--gap-sm);
  margin: 0;
}

.league-chart-wrap {
  flex: 1;
  min-height: 0;
  max-height: none;
  overflow: hidden;
}

.league-chart-wrap canvas {
  max-height: 100%;
}

/* ─── STAT PICKER PAGE REFINEMENTS ─────────────────────────────────────────── */
/* Power BI-style dashboard grid */
.sp-dashboard {
  overflow: hidden;
}

.sp-grid {
  height: calc(100% - 40px);
}

/* Header compact */
.sp-header {
  padding: 2px 0;
  margin-bottom: var(--gap-xs);
}

.sp-header h1 {
  font-size: 1rem;
}

.sp-tagline {
  font-size: 10px;
}

/* 3-column grid with proper proportions */
@media (min-width: 1100px) {
  .sp-grid {
    grid-template-columns: 220px 1fr 260px;
  }
}

@media (min-width: 1400px) {
  .sp-grid {
    grid-template-columns: 240px 1fr 280px;
  }
}

@media (min-width: 1800px) {
  .sp-grid {
    grid-template-columns: 260px 1fr 320px;
  }
}

/* Columns scroll internally */
.sp-col {
  overflow-y: auto;
  gap: 4px;
}

/* Cards compact padding */
.sp-card {
  padding: var(--gap-xs);
  flex-shrink: 0;
}

.sp-card-header {
  font-size: 7px;
  margin-bottom: 3px;
  padding-bottom: 2px;
}

/* Current state stats ultra-compact */
.sp-state-compact {
  gap: 2px;
}

.sp-stat {
  padding: 3px 2px;
}

.sp-stat-val {
  font-size: 11px;
}

.sp-stat-lbl {
  font-size: 7px;
}

.sp-state-row {
  padding: 2px 0;
  font-size: 10px;
}

/* Flags panel */
.sp-flag-row {
  padding: 2px 0;
  font-size: 9px;
}

/* Squad panel - XI list compact */
.sp-xi-row {
  padding: 3px 2px;
  font-size: 10px;
  grid-template-columns: 14px 1fr 28px 28px 60px;
  gap: 2px;
}

.sp-xi-why {
  font-size: 7px;
  line-height: 1.3;
}

.sp-bench-row {
  padding: 2px 3px;
  font-size: 9px;
  grid-template-columns: 12px 14px 1fr 28px;
  gap: 2px;
}

/* Captain picks integrated - not at bottom */
.sp-card-captain {
  order: 0;
}

.sp-cap-row {
  padding: 3px 2px;
  font-size: 10px;
  grid-template-columns: 18px 1fr 32px 32px;
  gap: 3px;
}

/* Transfer panel compact */
.sp-action {
  font-size: 11px;
  margin-bottom: 1px;
}

.sp-action-detail {
  font-size: 9px;
  line-height: 1.3;
  margin-bottom: 3px;
}

.sp-transfer-row {
  padding: 3px 0;
  font-size: 9px;
}

.sp-tr-why {
  padding: 2px 0 3px;
  font-size: 8px;
  line-height: 1.3;
}

/* Fixtures panel compact */
.sp-fx-row {
  font-size: 9px;
}

.sp-fx-team {
  font-size: 8px;
}

.sp-fdr {
  padding: 1px 2px;
  font-size: 7px;
}

/* Assumptions panel ultra-compact */
.sp-assumptions {
  font-size: 8px;
  padding-left: 12px;
  line-height: 1.3;
}

/* ─── GLOBAL REFINEMENTS ───────────────────────────────────────────────────── */
/* Tighter card internal spacing */
.card,
.tile {
  padding: var(--gap-sm);
}

.tile-header {
  padding-bottom: var(--gap-xs);
  margin-bottom: var(--gap-xs);
}

.tile-title {
  font-size: 0.8rem;
}

.tile-body {
  padding: 0;
}

/* Table global compact */
.table td,
.table th {
  padding: 5px 8px;
  font-size: 11px;
}

.table-compact td,
.table-compact th {
  padding: 4px 6px;
  font-size: 10px;
}

/* Chips and badges smaller */
.chip {
  font-size: 9px;
  padding: 2px 6px;
}

.badge {
  font-size: 9px;
  padding: 2px 5px;
}

/* Bottom padding consistent - no content cut off */
.portal-page,
.dashboard,
.players-dashboard,
.fixtures-dashboard,
.gw-dashboard,
.league-page,
.sp-dashboard {
  padding-bottom: var(--gap-sm);
  box-sizing: border-box;
}

/* Height calculations account for header */
.portal-page,
.dashboard,
.players-dashboard,
.fixtures-dashboard,
.gw-dashboard,
.league-page,
.sp-dashboard {
  height: calc(100vh - 60px - var(--gap-md));
  max-height: calc(100vh - 60px - var(--gap-md));
}

/* ─── RESPONSIVE DENSITY ADJUSTMENTS ───────────────────────────────────────── */
/* 1080p - ultra tight */
@media (max-height: 900px) {
  :root {
    --gap-xs: 3px;
    --gap-sm: 5px;
    --gap-md: 8px;
  }

  .portal-page,
  .dashboard,
  .players-dashboard,
  .fixtures-dashboard,
  .gw-dashboard,
  .league-page,
  .sp-dashboard {
    height: calc(100vh - 50px - var(--gap-sm));
    max-height: calc(100vh - 50px - var(--gap-sm));
  }

  .topbar {
    max-height: 48px;
  }

  .player-card-pitch {
    min-width: 55px;
    max-width: 65px;
  }

  .pitch-grass {
    min-height: 200px;
  }
}

/* 1440p - balanced */
@media (min-height: 901px) and (max-height: 1200px) {
  :root {
    --gap-xs: 4px;
    --gap-sm: 6px;
    --gap-md: 10px;
  }
}

/* 4K / large screens */
@media (min-height: 1201px) {
  :root {
    --gap-xs: 5px;
    --gap-sm: 8px;
    --gap-md: 12px;
  }

  .player-card-pitch {
    min-width: 70px;
    max-width: 85px;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   UX REVIEW REFINEMENTS - Dec 2025
   Visual hierarchy, component sizing, and data honesty fixes
   ═══════════════════════════════════════════════════════════════════════════════ */

/* ─── TOPBAR: Deadline as lightweight state info ──────────────────────────── */
/* Deadline box should match nav button weight, not be a hero card */
.deadline-box {
  flex-direction: row;
  align-items: center;
  padding: 4px 10px;
  min-width: auto;
  gap: 8px;
  border-radius: 8px;
  background: var(--surface-1);
  border: 1px solid var(--border);
}

.deadline-label {
  display: none; /* Hide "Next Deadline" label - timer is self-explanatory */
}

.deadline-timer {
  font-size: 0.85rem;
  font-weight: 600;
}

.deadline-gw {
  font-size: 10px;
  opacity: 0.8;
}

/* Compact urgency states */
.deadline-box.deadline-urgent,
.deadline-box.deadline-critical {
  padding: 4px 10px;
}

/* Match nav button styling */
.topbar .deadline-box {
  height: 32px;
  max-height: 32px;
}

/* ─── MY TEAM: Broadcast-style player cards ───────────────────────────────── */
/* Player cards need visual weight like broadcast graphics */
.player-card-pitch {
  padding: 6px 8px;
  min-width: 72px;
  max-width: 90px;
  background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.98) 100%);
  border: 1px solid rgba(148, 163, 184, 0.2);
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3), 0 1px 3px rgba(0, 0, 0, 0.2);
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}

.player-card-pitch:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3);
}

.player-card-pitch .player-photo-wrapper {
  height: 52px;
  margin-bottom: 4px;
}

.player-card-pitch .player-photo {
  height: 52px;
  border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
}

.player-card-pitch .player-team-badge {
  width: 18px;
  height: 18px;
  bottom: -4px;
  right: -4px;
}

.player-card-pitch .player-name {
  font-size: 10px;
  font-weight: 600;
  line-height: 1.3;
  margin-bottom: 3px;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
}

.player-card-pitch .player-pts {
  font-size: 14px;
  font-weight: 700;
  padding: 2px 6px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
}

.player-card-pitch .player-pts.pts-high {
  background: rgba(34, 197, 94, 0.3);
  color: #4ade80;
}

.player-card-pitch .player-xp {
  font-size: 9px;
  opacity: 0.85;
  margin-top: 2px;
}

.player-card-pitch .player-mins-badge {
  font-size: 8px;
  padding: 2px 4px;
  border-radius: 3px;
  margin-top: 3px;
}

/* Captain/VC badges more prominent */
.player-card-pitch .player-captain-badge,
.player-card-pitch .player-vc-badge {
  width: 20px;
  height: 20px;
  font-size: 11px;
  font-weight: 700;
  top: -6px;
  left: -6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

/* Haul celebration more visible */
.player-card-pitch.player-haul {
  border-color: rgba(250, 204, 21, 0.5);
  box-shadow: 0 0 16px rgba(250, 204, 21, 0.3), 0 4px 12px rgba(0, 0, 0, 0.3);
}

.player-card-pitch .haul-badge {
  font-size: 9px;
  padding: 2px 6px;
}

/* Pitch grass with more breathing room */
.pitch-grass {
  min-height: 260px;
  padding: var(--gap-sm);
  gap: var(--gap-sm);
}

.pitch-row {
  gap: 8px;
  justify-content: center;
}

/* Bench cards slightly smaller but still visible */
.bench-card {
  min-width: 60px;
  max-width: 70px;
  opacity: 0.9;
}

/* ─── PLAYERS: Chart aspect ratio preservation ────────────────────────────── */
/* Chart must scale proportionally, not stretch */
.players-dashboard .players-chart {
  display: flex;
  flex-direction: column;
}

.players-dashboard .players-chart .tile-body,
.players-dashboard .players-chart #ap-chart-slot {
  flex: 1;
  min-height: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

/* Force chart to maintain aspect ratio */
.players-dashboard .players-chart canvas {
  max-width: 100%;
  max-height: 100%;
  width: auto !important;
  height: auto !important;
  aspect-ratio: 4 / 3;
  object-fit: contain;
}

/* Chart container respects natural sizing */
.players-dashboard .players-chart .chart-container,
.players-dashboard .players-chart [class*="chart"] {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
}

/* ─── FIXTURES: Slim control strip ────────────────────────────────────────── */
/* Toolbar should be deferential, not dominant */
.fixtures-dashboard .toolbar,
.fixtures-dashboard .toolbar-compact,
.fixtures-dashboard .card > .toolbar {
  padding: 6px 10px;
  gap: 8px;
  background: var(--surface-1);
  border-radius: 8px;
  margin-bottom: var(--gap-sm);
}

.fixtures-dashboard .toolbar select,
.fixtures-dashboard .toolbar input,
.fixtures-dashboard .toolbar button {
  padding: 5px 10px;
  font-size: 11px;
  height: 28px;
}

.fixtures-dashboard .toolbar label {
  font-size: 10px;
}

.fixtures-dashboard .toolbar .chip,
.fixtures-dashboard .toolbar .badge {
  font-size: 9px;
  padding: 2px 6px;
}

/* Fixtures - Improved toggle buttons */
.fx-toggle {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 5px 10px;
  background: var(--surface-1);
  border: 1px solid var(--border);
  border-radius: 6px;
  cursor: pointer;
  user-select: none;
  transition: all 0.15s ease;
  font-size: 11px;
}
.fx-toggle:hover {
  background: var(--surface-2);
  border-color: var(--accent);
}
.fx-toggle input[type="checkbox"] {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}
.fx-toggle-indicator {
  width: 14px;
  height: 14px;
  border-radius: 3px;
  background: var(--surface-0);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.15s ease;
}
.fx-toggle-indicator.active {
  background: var(--accent);
  border-color: var(--accent);
}
.fx-toggle-indicator.active::after {
  content: "✓";
  color: white;
  font-size: 10px;
  font-weight: bold;
}
.fx-toggle-label {
  color: var(--text);
  white-space: nowrap;
}

/* Fixtures Legend */
.fx-legend {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  padding: 8px 12px;
  background: var(--surface-0);
  border: 1px solid var(--border);
  border-radius: 8px;
  margin-bottom: 12px;
  font-size: 11px;
}
.fx-legend-section {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}
.fx-legend-title {
  font-weight: 600;
  color: var(--muted);
  margin-right: 4px;
}
.fx-legend-label {
  color: var(--muted);
  font-size: 10px;
}
.fx-legend-item {
  padding: 2px 8px;
  background: var(--surface-1);
  border-radius: 4px;
  color: var(--muted);
}
.fx-legend-item.active {
  background: var(--accent);
  color: white;
}
.fx-legend-item strong {
  color: inherit;
}
.fx-legend-note {
  color: var(--muted);
  font-size: 10px;
  font-style: italic;
}
.fx-legend .swing-up {
  color: var(--ok);
}
.fx-legend .swing-down {
  color: var(--pain);
}

/* Fixtures Empty State */
.fx-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  text-align: center;
  color: var(--muted);
}
.fx-empty-icon {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}
.fx-empty-state h4 {
  margin: 0 0 8px;
  color: var(--text);
  font-size: 16px;
}
.fx-empty-state p {
  margin: 0 0 16px;
  font-size: 13px;
  max-width: 300px;
}
.fx-clear-filter {
  margin-top: 8px;
}

/* Fixtures Notice */
.fx-notice {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: rgba(255, 200, 0, 0.1);
  border: 1px solid rgba(255, 200, 0, 0.3);
  border-radius: 6px;
  margin-bottom: 12px;
  font-size: 12px;
  color: var(--text);
}
.fx-notice-icon {
  font-size: 14px;
}
.fx-notice-info {
  background: rgba(59, 130, 246, 0.1);
  border-color: rgba(59, 130, 246, 0.3);
}
.fx-notice-info strong {
  color: var(--accent-light);
}

/* Horizontal Scroll Hint */
.scroll-hint {
  font-size: 11px;
  color: var(--muted);
  padding: 4px 8px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
  animation: pulse-hint 2s ease-in-out infinite;
  transition: opacity 0.3s ease;
}
.scroll-hint.hidden {
  opacity: 0;
  pointer-events: none;
}
@keyframes pulse-hint {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

/* Matrix remains focal point */
.fixtures-content {
  flex: 1;
}

/* ─── EXPLORER: Storytelling panels expanded ──────────────────────────────── */
/* GW Summary and Team of Week as narrative elements */
.gw-top-row {
  min-height: 220px;
  max-height: 320px;
}

@media (min-width: 1100px) {
  .gw-top-row {
    grid-template-columns: minmax(320px, 1fr) minmax(480px, 2fr);
  }
}

@media (min-width: 1400px) {
  .gw-top-row {
    grid-template-columns: minmax(360px, 1fr) minmax(560px, 2fr);
    min-height: 260px;
    max-height: 360px;
  }
}

/* GW Summary card styling - narrative feel */
.gw-top-row > div:first-child {
  padding: var(--gap-md);
}

.gw-top-row > div:first-child h3 {
  font-size: 1rem;
  font-weight: 700;
  margin-bottom: var(--gap-sm);
  padding-bottom: var(--gap-xs);
  border-bottom: 2px solid var(--accent);
}

.gw-top-row > div:first-child h4 {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text);
  margin: var(--gap-sm) 0 var(--gap-xs);
}

.gw-top-row > div:first-child ul {
  font-size: 11px;
  line-height: 1.6;
}

.gw-top-row > div:first-child .chip {
  font-size: 10px;
  padding: 3px 8px;
}

/* Team of Week card - featured table */
.gw-top-row > div:last-child {
  padding: var(--gap-md);
}

.gw-top-row > div:last-child h3 {
  font-size: 1rem;
  font-weight: 700;
  margin-bottom: var(--gap-sm);
}

.gw-top-row > div:last-child .chips {
  margin-bottom: var(--gap-sm);
}

.gw-top-row > div:last-child .table td,
.gw-top-row > div:last-child .table th {
  padding: 6px 8px;
  font-size: 11px;
}

/* Player table below - dense but readable */
.gw-table-container {
  flex: 1;
  min-height: 200px;
}

.gw-table-container h3 {
  padding: var(--gap-sm) var(--gap-md);
  font-size: 0.9rem;
  font-weight: 600;
}

/* ─── STAT PICKER: Transfer advisor error states ──────────────────────────── */
/* When recommendations can't be produced, explain why */
.sp-card-transfers .sp-empty-state,
.sp-card-transfers .sp-error-state {
  padding: var(--gap-md);
  text-align: center;
  color: var(--muted);
}

.sp-transfer-error {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--gap-sm);
  padding: var(--gap-md);
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.3);
  border-radius: 8px;
  margin: var(--gap-sm) 0;
}

.sp-transfer-error-icon {
  font-size: 1.5rem;
}

.sp-transfer-error-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text);
}

.sp-transfer-error-reason {
  font-size: 10px;
  color: var(--muted);
  line-height: 1.4;
}

.sp-transfer-error-reasons {
  list-style: none;
  padding: 0;
  margin: var(--gap-xs) 0 0;
  font-size: 9px;
  text-align: left;
}

.sp-transfer-error-reasons li {
  padding: 2px 0;
  display: flex;
  align-items: center;
  gap: 4px;
}

.sp-transfer-error-reasons li::before {
  content: "•";
  color: var(--red);
}

/* Budget conflict styling */
.sp-transfer-constraint {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 6px;
  background: rgba(251, 191, 36, 0.15);
  border: 1px solid rgba(251, 191, 36, 0.3);
  border-radius: 4px;
  font-size: 9px;
  color: var(--yellow);
}

/* Hit penalty warning */
.sp-hit-warning {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: var(--gap-xs) var(--gap-sm);
  background: rgba(239, 68, 68, 0.1);
  border-left: 3px solid var(--red);
  font-size: 10px;
  margin: var(--gap-xs) 0;
}

.sp-hit-warning-value {
  font-weight: 700;
  color: var(--red);
}

/* No valid transfers state */
.sp-no-transfers {
  text-align: center;
  padding: var(--gap-md);
  color: var(--muted);
}

.sp-no-transfers-icon {
  font-size: 2rem;
  margin-bottom: var(--gap-sm);
  opacity: 0.5;
}

.sp-no-transfers-title {
  font-size: 12px;
  font-weight: 600;
  margin-bottom: var(--gap-xs);
}

.sp-no-transfers-reason {
  font-size: 10px;
  line-height: 1.4;
}

/* ─── RESPONSIVE ADJUSTMENTS ──────────────────────────────────────────────── */
@media (max-height: 900px) {
  .player-card-pitch {
    min-width: 65px;
    max-width: 80px;
  }

  .player-card-pitch .player-photo-wrapper,
  .player-card-pitch .player-photo {
    height: 46px;
  }

  .pitch-grass {
    min-height: 230px;
  }

  .gw-top-row {
    min-height: 180px;
    max-height: 260px;
  }
}

@media (min-height: 1201px) {
  .player-card-pitch {
    min-width: 80px;
    max-width: 100px;
  }

  .player-card-pitch .player-photo-wrapper,
  .player-card-pitch .player-photo {
    height: 60px;
  }

  .pitch-grass {
    min-height: 300px;
  }

  .gw-top-row {
    min-height: 300px;
    max-height: 400px;
  }
}

/* ========== DEV LOG PANEL ========== */
.dev-log-panel {
  position: fixed;
  bottom: 0;
  right: 0;
  width: 480px;
  max-width: 90vw;
  height: 320px;
  background: var(--bg2);
  border: 1px solid var(--border-strong);
  border-radius: 8px 8px 0 0;
  box-shadow: var(--shadow-lg);
  z-index: 10000;
  display: flex;
  flex-direction: column;
  font-size: 12px;
  transform: translateY(100%);
  transition: transform 0.2s ease;
}

.dev-log-panel.visible {
  transform: translateY(0);
}

.dev-log-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background: var(--bg3);
  border-bottom: 1px solid var(--border);
  border-radius: 8px 8px 0 0;
}

.dev-log-title {
  font-weight: 600;
  color: var(--text);
}

.dev-log-controls {
  display: flex;
  gap: 8px;
}

.dev-log-controls button {
  background: none;
  border: none;
  color: var(--muted);
  cursor: pointer;
  padding: 4px 8px;
  font-size: 12px;
  border-radius: 4px;
  transition: all 0.15s;
}

.dev-log-controls button:hover {
  background: var(--surface-2);
  color: var(--text);
}

.dev-log-close {
  font-size: 18px !important;
  line-height: 1;
}

.dev-log-filters {
  display: flex;
  gap: 12px;
  padding: 6px 12px;
  background: var(--surface-1);
  border-bottom: 1px solid var(--border);
  font-size: 11px;
}

.dev-log-filters label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--muted);
  cursor: pointer;
}

.dev-log-filters input {
  width: 12px;
  height: 12px;
}

.dev-log-content {
  flex: 1;
  overflow-y: auto;
  padding: 8px;
  font-family: 'SF Mono', Monaco, 'Fira Code', monospace;
}

.dev-log-entry {
  display: flex;
  gap: 8px;
  padding: 4px 6px;
  border-radius: 4px;
  line-height: 1.4;
}

.dev-log-entry:hover {
  background: var(--surface-1);
}

.dev-log-time {
  color: var(--muted-2);
  flex-shrink: 0;
}

.dev-log-level {
  font-weight: 600;
  flex-shrink: 0;
  min-width: 50px;
}

.dev-log-message {
  color: var(--text);
  word-break: break-word;
  white-space: pre-wrap;
}

.dev-log-error .dev-log-message {
  color: var(--red);
}

.dev-log-warn .dev-log-message {
  color: var(--yellow);
}

/* ========== PAGE METADATA (Last Updated) ========== */
.page-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 11px;
  color: var(--muted-2);
  margin-bottom: 8px;
}

.page-meta .page-updated {
  display: flex;
  align-items: center;
  gap: 4px;
}

.page-meta .page-updated::before {
  content: '';
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--good);
}

.page-meta .page-updated.stale::before {
  background: var(--yellow);
}

.page-meta .page-updated.old::before {
  background: var(--red);
}

/* ========== ERROR CARD WITH RETRY ========== */
.error-card {
  background: linear-gradient(135deg, rgba(244, 63, 94, 0.1) 0%, rgba(244, 63, 94, 0.05) 100%);
  border: 1px solid rgba(244, 63, 94, 0.3);
  border-radius: 8px;
  padding: 16px 20px;
  margin: 12px 0;
}

.error-card-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 8px;
}

.error-card-icon {
  font-size: 20px;
}

.error-card-title {
  font-weight: 600;
  color: var(--red);
  font-size: 14px;
}

.error-card-message {
  color: var(--muted);
  font-size: 13px;
  margin-bottom: 12px;
  line-height: 1.5;
}

.error-card-details {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  padding: 8px 10px;
  font-family: 'SF Mono', Monaco, monospace;
  font-size: 11px;
  color: var(--muted-2);
  margin-bottom: 12px;
  overflow-x: auto;
}

.error-card-actions {
  display: flex;
  gap: 8px;
}

.error-card .btn-retry {
  background: var(--red);
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s;
}

.error-card .btn-retry:hover {
  background: #dc2626;
  transform: translateY(-1px);
}

.error-card .btn-retry:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

.error-card .btn-secondary {
  background: var(--surface-2);
  color: var(--text);
  border: 1px solid var(--border);
  padding: 8px 16px;
  border-radius: 6px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.15s;
}

.error-card .btn-secondary:hover {
  background: var(--surface-3);
}

/* ========== DEGRADED STATE CARD ========== */
.degraded-card {
  background: linear-gradient(135deg, rgba(251, 191, 36, 0.1) 0%, rgba(251, 191, 36, 0.05) 100%);
  border: 1px solid rgba(251, 191, 36, 0.3);
  border-radius: 12px;
  padding: 20px 24px;
  margin: 16px auto;
  max-width: 500px;
}

.degraded-card-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.degraded-card-icon {
  font-size: 24px;
}

.degraded-card-title {
  font-weight: 600;
  color: var(--yellow);
  font-size: 16px;
}

.degraded-card-message {
  color: var(--muted);
  font-size: 14px;
  margin-bottom: 16px;
  line-height: 1.5;
}

.degraded-card-cache-info {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  background: rgba(16, 185, 129, 0.1);
  border: 1px solid rgba(16, 185, 129, 0.2);
  border-radius: 8px;
  margin-bottom: 16px;
}

.degraded-card-cache-info .cache-icon {
  font-size: 18px;
}

.degraded-card-cache-info .cache-text {
  font-size: 13px;
  color: var(--text);
}

.degraded-card-cache-info .cache-text strong {
  color: var(--brand-light);
}

.degraded-card-actions {
  display: flex;
  gap: 10px;
}

.degraded-card .btn-retry {
  background: var(--yellow);
  color: #1a1a1a;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
}

.degraded-card .btn-retry:hover {
  background: #f59e0b;
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

.degraded-card .btn-retry:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

.degraded-card .btn-use-cached {
  background: var(--brand);
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
}

.degraded-card .btn-use-cached:hover {
  background: var(--brand-dark);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

/* ========== CACHED DATA BANNER ========== */
.cached-banner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 16px;
  background: linear-gradient(90deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0.08) 100%);
  border: 1px solid rgba(59, 130, 246, 0.3);
  border-radius: 8px;
  margin-bottom: 12px;
  position: sticky;
  top: 0;
  z-index: 10;
}

.cached-banner-content {
  display: flex;
  align-items: center;
  gap: 10px;
}

.cached-banner-icon {
  font-size: 18px;
}

.cached-banner-text {
  font-size: 13px;
  color: var(--text);
}

.cached-banner-text strong {
  color: var(--accent-light);
}

.cached-banner-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.btn-banner-refresh {
  background: var(--accent);
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s;
}

.btn-banner-refresh:hover {
  background: #2563eb;
}

.btn-banner-refresh:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.btn-banner-dismiss {
  background: transparent;
  color: var(--muted);
  border: none;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.15s;
}

.btn-banner-dismiss:hover {
  background: var(--surface-2);
  color: var(--text);
}

/* ========== LOADING STATE ========== */
.loading-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 48px 24px;
  min-height: 200px;
}

.loading-spinner-large {
  width: 48px;
  height: 48px;
  border: 3px solid var(--surface-2);
  border-top-color: var(--brand);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading-message {
  margin-top: 16px;
  color: var(--muted);
  font-size: 14px;
}

.loading-warning {
  margin-top: 12px;
  color: var(--yellow);
  font-size: 13px;
  opacity: 0;
  transition: opacity 0.3s;
}

.loading-warning:not(.hidden) {
  opacity: 1;
}

.loading-warning.hidden {
  display: none;
}

/* ========== SETUP PROMPT ========== */
.setup-prompt {
  max-width: 500px;
  margin: 40px auto;
  padding: 24px;
  background: linear-gradient(135deg, var(--card) 0%, var(--bg2) 100%);
  border: 1px solid var(--border-strong);
  border-radius: 12px;
  box-shadow: var(--shadow-md);
}

.setup-prompt-icon {
  font-size: 48px;
  text-align: center;
  margin-bottom: 16px;
}

.setup-prompt h2 {
  font-size: 20px;
  text-align: center;
  margin-bottom: 8px;
  color: var(--text);
}

.setup-prompt-subtitle {
  text-align: center;
  color: var(--muted);
  font-size: 14px;
  margin-bottom: 20px;
}

.setup-prompt-fields {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-bottom: 20px;
}

.setup-prompt-field label {
  display: block;
  font-size: 13px;
  font-weight: 500;
  margin-bottom: 6px;
  color: var(--text);
}

.setup-prompt-field input {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 6px;
  color: var(--text);
  font-size: 14px;
  transition: border-color 0.15s;
}

.setup-prompt-field input:focus {
  outline: none;
  border-color: var(--accent);
}

.setup-prompt-field .field-hint {
  font-size: 11px;
  color: var(--muted-2);
  margin-top: 4px;
}

.setup-prompt-missing {
  background: rgba(251, 191, 36, 0.1);
  border: 1px solid rgba(251, 191, 36, 0.3);
  border-radius: 6px;
  padding: 10px 12px;
  margin-bottom: 16px;
  font-size: 13px;
}

.setup-prompt-missing-title {
  font-weight: 600;
  color: var(--yellow);
  margin-bottom: 4px;
}

.setup-prompt-missing-list {
  color: var(--muted);
  padding-left: 18px;
  margin: 0;
}

.setup-prompt-actions {
  display: flex;
  gap: 10px;
  justify-content: center;
}

.setup-prompt .btn-save {
  background: var(--gradient-brand);
  color: white;
  border: none;
  padding: 10px 24px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
}

.setup-prompt .btn-save:hover {
  transform: translateY(-1px);
  box-shadow: var(--shadow-md);
}

.setup-prompt .btn-skip {
  background: none;
  border: 1px solid var(--border);
  color: var(--muted);
  padding: 10px 20px;
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.15s;
}

.setup-prompt .btn-skip:hover {
  border-color: var(--muted);
  color: var(--text);
}

/* Validation indicator on fields */
.setup-prompt-field.has-error input {
  border-color: var(--red);
}

.setup-prompt-field.has-value input {
  border-color: var(--good);
}

/* ========== APP VERSION BADGE ========== */
.topbar-version {
  font-size: 10px;
  color: var(--muted-2);
  padding: 2px 6px;
  background: var(--surface-1);
  border-radius: 4px;
  font-family: 'SF Mono', Monaco, monospace;
  white-space: nowrap;
}

.topbar-version .commit-hash {
  color: var(--muted-2);
  margin-left: 2px;
}

/* ========== DEV PANEL TOGGLE (keyboard hint) ========== */
.dev-toggle-hint {
  position: fixed;
  bottom: 8px;
  right: 8px;
  font-size: 10px;
  color: var(--muted-2);
  background: var(--bg2);
  padding: 4px 8px;
  border-radius: 4px;
  opacity: 0;
  transition: opacity 0.2s;
  pointer-events: none;
  z-index: 9999;
}

body:hover .dev-toggle-hint {
  opacity: 0.6;
}

/* ═══════════════════════════════════════════════════════════════════════════
   PHASE 5: STAT PICKER ENGINE ARCHITECTURE STYLES
   ═══════════════════════════════════════════════════════════════════════════ */

/* Control group for horizon/objective dropdowns */
.sp-control-group {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.sp-control-label {
  font-size: 9px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.sp-select-wide {
  min-width: 120px;
}

/* Recalculation banner */
.sp-recalc-banner {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  background: linear-gradient(90deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%);
  border: 1px solid rgba(16, 185, 129, 0.3);
  border-radius: 6px;
  margin-bottom: 12px;
  font-size: 12px;
}

.sp-recalc-icon {
  color: var(--green);
  font-weight: bold;
}

.sp-recalc-text {
  color: var(--text);
}

.sp-recalc-settings {
  color: var(--muted);
  font-size: 11px;
  margin-left: auto;
  background: var(--surface-2);
  padding: 2px 8px;
  border-radius: 4px;
}

/* Recalculating state */
.sp-recalculating {
  opacity: 0.6;
  pointer-events: none;
}

/* Loading state with spinner */
.sp-loading-spinner {
  width: 32px;
  height: 32px;
  border: 3px solid var(--surface-2);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 12px;
}

.sp-loading-text {
  color: var(--muted);
  font-size: 13px;
}

/* Dependency checklist */
.sp-dep-checklist {
  margin-top: 16px;
  min-width: 200px;
}

.sp-dep-checklist-inner {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.sp-dep-row {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 10px;
  background: var(--surface-1);
  border-radius: 4px;
  font-size: 12px;
}

.sp-dep-icon {
  font-size: 14px;
  width: 18px;
  text-align: center;
}

.sp-dep-pending .sp-dep-icon { color: var(--muted); }
.sp-dep-loading .sp-dep-icon { color: var(--accent); animation: pulse 1s infinite; }
.sp-dep-success .sp-dep-icon { color: var(--green); }
.sp-dep-cached .sp-dep-icon { color: var(--amber); }
.sp-dep-failed .sp-dep-icon { color: var(--red); }

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}

.sp-dep-label {
  flex: 1;
  color: var(--text);
}

.sp-dep-optional {
  font-size: 10px;
  color: var(--muted);
}

.sp-dep-cache {
  font-size: 9px;
  background: var(--amber);
  color: #000;
  padding: 1px 5px;
  border-radius: 3px;
}

.sp-dep-error {
  width: 16px;
  height: 16px;
  background: var(--red);
  color: white;
  border-radius: 50%;
  font-size: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: help;
}

/* Degraded mode */
.sp-degraded-mode {
  max-width: 600px;
  margin: 0 auto;
  padding: 24px;
}

.sp-degraded-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 20px;
}

.sp-degraded-icon {
  font-size: 28px;
}

.sp-degraded-header h3 {
  margin: 0;
  font-size: 18px;
  color: var(--amber);
}

.sp-dep-status-panel,
.sp-failures-panel {
  background: var(--surface-1);
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 16px;
}

.sp-dep-status-panel h4,
.sp-failures-panel h4 {
  margin: 0 0 12px;
  font-size: 13px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.sp-failure-row {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 12px;
  background: rgba(239, 68, 68, 0.1);
  border-left: 3px solid var(--red);
  border-radius: 4px;
  margin-bottom: 8px;
}

.sp-failure-label {
  font-weight: 600;
  color: var(--text);
  min-width: 120px;
}

.sp-failure-error {
  flex: 1;
  font-size: 12px;
  color: var(--red);
}

.sp-btn-small {
  padding: 4px 10px;
  font-size: 11px;
}

.sp-btn-primary {
  background: var(--accent);
  color: white;
  border-color: var(--accent);
}

.sp-btn-primary:hover {
  background: #2563eb;
}

/* Cache fallback */
.sp-cache-fallback {
  background: rgba(16, 185, 129, 0.1);
  border: 1px solid rgba(16, 185, 129, 0.3);
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 16px;
}

.sp-cache-fallback-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 12px;
  color: var(--green);
  font-weight: 600;
}

.sp-cache-icon {
  font-size: 20px;
}

/* Degraded actions */
.sp-degraded-actions {
  display: flex;
  gap: 12px;
  justify-content: center;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

/* Partial data panel */
.sp-partial-data {
  background: rgba(59, 130, 246, 0.1);
  border: 1px solid rgba(59, 130, 246, 0.3);
  border-radius: 8px;
  padding: 16px;
  margin-top: 16px;
}

.sp-partial-data h4 {
  margin: 0 0 8px;
  color: var(--accent);
}

.sp-partial-data p {
  margin: 0 0 12px;
  font-size: 13px;
  color: var(--muted);
}

.sp-warning-text {
  color: var(--amber);
}

/* Predictions warning banner */
.sp-predictions-warning {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  background: rgba(251, 191, 36, 0.1);
  border: 1px solid rgba(251, 191, 36, 0.3);
  border-radius: 6px;
  margin-bottom: 12px;
  font-size: 12px;
  color: var(--amber);
  grid-column: 1 / -1;
}

.sp-warning-icon {
  font-size: 16px;
}

/* Unavailable panel state */
.sp-unavailable {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 16px;
  color: var(--muted);
  font-size: 12px;
}

.sp-unavailable-icon {
  font-size: 18px;
}

/* Objective hint badge */
.sp-obj-hint {
  font-size: 10px;
  background: var(--surface-2);
  color: var(--muted);
  padding: 2px 6px;
  border-radius: 3px;
  margin-left: 6px;
  font-weight: normal;
}

/* Captain note */
.sp-cap-note {
  font-size: 9px;
  color: var(--muted);
  margin-left: auto;
  font-style: italic;
}

/* Enhanced header layout for controls */
@media (max-width: 768px) {
  .sp-header {
    flex-direction: column;
    gap: 12px;
  }

  .sp-header-right {
    flex-wrap: wrap;
    justify-content: flex-start;
  }

  .sp-control-group {
    flex: 1;
    min-width: 100px;
  }
}

/* Smooth transitions */
.sp-card,
.sp-dep-row,
.sp-recalc-banner {
  transition: opacity 0.2s, transform 0.2s;
}

/* ═══════════════════════════════════════════════════════════════════════════
   PHASE 6: UI COMPOSITION STYLES
   ═══════════════════════════════════════════════════════════════════════════ */

/* ─── 6.1 GAMEWEEK SNAPSHOT CARD ─────────────────────────────────────────── */
.sp-snapshot-container {
  padding: 0 var(--gap-sm);
  margin-bottom: var(--gap-sm);
}

.sp-snapshot-card {
  background: linear-gradient(135deg, var(--card) 0%, rgba(16, 185, 129, 0.1) 100%);
  border: 1px solid var(--border);
  border-left: 4px solid var(--brand);
  border-radius: var(--radius);
  padding: var(--gap-sm) var(--gap-md);
}

.sp-snap-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--gap-sm);
}

.sp-snap-title {
  font-size: 1rem;
  font-weight: 700;
  color: var(--text);
}

.sp-snap-actions {
  display: flex;
  align-items: center;
  gap: var(--gap-xs);
}

.sp-snap-updated {
  font-size: 10px;
  color: var(--muted);
}

.sp-snap-metrics {
  display: flex;
  gap: var(--gap-md);
  flex-wrap: wrap;
  margin-bottom: var(--gap-sm);
}

.sp-snap-metric {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: var(--gap-xs) var(--gap-sm);
  background: var(--surface-1);
  border-radius: var(--radius-sm);
  min-width: 60px;
}

.sp-snap-metric-val {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--accent);
  line-height: 1;
}

.sp-snap-metric-lbl {
  font-size: 9px;
  color: var(--muted);
  text-transform: uppercase;
  margin-top: 2px;
}

.sp-snap-metric-gain .sp-snap-metric-val {
  color: var(--green);
}

.sp-snap-chips {
  display: flex;
  align-items: center;
  gap: var(--gap-xs);
  margin-bottom: var(--gap-sm);
  font-size: 11px;
}

.sp-snap-chips-lbl {
  color: var(--muted);
}

.sp-snap-chips-val {
  color: var(--green);
  font-weight: 500;
}

.sp-snap-override-warn {
  font-size: 11px;
  color: var(--amber);
  background: rgba(251, 191, 36, 0.1);
  padding: 4px 8px;
  border-radius: var(--radius-sm);
  margin-bottom: var(--gap-sm);
}

.sp-snap-headline {
  font-size: 12px;
  font-weight: 600;
  padding: var(--gap-xs) var(--gap-sm);
  border-radius: var(--radius-sm);
}

.sp-snap-headline-success {
  background: rgba(16, 185, 129, 0.15);
  color: var(--green);
}

.sp-snap-headline-warning {
  background: rgba(251, 191, 36, 0.15);
  color: var(--amber);
}

.sp-snap-headline-danger {
  background: rgba(244, 63, 94, 0.15);
  color: var(--red);
}

.sp-snap-headline-info {
  background: rgba(59, 130, 246, 0.15);
  color: var(--accent);
}

.sp-snap-headline-neutral {
  background: var(--surface-1);
  color: var(--muted);
}

/* ─── 6.2 SQUAD RANKING PANEL ────────────────────────────────────────────── */
.sp-card-ranking {
  font-size: 11px;
}

.sp-rank-header {
  display: grid;
  grid-template-columns: 24px 24px 1fr 40px 1fr 42px 42px 38px 36px 70px 50px;
  gap: 4px;
  padding: 4px 6px;
  background: var(--surface-2);
  border-radius: var(--radius-sm);
  font-size: 9px;
  color: var(--muted);
  text-transform: uppercase;
  font-weight: 600;
  margin-bottom: 4px;
}

.sp-rank-list {
  max-height: 400px;
  overflow-y: auto;
}

.sp-rank-row {
  display: grid;
  grid-template-columns: 24px 24px 1fr 40px 1fr 42px 42px 38px 36px 70px 50px;
  gap: 4px;
  padding: 5px 6px;
  align-items: center;
  border-bottom: 1px solid var(--border);
  transition: background 0.15s;
}

.sp-rank-row:hover {
  background: var(--surface-1);
}

.sp-rank-row-xi {
  background: rgba(16, 185, 129, 0.08);
}

.sp-rank-row-xi:hover {
  background: rgba(16, 185, 129, 0.15);
}

.sp-rank-row-bench {
  opacity: 0.7;
}

.sp-rank-row-pinned {
  border-left: 3px solid var(--accent);
}

.sp-rank-num {
  font-weight: 600;
  color: var(--muted);
  text-align: center;
}

.sp-rank-pos {
  font-weight: 700;
  text-align: center;
  padding: 2px 4px;
  border-radius: 3px;
  font-size: 9px;
}

.sp-rank-pos.g { background: var(--amber); color: #000; }
.sp-rank-pos.d { background: var(--green); color: #000; }
.sp-rank-pos.m { background: var(--accent); color: #fff; }
.sp-rank-pos.f { background: var(--red); color: #fff; }

.sp-rank-name {
  font-weight: 500;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.sp-pin-badge {
  font-size: 10px;
  margin-left: 4px;
}

.sp-rank-team {
  font-size: 9px;
  color: var(--muted);
  text-align: center;
}

.sp-rank-fixtures {
  display: flex;
  gap: 2px;
  flex-wrap: wrap;
  justify-content: center;
}

.sp-rank-xp, .sp-rank-adjxp {
  font-weight: 600;
  text-align: right;
  color: var(--accent);
}

.sp-rank-adjxp {
  color: var(--green);
  font-size: 10px;
}

.sp-rank-mins {
  text-align: center;
  font-size: 10px;
}

.sp-mins-warn {
  color: var(--amber) !important;
}

.sp-rank-risk {
  text-align: center;
  font-size: 9px;
  font-weight: 700;
  padding: 2px 4px;
  border-radius: 3px;
}

.sp-risk-ok { color: var(--green); }
.sp-risk-low { color: var(--amber); background: rgba(251, 191, 36, 0.1); }
.sp-risk-med { color: #ff8c00; background: rgba(255, 140, 0, 0.1); }
.sp-risk-high { color: var(--red); background: rgba(244, 63, 94, 0.15); }

.sp-rank-verdict {
  font-size: 8px;
  font-weight: 700;
  text-align: center;
  padding: 2px 4px;
  border-radius: 3px;
  text-transform: uppercase;
}

.sp-verdict-lock { background: var(--green); color: #000; }
.sp-verdict-start { background: var(--accent); color: #fff; }
.sp-verdict-bench { background: var(--surface-2); color: var(--muted); }
.sp-verdict-sell-watch { background: var(--amber); color: #000; }
.sp-verdict-sell { background: var(--red); color: #fff; }

.sp-rank-actions {
  display: flex;
  gap: 2px;
  justify-content: center;
}

.sp-pin-btn {
  font-size: 8px;
  padding: 2px 5px;
  border: 1px solid var(--border);
  border-radius: 3px;
  background: transparent;
  color: var(--muted);
  cursor: pointer;
  transition: all 0.15s;
}

.sp-pin-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.sp-pin-btn.active {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
}

.sp-rank-bench-reason {
  font-size: 9px;
  color: var(--muted);
  padding: 2px 6px 6px 54px;
  font-style: italic;
  border-bottom: 1px solid var(--border);
}

.sp-rank-delta {
  font-size: 11px;
  padding: 4px 8px;
  margin-bottom: 6px;
  border-radius: var(--radius-sm);
  font-weight: 500;
}

.sp-rank-delta-neg {
  background: rgba(244, 63, 94, 0.1);
  color: var(--red);
}

.sp-rank-delta-pos {
  background: rgba(16, 185, 129, 0.1);
  color: var(--green);
}

.sp-formation {
  font-size: 10px;
  color: var(--muted);
  font-weight: 500;
  margin-left: 8px;
  padding: 2px 6px;
  background: var(--surface-1);
  border-radius: 3px;
}

.sp-rank-legend {
  display: flex;
  gap: var(--gap-sm);
  padding: 6px;
  font-size: 9px;
  color: var(--muted);
  border-top: 1px solid var(--border);
  margin-top: 6px;
  flex-wrap: wrap;
}

.sp-legend-item {
  display: flex;
  align-items: center;
  gap: 4px;
}

.sp-rank-row-xi-dot {
  width: 8px;
  height: 8px;
  background: rgba(16, 185, 129, 0.5);
  border-radius: 2px;
}

.sp-rank-row-bench-dot {
  width: 8px;
  height: 8px;
  background: var(--surface-2);
  border-radius: 2px;
}

/* ─── 6.4 CAPTAIN DECISION PANEL ─────────────────────────────────────────── */
.sp-card-captain .sp-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
}

.sp-cap-mode-toggle {
  display: flex;
  gap: 4px;
}

.sp-cap-mode-btn {
  font-size: 10px;
  padding: 3px 8px;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: transparent;
  color: var(--muted);
  cursor: pointer;
  transition: all 0.15s;
}

.sp-cap-mode-btn:hover {
  border-color: var(--accent);
  color: var(--text);
}

.sp-cap-mode-btn.active {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
}

.sp-cap-rec-summary {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 8px;
  background: rgba(59, 130, 246, 0.1);
  border-radius: var(--radius-sm);
  margin-bottom: 8px;
}

.sp-cap-rec-label {
  font-size: 10px;
  color: var(--muted);
}

.sp-cap-rec-name {
  font-size: 12px;
  font-weight: 700;
  color: var(--accent);
}

.sp-cap-rec-conf {
  font-size: 10px;
  color: var(--muted);
}

.sp-cap-header {
  display: grid;
  grid-template-columns: 28px 1fr 36px 80px 40px 40px 50px;
  gap: 4px;
  padding: 4px 6px;
  background: var(--surface-2);
  border-radius: var(--radius-sm);
  font-size: 9px;
  color: var(--muted);
  text-transform: uppercase;
  font-weight: 600;
  margin-bottom: 4px;
}

.sp-cap-row {
  display: grid;
  grid-template-columns: 28px 1fr 36px 80px 40px 40px 50px;
  gap: 4px;
  padding: 5px 6px;
  align-items: center;
  border-radius: var(--radius-sm);
  transition: background 0.15s;
}

.sp-cap-row:nth-child(odd) {
  background: var(--surface-1);
}

.sp-cap-best {
  background: var(--accent) !important;
  color: #fff;
}

.sp-cap-best .sp-cap-xp,
.sp-cap-best .sp-cap-mins,
.sp-cap-best .sp-cap-eo {
  color: #fff !important;
}

.sp-cap-rank {
  font-weight: 700;
  text-align: center;
}

.sp-cap-fixture {
  font-size: 9px;
  color: var(--muted);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.sp-cap-eo {
  font-size: 10px;
  color: var(--muted);
  text-align: right;
}

.sp-cap-conf {
  position: relative;
  height: 16px;
  background: var(--surface-2);
  border-radius: 3px;
  overflow: hidden;
}

.sp-conf-bar {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  background: linear-gradient(90deg, var(--green) 0%, var(--accent) 100%);
  border-radius: 3px;
  transition: width 0.3s;
}

.sp-conf-val {
  position: relative;
  z-index: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 9px;
  font-weight: 600;
  color: var(--text);
}

.sp-cap-explanation {
  font-size: 10px;
  color: var(--muted);
  font-style: italic;
  padding: 2px 6px 6px 34px;
}

.sp-cap-mode-hint {
  font-size: 10px;
  color: var(--muted);
  padding: 6px 8px;
  background: var(--surface-1);
  border-radius: var(--radius-sm);
  margin-top: 8px;
}

.sp-cap-note {
  font-size: 9px;
  color: var(--muted);
  font-style: italic;
}

/* ─── SMALL BUTTON VARIANT ───────────────────────────────────────────────── */
.sp-btn-small {
  font-size: 10px;
  padding: 3px 8px;
}

/* ─── FX STRIP EMPTY ─────────────────────────────────────────────────────── */
.sp-fx-strip-empty {
  color: var(--muted);
  font-size: 10px;
}

/* ─── RESPONSIVE ADJUSTMENTS FOR PHASE 6 ─────────────────────────────────── */
@media (max-width: 1200px) {
  .sp-rank-header,
  .sp-rank-row {
    grid-template-columns: 20px 20px 1fr 36px 80px 38px 38px 34px 32px 60px 46px;
    font-size: 10px;
  }

  .sp-cap-header,
  .sp-cap-row {
    grid-template-columns: 24px 1fr 32px 70px 36px 36px 44px;
  }
}

@media (max-width: 900px) {
  .sp-snapshot-card {
    padding: var(--gap-xs) var(--gap-sm);
  }

  .sp-snap-metrics {
    gap: var(--gap-sm);
  }

  .sp-snap-metric {
    min-width: 50px;
    padding: var(--gap-xs);
  }

  .sp-snap-metric-val {
    font-size: 1rem;
  }

  .sp-rank-header,
  .sp-rank-row {
    grid-template-columns: 18px 18px 1fr 60px 36px 36px 56px 44px;
  }

  .sp-rank-team,
  .sp-rank-fixtures {
    display: none;
  }
}

@media (max-width: 600px) {
  .sp-rank-header,
  .sp-rank-row {
    grid-template-columns: 16px 16px 1fr 32px 32px 50px 40px;
  }

  .sp-rank-adjxp,
  .sp-rank-risk {
    display: none;
  }

  .sp-cap-header,
  .sp-cap-row {
    grid-template-columns: 22px 1fr 30px 34px 40px;
  }

  .sp-cap-fixture,
  .sp-cap-eo {
    display: none;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   PHASE 7: TRANSFER OPTIMIZER STYLES
   ═══════════════════════════════════════════════════════════════════════════ */

.to-container {
  max-width: 1200px;
  margin: 0 auto;
}

.to-header {
  margin-bottom: var(--gap-md);
}

.to-header h2 {
  margin: 0 0 4px 0;
  font-size: 1.5rem;
}

.to-subtitle {
  color: var(--muted);
  margin: 0;
  font-size: 0.9rem;
}

.to-status-bar {
  margin-bottom: var(--gap-md);
  flex-wrap: wrap;
}

/* ─── CONTROLS SECTION ───────────────────────────────────────────────────── */

.to-controls {
  margin-bottom: var(--gap-lg);
}

.to-controls h3 {
  margin: 0 0 var(--gap-md) 0;
  font-size: 1.1rem;
}

.to-controls-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--gap-md);
  margin-bottom: var(--gap-md);
}

.to-control-group {
  display: flex;
  flex-direction: column;
  gap: var(--gap-xs);
}

.to-control-group > label:first-child {
  font-weight: 600;
  font-size: 0.85rem;
  color: var(--text);
}

.to-select {
  padding: 8px 12px;
  border-radius: var(--radius-sm);
  background: var(--surface-1);
  border: 1px solid var(--border);
  color: var(--text);
  font-size: 0.9rem;
}

.to-toggle-label {
  display: flex;
  align-items: center;
  gap: var(--gap-xs);
  cursor: pointer;
  font-size: 0.85rem;
}

.to-toggle-label input[type="checkbox"] {
  width: 18px;
  height: 18px;
  accent-color: var(--accent);
}

.to-slider-row {
  display: flex;
  align-items: center;
  gap: var(--gap-sm);
}

.to-slider {
  flex: 1;
  accent-color: var(--accent);
}

.to-threshold-value {
  font-weight: 600;
  color: var(--accent);
  min-width: 50px;
  text-align: right;
}

/* ─── LOCK/EXCLUDE SECTIONS ──────────────────────────────────────────────── */

.to-lock-section,
.to-exclude-section {
  margin-top: var(--gap-md);
  padding-top: var(--gap-md);
  border-top: 1px solid var(--border);
}

.to-lock-section h4,
.to-exclude-section h4 {
  margin: 0 0 var(--gap-sm) 0;
  font-size: 0.9rem;
  font-weight: 600;
}

.to-lock-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: var(--gap-xs);
}

.to-lock-item {
  display: flex;
  align-items: center;
  gap: var(--gap-xs);
  padding: 6px 10px;
  border-radius: var(--radius-sm);
  background: var(--surface-1);
  font-size: 0.85rem;
  transition: all 0.2s;
}

.to-lock-item.locked {
  background: rgba(245, 158, 11, 0.15);
  border: 1px solid rgba(245, 158, 11, 0.3);
}

.to-lock-item input[type="checkbox"] {
  accent-color: var(--amber);
}

.to-lock-name {
  flex: 1;
  font-weight: 500;
}

.to-lock-team {
  color: var(--muted);
  font-size: 0.8rem;
}

.to-team-grid {
  display: flex;
  flex-wrap: wrap;
  gap: var(--gap-xs);
}

.to-team-item {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border-radius: var(--radius-sm);
  background: var(--surface-1);
  font-size: 0.8rem;
  transition: all 0.2s;
}

.to-team-item.excluded {
  background: rgba(239, 68, 68, 0.15);
  border: 1px solid rgba(239, 68, 68, 0.3);
  text-decoration: line-through;
}

.to-team-item input[type="checkbox"] {
  width: 14px;
  height: 14px;
  accent-color: var(--red);
}

.to-run-btn {
  margin-top: var(--gap-md);
  width: 100%;
  padding: 12px;
  font-size: 1rem;
}

/* ─── RESULTS SECTION ────────────────────────────────────────────────────── */

.to-results {
  display: flex;
  flex-direction: column;
  gap: var(--gap-md);
}

.to-section {
  padding: var(--gap-md);
}

.to-section h3 {
  margin: 0 0 var(--gap-sm) 0;
  font-size: 1.1rem;
}

.to-section-desc {
  color: var(--muted);
  font-size: 0.85rem;
  margin: 0 0 var(--gap-md) 0;
}

/* ─── WEAKEST CONTRIBUTORS ───────────────────────────────────────────────── */

.to-weakest-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: var(--gap-sm);
}

.to-expendable-card {
  background: var(--surface-1);
  border-radius: var(--radius-md);
  padding: var(--gap-sm);
  border: 1px solid var(--border);
}

.to-expendable-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: var(--gap-xs);
}

.to-expendable-header .to-player-name {
  font-weight: 600;
  font-size: 0.95rem;
}

.to-expendable-meta {
  display: flex;
  gap: var(--gap-sm);
  font-size: 0.8rem;
  color: var(--muted);
  margin-bottom: var(--gap-xs);
}

/* ─── REASON CHIPS ───────────────────────────────────────────────────────── */

.to-reasons {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
}

.reason-chip {
  font-size: 0.7rem;
  padding: 2px 6px;
  border-radius: 3px;
  font-weight: 500;
}

.reason-chip.reason-danger {
  background: rgba(239, 68, 68, 0.2);
  color: var(--red);
  border: 1px solid rgba(239, 68, 68, 0.3);
}

.reason-chip.reason-success {
  background: rgba(16, 185, 129, 0.2);
  color: var(--green);
  border: 1px solid rgba(16, 185, 129, 0.3);
}

.reason-chip.reason-warning {
  background: rgba(245, 158, 11, 0.2);
  color: var(--amber);
  border: 1px solid rgba(245, 158, 11, 0.3);
}

.reason-chip.reason-default {
  background: var(--surface-2);
  color: var(--text);
}

/* ─── TRANSFER SUBSECTIONS ───────────────────────────────────────────────── */

.to-subsection {
  margin-top: var(--gap-md);
  padding-top: var(--gap-md);
  border-top: 1px solid var(--border);
}

.to-subsection:first-of-type {
  margin-top: 0;
  padding-top: 0;
  border-top: none;
}

.to-subsection h4 {
  margin: 0 0 var(--gap-sm) 0;
  font-size: 0.95rem;
  font-weight: 600;
}

.to-roll-card {
  background: var(--surface-1);
  border-radius: var(--radius-md);
  padding: var(--gap-md);
  border: 1px solid var(--border);
}

.to-roll-action {
  font-weight: 600;
  font-size: 1rem;
  margin-bottom: var(--gap-xs);
}

.to-roll-desc {
  color: var(--muted);
  font-size: 0.85rem;
}

.to-no-results {
  color: var(--muted);
  font-style: italic;
  padding: var(--gap-md);
  text-align: center;
  background: var(--surface-1);
  border-radius: var(--radius-md);
}

.to-hit-warning {
  color: var(--amber);
  font-size: 0.85rem;
  margin: 0 0 var(--gap-sm) 0;
}

/* ─── TRANSFER CARDS ─────────────────────────────────────────────────────── */

.to-transfers-list {
  display: flex;
  flex-direction: column;
  gap: var(--gap-sm);
}

.to-transfer-card {
  background: var(--surface-1);
  border-radius: var(--radius-md);
  padding: var(--gap-md);
  border: 1px solid var(--border);
}

.to-transfer-header {
  display: flex;
  align-items: center;
  gap: var(--gap-sm);
  margin-bottom: var(--gap-md);
  flex-wrap: wrap;
}

.to-transfer-gain {
  font-weight: 700;
  font-size: 1.1rem;
}

.to-itb {
  margin-left: auto;
  color: var(--muted);
  font-size: 0.85rem;
}

.to-transfer-row {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: var(--gap-md);
  align-items: start;
}

.to-out-section,
.to-in-section {
  padding: var(--gap-sm);
  border-radius: var(--radius-sm);
}

.to-out-section {
  background: rgba(239, 68, 68, 0.08);
  border: 1px solid rgba(239, 68, 68, 0.2);
}

.to-in-section {
  background: rgba(16, 185, 129, 0.08);
  border: 1px solid rgba(16, 185, 129, 0.2);
}

.to-section-label {
  font-size: 0.7rem;
  font-weight: 700;
  text-transform: uppercase;
  margin-bottom: 4px;
}

.to-out-label {
  color: var(--red);
}

.to-in-label {
  color: var(--green);
}

.to-transfer-row .to-player-name {
  font-weight: 600;
  font-size: 0.95rem;
  margin-bottom: 2px;
}

.to-player-meta {
  color: var(--muted);
  font-size: 0.8rem;
  margin-bottom: var(--gap-xs);
}

.to-arrow {
  font-size: 1.5rem;
  color: var(--muted);
  display: flex;
  align-items: center;
  justify-content: center;
  padding-top: var(--gap-md);
}

.to-gain-breakdown {
  margin-top: var(--gap-sm);
  padding-top: var(--gap-sm);
  border-top: 1px solid var(--border);
  font-size: 0.8rem;
  color: var(--muted);
}

/* ─── SQUAD OVERVIEW ─────────────────────────────────────────────────────── */

.to-overview-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: var(--gap-sm);
  margin-bottom: var(--gap-md);
}

.to-overview-stats .stat-card {
  text-align: center;
  padding: var(--gap-sm);
}

.to-squad-table {
  background: var(--surface-1);
  border-radius: var(--radius-md);
  overflow: hidden;
}

.to-squad-row {
  display: grid;
  grid-template-columns: 1.5fr 0.7fr 0.8fr 0.8fr 0.6fr 0.8fr;
  gap: var(--gap-sm);
  padding: var(--gap-sm) var(--gap-md);
  align-items: center;
  font-size: 0.85rem;
  border-bottom: 1px solid var(--border);
}

.to-squad-row:last-child {
  border-bottom: none;
}

.to-squad-header {
  background: var(--surface-2);
  font-weight: 600;
  font-size: 0.8rem;
  text-transform: uppercase;
  color: var(--muted);
}

.to-squad-row.locked {
  background: rgba(245, 158, 11, 0.08);
}

.to-squad-name {
  display: flex;
  align-items: center;
  gap: 4px;
  font-weight: 500;
}

.lock-icon {
  font-size: 0.8rem;
}

/* ─── ASSUMPTIONS SECTION ────────────────────────────────────────────────── */

.to-assumptions {
  background: var(--surface-1);
}

.to-assumptions h4 {
  margin: 0 0 var(--gap-sm) 0;
  font-size: 0.95rem;
  color: var(--muted);
}

.to-assumptions-list {
  margin: 0;
  padding-left: var(--gap-md);
  font-size: 0.85rem;
  color: var(--muted);
  line-height: 1.6;
}

.to-assumptions-list li {
  margin-bottom: 4px;
}

/* ─── RESPONSIVE ADJUSTMENTS ─────────────────────────────────────────────── */

@media (max-width: 900px) {
  .to-transfer-row {
    grid-template-columns: 1fr;
    gap: var(--gap-sm);
  }

  .to-arrow {
    transform: rotate(90deg);
    padding: 0;
    margin: var(--gap-xs) auto;
  }

  .to-squad-row {
    grid-template-columns: 1fr 0.6fr 0.6fr 0.5fr 0.6fr;
    font-size: 0.8rem;
  }

  .to-squad-row span:nth-child(2) {
    display: none; /* Hide team */
  }
}

@media (max-width: 600px) {
  .to-controls-grid {
    grid-template-columns: 1fr;
  }

  .to-lock-grid {
    grid-template-columns: 1fr;
  }

  .to-weakest-grid {
    grid-template-columns: 1fr;
  }

  .to-squad-row {
    grid-template-columns: 1fr 0.6fr 0.5fr 0.6fr;
    padding: var(--gap-xs) var(--gap-sm);
  }

  .to-squad-row span:nth-child(4) {
    display: none; /* Hide xP/GW */
  }
}

